<!doctype html>
<html>
  <head>
    <meta charset='utf8'>
    <title arb:id="gameTitle">Boing</title>
    <link rel='stylesheet' type='text/css' href='http://fonts.googleapis.com/css?family=Varela' />
    <link rel="stylesheet" type="text/css" media="screen" href="/build/build-less.css" />
    <link rel="stylesheet" type="text/css" media="screen" href="/build/build.css" />
  </head>
  <body>
    <div id="settingsGUIContainer">
      <div id="settingsDataGUI"></div>
      <div id="settingsLevelsGUI"></div>
      <div id="uiTopContent"></div>
      <video id="videoInput"></video>
    </div>

    <div id="wrapper">

      <div id="content">

        <!-- LOADING -->

        <div class="state Loading"></div>

        <!-- THE LOBBY -->

        <a class="state MainMenu" id="chromeTechLink" href="http://google.com/" target="_blank">
          <small>About</small><br />
          Paddle Battle<br />
          Technology
        </a>

        <a class="state MainMenu" id="chromeExperimentLink" href="http://google.com/" target="_blank">
          <!--<small>This is a</small>
          <p>
            Chrome<br />
            Experiment
          </p>-->
        </a>

        <div id="mainmenu" class='state MainMenu'>
          <div id="title">
             <h2>Welcome to</h2>
            <h1 class="copy"><img src="images/logo_large.png" width="1533" height="155"/></h1>
          </div>
          <p class='full'>
            <span arb:id="friendPlayingSomeoneElse">Your friend is playing against someone else right now.</span><br />
            <span arb:id="trySinglePlayer"><!--Try out the single player game!--></span>
          </p>
          
          <div class="buttonWrapper">

            <p class="singleplayer">
              <!--<div class="bubble"></div>-->
              <span arb:id="nobodyIsPlaying"><!--Nobody is playing in this room right now.</span><span class="bubbleTarget"></span><br />-->
              <span arb:id="trySinglePlayer"><!--Try out the single player game!--></span>
            </p>
            <p class="multiplayer">
              <span class="slave" arb:id="friendIsWaiting">Your friend is waiting for you to join this Game Room!</span>
            </p>
            <br/><br/>
            <button class='playFriend green' arb:id="playFriendButton">
              Play friend
            </button>
            <button class='playComputer green' >
              Play Computer
            </button>
          </div>
          
        </div>

        <!-- WAITING FRIEND -->

        <div class="state WaitingFriend inactive">
          <div class="dialog middle">
            <div class="content">
              <div class="verticalCenter">
                 <img src="/images/opponent_computer.gif"/>
                <h2>Your friend is waiting for you in the arena</h2>
                <button id="playWaitingFriend" class="blue">Play Friend</button>
              </div>
            </div>
          </div>
        </div>

        <!-- INVITE FRIEND -->

        <div class="state InviteFriend inactive">
          <div class="dialog middle">
            <div class="content">
              <div class="verticalCenter">
                <h2>Invite Friend</h2>
                <p>Copy and share this link to invite a friend:</p>
                <span class="shareUrl"></span><button id="copyURL" class="notimplemented">Copy</button>
                <button id="backToMainMenu" class="green">Back</button>
                <p>You will be notified when your friend uses the link to enter the game.</p>
              </div>
            </div>
          </div>
        </div>

        <!-- FRIEND ARRIVED -->

        <div class="state FriendArrived inactive">
          <div class="dialog middle">
            <div class="content">
              <div class="verticalCenter">
                <img src="/images/opponent_computer.gif"/>
                <h2>Your friend has arrived</h2>
                <button id="playFriend" class="blue">Play Friend</button>
              </div>
            </div>
          </div>
        </div>

        <!-- CAMERA REQUEST ATTENTION -->

        <div class="state WebcamActivation inactive" id="cameraRequestAttention">
          <img src="/images/cameraRequestAttention.png" />
        </div>

        <!-- CAMERA INFORMATION -->

        <div class="state WebcamInformation inactive">
          <div class="dialog">
            <div class="content">
              <h2>Connect Camera</h2>
              <p>Camera is recommended for<br />playing this game</p>
              <button id="activateCamera" class="green">Activate Camera</button>
              <p>Or use the <a class="alternative button keyboard">keyboard</a>for playing</p>
            </div>
          </div>
        </div>


        <!-- FRIEND ARRIVED -->

        <div class="state WaitForFriendStart inactive">
          <div class="dialog middle">
            <div class="content">
              <div class="verticalCenter">
                <img src="/images/cam.gif"/>
                <h2>Waiting for friend<br/>to hit start</h2>
              </div>
            </div>
          </div>
        </div>


        <!-- GAME INSTRUCTIONS -->

        <div class="state GameInstructions inactive">
          <div class="dialog middle">
            <div class="content">
              <div class="verticalCenter">
                <h2>Game controls</h2>
                <div id="controlsInstructions">
                    <span>Play using</span><img src="images/instr_ill_1.gif" /><span>or</span><img src="images/instr_ill_2.gif" /><span>press</span><img src="images/instr_ill_3.gif" />
                </div>
                <button class="green play">Start</button>
              </div>
            </div>
          </div>
        </div>


        <!-- COUNTDOWN -->

        <div class="state Play inactive">
          <!--<div class="dialog middle">-->
            <div class="centerContent">
              <span id="gamestartCountdown"></span>
            </div>
         <!--/div>-->
        </div>

        <!-- OPPONENT LEFT DIALOG -->

        <div class="state OpponentLeft inactive">
          <div class="dialog">
            <div class="content">
              <div class="verticalCenter">
                <h2>Your friend left the game</h2>
                <p>Copy and share this link to play a friend:<br /><span class="shareUrl"></span></p>
                <button class="green play">Play Computer (Space)</button>
              </div>
            </div>
          </div>
        </div>

        <!-- PAUSE DIALOG -->

        <div class="state Pause inactive">
          <div class="dialog">
            <div class="content">
              <div class="verticalCenter">
                <h2>Paused</h2>
                <p>Press <button class="alternative green play">space</button> to resume</p>
                <button class="singleplayer green play">Resume Game</button>
                <button class="multiplayer green quit notimplemented">Quit Friends Play</button>
              </div>
            </div>
          </div>
        </div>

        <!-- GAME OVER DIALOG -->

        <div id="bautaGameOver" class="state GameOver inactive"><img src="images/game_over.png" /></div>
        <div id="gameOverDialog" class="state GameOver inactive">
          <div class="dialog">
            <div class="content">
              <div id="scoreboardSingle" class="verticalCenter">
                <h2>Your Points</h2>
                <div class="scoreboard single">
                    <div>Levels Played</div>
                    <div id="highscoreLevels" class="highscoreDigit">X</div>
                    <div id="shareScore"><h3>Share</h3><img src="images/share_score.gif"/></div>
                    <div id="highscoreRally" class="highscoreDigit">X</div>
                    <div>Longest Rallies</div>
                </div>
                
                <button class="blue playFriend">Play Friend</button>
                <button class="green play">Play Again (Space)</button>
              </div>

              <div id="scoreboardMulti" class="verticalCenter">
                <h2>Your Points</h2>
                <div class="scoreboard multiplayer">
                    <img src="images/temp_scoreboard_multi.gif" />
                    <!--<div>
                      Levels Played
                      <div id="highscoreTotalA" class="highscoreDigit">X</div>
                      <div id="highscoreTotalB" class="highscoreDigit">X</div>
                    </div>
                    <div id="shareScore">Share</div>
                    <div>
                      Longest Rallies
                      <div id="highscoreTotalA" class="highscoreDigit">X</div>
                      <div id="highscoreTotalB" class="highscoreDigit">X</div>
                    </div>-->
                </div>
                <button class="green play">Play Again (Space)</button>
              </div>

            </div>
          </div>
        </div>

        <!-- WAITING FOR RESTART -->

        <div class="state WaitForGameStart inactive">
          <div class="dialog middle">
            <div class="content">
              <div class="verticalCenter">
                 <img src="/images/opponent_computer.gif"/>
                <h2>Waiting for your friend to restart the game</h2>
              </div>
            </div>
          </div>
        </div>

        <!-- GAME STUFF -->

        <div id="gameScores" class="state Play inactive">
          <img src="/images/minipong.png" /><br />
          Paddle Battle<br />
          
          <div id="scoresMultiplayer">
            Player 1 - Player 2<br />
            <div class="score" id="scoreRally">0</div>
          </div>
          <div id="scoresSingleplayer">
            Player 1 - CPU<br />
            <div class="score"><span id="arb-id?">LV.</span><span id="level"></span></div>
            <div class="score" id="scorePoints">0-0</div>
          </div>
        </div>

        <div id="game">
          <canvas id="canv-3d" width="320" height="480"></canvas>
          <canvas id="canv-2d" width="320" height="480"></canvas>
          <video id="remoteInput" width="160" height="120" autoplay class='hidden'></video>
        </div>

        <div id="footer">
           <div id="socials">
             <div class="googleplus notimplemented"><span>Google Plus</span></div>
             <div class="facebook notimplemented"><span>Facebook</span></div>
             <div class="twitter notimplemented"><span>Twitter</span></div>
             <div class="something notimplemented"><span>Something</span></div>
           </div>
           <div id="footMenu">
              <ul>
                <li><a href="#" class="notimplemented">Terms &amp; privacy</a></li>
                <li><a id="localizationSwitch" href="#">EN</a></li>
                <li>
                  <a href="#" class="soundSwitch on">
                    <span class="off">Sound on</span>
                    <span class="on">Sound off</span>
                  </a>
                </li>
              </ul>
           </div>
        </div>

        <ul id="debug-info"></ul>

      </div>
    </div>

    <!-- SCRIPTING -->

    <script>
      // DataChannel Polyfill host
      window.CHANNEL_HOST = 'ec2-176-34-161-202.eu-west-1.compute.amazonaws.com:8000';
    </script>
    <script>
      // Expected globals:
      var globals = Object.keys(window).concat([
        'require','THREE', 'TWEEN', 'Stats',
        'dat', 'console', 'checkGlobalLeaks'
      ]);
    </script>
    <script src="/_ah/channel/jsapi"></script>
    <script src='/javascript/libs/three.js'></script>
    <script src='/javascript/libs/Stats.js'></script>
    <script src='/javascript/libs/Tween.js'></script>
    <script src="/javascript/libs/dat.gui.js"></script>
    <script src="/javascript/libs/datachannel.js"></script>
    <script src='/build/build.js'></script>
    <script>
      require('paddle-battle')({
        room: "{{.Room}}",
        acceptLanguage: "en,{{.AcceptLanguage}}"
      })
    </script>
    <script>
      // Crashing in my Chrome Stable:
      /*
      function checkGlobalLeaks(){
        var leaks = Object.keys(window).filter(function(k){return !~globals.indexOf(k)})
        console.log('leaks?',leaks)
      }
      setTimeout(function(){
        checkGlobalLeaks()
      },1000)
      */
    </script>
  </body>
<me/html>
