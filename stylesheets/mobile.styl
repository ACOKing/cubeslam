$footer-height = 47px
@keyframes extra-icon-pulse
  0%, 100% 
    transform translate(0, 0px) scale(.9)
  50%
    transform translate(0, -7px) scale(1.1)

@keyframes effect-ghostball-pulse
  0%, 100% 
    opacity .4
  50%
    opacity .1

@keyframes effect-force
  0%
    background-position: -510px -359px
  100%
    background-position: 250px -359px


#canv-css
  display none
html.mobile
  width 100%
  background $color-beige
  .mobile
    display block

  body
    width 100%
    height 100%
    position absolute
    background $color-beige

    &.game-pause
      #gamepad
        opacity .7
      button.pause
        transition-delay 0ms
        transform translateX(100%)

  #settingsGUIContainer
  , .play-friend
  , button.main-menu
  , .links
  , .multiplayer
  , section.state.game-pause
  , #extras
    display none!important

  .dialog
    bottom $footer-height

  header
    background no-repeat center center
    background-size cover

    h1
      padding 2% 0 0 0

    .nav
      bottom 70px
      width 100%
      padding 0

      a.button
        display none!important

      button 
        width auto
        min-width 0
        padding-left 15px
        padding-right 15px

    .notifications
      display none


  #mobile-menu
    absolute top 0px right 0
    z-index 2
    button
      width 46px
      min-width 0
      height 46px
      margin 0
      padding 0
      border none
      display block

      &.play, &.pause
        background $color-blue
        color #205688
      &.sound
        background $color-green
        color #306e2b
      &.info
        background $color-yellow
        color #b58d33
      &.pause
        absolute right 0
        z-index 1
        transition transform 250ms
        transition-delay .7s

    .game-pause, .game-play
      transform translateX(0)
      position relative
      z-index 2
      transition transform 300ms ease-out 
      transition-delay 300ms
      display block!important

      &.inactive
        transform translateX(100%)
        transition-delay 0ms

  .state.game-prompt
    .background
      // transition none
      height 60px
      margin-top -30px
      top 50%
      transform translateZ(0)
      backface-visibility hidden
    .prompt
      transform translateZ(0)
      backface-visibility hidden
      h1, h2, h3, h4
        font-size 30px

  footer#footer
    display none
    height $footer-height
    pointer-events none
    a
      pointer-events auto

    ul
      padding 13px 0 0 0
      margin-top 0

    .terms, .localization
      display none

    .technology, .sound
      a
        font-family 'icomoon'
        width 20px
        height 20px
        font-size 12px
        border-radius 3px
        display table-cell
        vertical-align middle
        border 1px solid transparent

        &:before
          display inline-block
          text-align center
          width 100%
          vertical-align middle

      span
        display none!important


    .technology
      margin-right 10px
      a
        background $color-yellow
        &:before
          content '⌽'
          color #b58d33
    .sound
      a
        background $color-green
        &:before
          content '♫'
          color #306e2b
        &.off
          &:before
            content '♩'

  body.main-menu
    #footer
      display block

  #canv-pixel
    width 1px
    height 1px
    border 5px solid pink
    background blue
    position absolute
    z-index 3

  #scores
    absolute top 10px left 10px  
    margin 0
    z-index 1
    pointer-events none

    .logo
      h1, img
        display none

    .logo, .multiplayer, .singleplayer
      display inline-block
      vertical-align top
    .multiplayer, .singleplayer
      .player, .opponent
        display inline-block
        margin 0
        margin-left 20px
        p
          font-size 10px
          width 35px
        li
          width 12px
          height 12px

  #gamepad
    display none!important
    position absolute
    bottom 50%
    width 100%
    z-index 2
    transition opacity 300ms ease-out

    button
      background-color #6bba6b
      width 72px
      height 72px
      border-radius 36px
      box-shadow 0 3px 5px rgba(0,0,0,.3) 
      absolute left 5%
      padding 0
      outline 0
      border 0

      &:before
        content ' '
        absolute bottom 1px left 4.2%
        width 93%
        height 93%
        border-radius 93%
        background-color #4daf4d

      &:active
        box-shadow 0 1px 10px rgba(0,0,0,.3) 

      &:last-child
        left auto
        right 5%

  .state
    visibility hidden
    &.active
      visibility visible

    .dialog
      .content.animate
        transition none


    &.game-instructions
      .game-controls
        display none!important
      .dialog
        bottom $footer-height
        top 0
        height 100%
      .content
        transition none
        // transform translateX(-100%)
      &.inactive
        display none!important
        .content
          transform translateX(-100%)
      &.active
        .content
          transform translateX( 0 )
    &.game-over
      .dialog
        height 100%
        min-height 0
        top 0
        .scoreboard
          padding 0 0 15px
        button
          width auto
          padding 10px 20px
          margin-left 0

  .mobile
    .main-menu 
      width 100%
      height 100%
      position absolute
      
  .state.game-instructions
    #game-controls
      display none

  #game
    opacity 1
    height 0
    width 0
    left 50%
    top 50%
    overflow visible
    > canvas, > video
      display none


  $w = 768px
  $h = 480px
  #canv-css
    display block
    width $w
    height $h
    relative top -260px 
    left -1 * $w * .5
    transform-origin 50% 55%
    .background
      width 1536px
      height 1079px
      z-index 0
      absolute top -340px left -50%
      background no-repeat center center
      background-size cover
      img
        width 100%
        height 100%
        display none

      .bear
        absolute top 390px left 679px
        transform translateZ(0)
        backface-visibility hidden
        > * 
          transform translateZ(0)
          backface-visibility hidden

      .bubble
        position absolute
        top 400px
        left 905px
        font-size 48px
        &:before
          top 0
          color $color-beige
        &:after
          top 18px
          right 11px
          font-size 15px
          letter-spacing 0.1em
          content attr(data-name)


    .game-board
      position absolute
      z-index 2
      width $w
      height $h
      perspective 640px
      perspective-origin 50% 0%
      transform translateZ(0)
      backface-visibility hidden

    .arena
      width $w
      height 1024px
      transform rotateX(83.3deg) translateX(0%) translateZ(-223px) translateY(-74%)
      transform-style preserve-3d
      backface-visibility hidden
      // background linear-gradient(bottom, rgba(255,255,0,.9), rgba(255,255,0,.4))
      position absolute
      z=index 1

    .shields
      absolute top 0
      letter-spacing 0
      font-size 0
      width 100%
      .shields-a, .shields-b
        absolute top 0px

      .shield
        position absolute
        display inline-block
        background-color rgba(red, 0)
        transform-origin bottom center
        transition-property transform
        transition-duration .3s
        transition-delay 0s
        transition-timing-function ease-out
        transform scaleY(.005) translateZ(0)
        backface-visibility hidden
        &.visible
          for row in 1 2 3
            &:nth-child({row})
              transition-delay 100ms * (row - 1)
          transform scaleY(1) translateZ(0)

      .shields-a
        top 420px
        left 109px
        z-index 4
        .shield-1
          left 0
        .shield-2
          left 186px
        .shield-3
          left 366px

      .shields-b
        top 161px
        left 255px
        z-index 0

        .shield-1
          left 0
        .shield-2
          left 86px
        .shield-3
          left 171px

  #expressions 
    transform translateZ(0)
    backface-visibility hidden
  .angry
    absolute top 8px left 40px
  .blink
    absolute top 37px left 63px
  .jawdrop
    absolute top 54px left 57px
  .flirt
    absolute top 21px left 62px

  .extra
    transform-style preserve-3d
    backface-visibility hidden
    transform-origin 50% 50% 0
    position absolute
    .icon
      background-color transparent
      animation extra-icon-pulse 1s infinite

  .puck
    position absolute
    transform rotateX(-90deg) translateX(365px) translateY(-50%) translateZ(505px) scale(1.5)
    backface-visibility hidden
    transform-style preserve-3d
    transform-origin 50% 50% 0

    &.ghostball
      -webkit-filter grayscale(1)
      animation effect-ghostball-pulse 2s infinite
    &.flash
      opacity .6


  .effect.fog
    position absolute
    top 148px
    left 96px
    z-index 3
    opacity 0
    transition opacity .5s
    transform translateZ(0)
    backface-visibility hidden
    
    &.active
      opacity 1
    &.hidden
      display none

  .force
    display none
    absolute left 50% top 385px
    margin-left -126px
    animation effect-force .5s infinite alternate
    animation-timing-function steps(3)
    // transform translateZ(0)
    backface-visibility hidden
    &.active
      display block

  .obstacles
    .obstacle
      transform translateZ(0)
      backface-visibility hidden
    .triangle-left
      display none
      position absolute
      top 210px
      left 188px
      z-index 2
    .triangle-right
      display none
      position absolute
      top 210px
      left 497px
      z-index 2


.paddle, 
#p1, 
#p2
  position absolute
  transform-style preserve-3d
  transform rotateX(90deg) translateX(200px) translateZ(1567px) translateY(-50%)
  backface-visibility hidden
  transform-origin 50% 50% 0

  .gfx 
    transition transform .5s cubic-bezier(0.000, 0.000, 0.405, 1.650)

#p2
  z-index 3
  

@media (orientation: portrait)
  html.mobile
    #gamepad
      display none!important
    #canv-css
      top -236px


@media (orientation: landscape)
  html.mobile
    .touch
      #gamepad.state.active
        display block!important

    #scores
      width 100%

      .logo
        absolute right 70px 
      
      .singleplayer, .multiplayer
        .player, .opponent
          display block
          clearfix()
      p
        margin-bottom 0
      p, ol
        float left

    .dialog
      bottom 0

    header .nav
      bottom 10px

      #canv-css
        top -266px

    body.main-menu
      #footer
        display inline-block
        background-color transparent

