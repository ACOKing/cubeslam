"use-strict";var dmaf=dmaf||{};if(function(e,t){function i(e,t){var i=document.createElement("script");i.type="text/javascript",i.async=!0,i.onload=function(){t(),setTimeout(function(){document.body.removeChild(i)},1)},i.src=e,document.body.appendChild(i)}function n(e,t,i){var n=new XMLHttpRequest;n.responseType=t,n.onload=function(){i(this.response)},n.open("GET",e,!0),n.send()}function a(){}function o(e,t,i){i||(i=1e3*x.context.currentTime),x.ActionManager.onEvent(e,i,t)}function s(){I.push(arguments)}function r(e,t,i){var n=k;n=n[e]||(n[e]=[]);for(var a=0,o=n.length;o>a;a++)if(n[a]===t)return t;t.context=i&&"object"==typeof i?i:dmaf,n.push(t)}function l(e,t){var i,n=k[e];if(!n||!n.length)return!1;for(i=n.length;i--;)if(n[i]==t){n.splice(i,1),S=!0;break}}function c(e,t,i){t.context=i&&"object"==typeof i?i:dmaf;var n=function(){var a=t.apply(i,arguments);return dmaf.removeEventListener(e,n),a};dmaf.addEventListener(e,n,i)}function d(e,t){return"string"!=typeof e?(dmaf.log&&console.log("DMAF: You must provide a valid id for the object you wish to register."),2):e?t&&t instanceof Object?(t.instanceId||(t.instanceId=e),x.pendingObjects[e]=t,x.ActionManager.onEvent(e+".CREATE"),undefined):(dmaf.log&&console.log("DMAF: You've tried to register an object not of type 'object'"),3):(dmaf.log&&console.log("DMAF: You must provide a valid id for the object you wish to register."),1)}function u(){N.push(arguments)}function p(e){var t=x.pendingObjects[e],i=!1;return t&&(i=delete x.pendingObjects[e]),t=x.getInstance("customCode:"+e),t&&(i=x.removeInstance("customCode:"+e)),t=x.getInstance("mediaElement:"+e),t&&(i=x.removeInstance("mediaElement:"+e)),i&&x.ActionManager.onEvent(e+".REMOVE"),!1}function m(){n(x.Settings.projectPath+"project.xml","document",y)}function h(e){dmaf.init=a,x.dispatch("load_core",x),e&&"string"==typeof e&&(x.Settings.assetsPath=e),f()}function f(){E?(x.Utils.getFileFormat(),x.dispatch("load_modules",x),x.ActionManager.populate()):T()}function y(e){var t=e.querySelector("framework"),i=e.querySelector("version"),a=e.querySelector("include");if(i=i&&i.getAttribute("value"),t=t&&t.getAttribute("path"),a=a&&a.getAttribute("scripts")&&a.getAttribute("scripts").split(",")||[],!t)throw new TypeError("Missing framework path.");if(x.Settings.customScripts=a,x.Settings.version=i||"0.x",x.Settings.frameworkPath=t,x.Settings.configPath=x.Settings.projectPath+"config.xml",x.Settings.assetsPath=x.Settings.projectPath+"assets/",a.length)for(var o=0;a.length>o;o++)a[o]=x.Settings.assetsPath+"js/"+a[o];n(t+"src/scripts.json","text",g)}function g(e){var t,n=JSON.parse(e);n=n.concat(x.Settings.customScripts),w.toLoad=n.length,dmaf.once=c,console.log("Loading dmaf from:",x.Settings.frameworkPath);for(var a=0;w.toLoad>a;a++)t=/http/.test(n[a])?n[a]:x.Settings.frameworkPath+n[a],i(t,_)}function _(){++w.loaded===w.toLoad&&(dmaf.once("load_core",v),x.dispatch("load_core",x),x.ActionManager&&console.log("You are now running Dinahmoe Web Audio Framework version:",x.Settings.version),x.Utils.getFileFormat(),console.log("dmaf file format is now",x.fileFormat))}function v(){n(x.Settings.frameworkPath+"src/xml/descriptors.xml","document",P)}function P(e){if(x.Settings.descriptors=x.Parser.parseDescriptors(e),!x.Settings.descriptors)throw Error("dmaf could not parse descriptors!");console.log("dmaf has succesfully parsed",x.Settings.frameworkPath+"src/xml/descriptors.xml"),n(x.Settings.configPath,"document",A)}function A(t){if(x.Settings.actions=x.Parser.parseActions(t,x.Settings.descriptors),!x.Settings.actions)throw Error("dmaf could not parse the config file!");console.log("dmaf has succesfully parsed:",x.Settings.configPath),E?(x.dispatch("load_modules",x),console.log("dmaf modules are now active."),x.ActionManager.populate(),console.log("Action Manager is now populated."),e.DMAF=x,dmaf.log=!0):T()}function b(){var e,t,i;for(dmaf.registerObject=d,dmaf.unregisterObject=p,e=0,t=N.length;t>e;e++)i=M.call(N[e]),dmaf.registerObject.apply(dmaf,i);for(dmaf.tell=o,I.length&&dmaf.log&&console.log("had pending"),e=0,t=I.length;t>e;e++)i=M.call(I[e]),dmaf.tell.apply(dmaf,i)}function T(){x.dispatch("dmaf_fail"),dmaf.tell=a,dmaf.registerObject=a,dmaf.unregisterObject=a,dmaf.init=a}var E=!!t,N=[],I=[],S=!1,B=!1,k={},M=Array.prototype.slice,x={pendingObjects:{},dispatch:function(e){var t=k,i=[],n=M.call(arguments,1);B=!1,t=k[e],t||(t=i);for(var a=0;t.length>a&&(i.push(t[a].apply(t[a].context,n)),S&&(a--,S=!1),!B);a++);return i.length?i:null},context:E?new t:{currentTime:0},isWebAudio:E,Settings:{}},L=/^dmaf\=/,C=e.location&&e.location.href.split("?")||[],w={toLoad:0,loaded:0};dmaf={addEventListener:r,removeEventListener:l,once:c,tell:s,registerObject:u,unregisterObject:a},"undefined"!=typeof window?window.dmaf=dmaf:dmaf.core=x,dmaf.once(E?"dmaf_ready":"dmaf_fail",b);for(var R=0;C.length>R;R++)if(L.test(C[R])){C[R]=C[R].replace(L,""),x.Settings.projectPath=C[R];break}x.Settings.projectPath?(dmaf.init=m,dmaf.once=a):dmaf.init=h,"undefined"!=typeof module&&module.exports?module.exports=dmaf:"undefined"!=typeof define&&define("dmaf",[],function(){return dmaf})}(this,this.webkitAudioContext||this.AudioContext),dmaf.once("load_core",function(e){e.Settings={descriptors:{validActions:["loadCustomCode","loadSound","loadMIDI","loadSampleMap","customCode","userObject","mediaElement","mediaController","genericPlay","stepPlay","soundStop","midiProcessor","makeNote","transform","macro","state","eventMapper","midiNoteMapper","timePatternPlayer","beatPatternPlayer","sampler","audioBus"],validTypes:["noteMap","stateMap","eventMap","file","map","target","sampleMapGroup","sampleMap","start","stop","beatEvent","add","band","chorus","overdrive","compressor","cabinet","filter","convolver","delay","envelopeFollower","equalizer","lfo","phaser","pingPongDelay","tremolo","wahWah"],action:{assetController:{loadCustomCode:{type:"assetController",id:"loadCustomCode",instanceId:{name:"instanceId",type:"string"},returnEvent:{name:"returnEvent",type:"string"},files:{name:"files",type:"array",valueType:"file"},"":{type:"assetController"}},type:"assetController",loadSound:{type:"assetController",id:"loadSound",instanceId:{name:"instanceId",type:"string"},returnEvent:{name:"returnEvent",type:"string"},files:{name:"files",type:"array",valueType:"file"},"":{type:"assetController"}},loadMIDI:{type:"assetController",id:"loadMIDI",instanceId:{name:"instanceId",type:"string"},returnEvent:{name:"returnEvent",type:"string"},files:{name:"files",type:"array",valueType:"file"},"":{type:"assetController"}},loadSampleMap:{type:"assetController",id:"loadSampleMap",instanceId:{name:"instanceId",type:"string"},returnEvent:{name:"returnEvent",type:"string"},files:{name:"files",type:"array",valueType:"file"},"":{type:"assetController"}}},customCode:{customCode:{type:"customCode",id:"customCode",instanceId:{name:"instanceId",type:"string"},"":{type:"customCode"}},type:"customCode",userObject:{type:"customCode",id:"userObject",instanceId:{name:"instanceId",type:"string"},"":{type:"customCode"}}},mediaElement:{mediaElement:{type:"mediaElement",id:"mediaElement",instanceId:{name:"instanceId",type:"string"},"":{type:"mediaElement"}},type:"mediaElement"},control:{mediaController:{type:"control",id:"mediaController",instanceId:{name:"instanceId",type:"string","default":"multi"},"":{type:"control"}},type:"control"},sound:{genericPlay:{type:"sound",id:"genericPlay",delay:{name:"delay",type:"int","default":0,min:-1e6,max:1e6},instanceId:{name:"instanceId",type:"string","default":"multi"},soundFile:{name:"soundFile",type:"string","default":"multi"},multiSuffix:{name:"multiSuffix",type:"string","default":""},volume:{name:"volume",type:"float",unit:"dB","default":0,min:-90,max:48},pan:{name:"pan",type:"int","default":0,min:-100,max:100},loop:{name:"loop",type:"int",unit:"mS","default":-1,min:-2,max:1e5},reTrig:{name:"reTrig",type:"int",unit:"mS","default":-1,min:-1,max:1e5},returnEvent:{name:"returnEvent",type:"string"},returnEventTime:{name:"returnEventTime",type:"int",unit:"mS","default":-1,min:-1e6,max:1e5},preListen:{name:"preListen",type:"int","default":0,min:0,max:500},bus:{name:"bus",type:"string","default":"master"},priority:{name:"priority",type:"boolean","default":!1},timingCorrection:{name:"timingCorrection",type:"enum","default":"PLAY",values:["RESYNC","SYNC","PLAY"]},"":{type:"sound"}},type:"sound",stepPlay:{type:"sound",id:"stepPlay",delay:{name:"delay",type:"int","default":0,min:0,max:1e5},instanceId:{name:"instanceId",type:"string"},soundFiles:{name:"soundFiles",type:"list"},generator:{name:"generator",type:"enum","default":"SHUFFLE",values:["SHUFFLE","RANDOM","RANDOM_FIRST","ROUND_ROBIN"]},volume:{name:"volume",type:"float","default":0,min:-90,max:48},pan:{name:"pan",type:"int","default":0,min:-100,max:100},reTrig:{name:"reTrig",type:"int","default":-1,min:-1,max:1e5},returnEvent:{name:"returnEvent",type:"string","default":"",values:["ALL"]},returnEventTime:{name:"returnEventTime",type:"int","default":-1,min:-1e6,max:1e5},preListen:{name:"preListen",type:"int","default":0,min:0,max:500},bus:{name:"bus",type:"string","default":"master",values:["ALL"]},priority:{name:"priority",type:"boolean","default":!1},timingCorrection:{name:"timingCorrection",type:"enum","default":"SYNC",values:["SYNC","PLAY"]},"":{type:"sound"}},soundStop:{type:"sound",id:"soundStop",delay:{name:"delay",type:"int","default":0,min:0,max:9999999},targets:{name:"targets",type:"list"},multiSuffix:{name:"multiSuffix",type:"string","default":""},"":{type:"sound"}}},midiProcessor:{midiProcessor:{type:"midiProcessor",id:"midiProcessor",instanceId:{name:"instanceId",type:"string"},transpose:{name:"transpose",type:"int","default":0,min:-127,max:127},dynamic:{name:"dynamic",type:"int","default":0,min:-127,max:127},quantize:{name:"quantize",type:"string"},scale:{name:"scale",type:"string",values:["off","major","harmonicMinor","naturalMinor","majorPentatonic","minorPentatonic","dorian","phyrgian","lydian","mixolydian","locrian","doubleHarmonic","halfDim","custom","off"]},customScale:{name:"customScale",type:"string","default":"0,0,0,0,0,0,0,0,0,0,0,0"},root:{name:"root",type:"string","default":"C",values:["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"]},"":{type:"midiProcessor"}},type:"midiProcessor",makeNote:{type:"midiProcessor",id:"makeNote",instanceId:{name:"instanceId",type:"string","default":"someProcessor"},noteMaps:{name:"noteMaps",type:"array",valueType:"noteMap"},"":{type:"midiProcessor"}}},parameterProcessor:{transform:{type:"parameterProcessor",id:"transform",instanceId:{name:"instanceId",type:"string"},delay:{name:"delay",type:"int","default":0,min:0,max:9999999},targetType:{name:"targetType",type:"enum","default":"SOUND",values:["sound","audioRouter","synth"]},targets:{name:"targets",type:"list"},targetParameter:{name:"targetParameter",type:"string"},multiSuffix:{name:"multiSuffix",type:"string"},value:{name:"value",type:"float","default":0,min:-9999999,max:9999999},duration:{name:"duration",type:"int","default":0,min:0,max:9999999},curve:{name:"curve",type:"int","default":0,min:-100,max:100},"":{type:"parameterProcessor"}},type:"parameterProcessor",macro:{type:"parameterProcessor",id:"macro",instanceId:{name:"instanceId",type:"string"},delay:{name:"delay",type:"int","default":0,min:0,max:9999999},macroTargets:{name:"macroTargets",type:"array",valueType:"macroTarget"},"":{type:"parameterProcessor"}}},stateProcessor:{state:{type:"stateProcessor",id:"state",instanceId:{name:"instanceId",type:"string"},update:{name:"update",type:"enum","default":"onChange",values:["onChange","always"]},stateMaps:{name:"stateMaps",type:"array",valueType:"stateMap"},"":{type:"stateProcessor"}},type:"stateProcessor"},eventProcessor:{eventMapper:{type:"eventProcessor",id:"eventMapper",instanceId:{name:"instanceId",type:"string"},eventMaps:{name:"eventMaps",type:"array",valueType:"eventMap"},"":{type:"eventProcessor"}},type:"eventProcessor",midiNoteMapper:{type:"eventProcessor",id:"midiNoteMapper",instanceId:{name:"instanceId",type:"string"},eventMaps:{name:"eventMaps",type:"array",valueType:"eventMap"},"":{type:"eventProcessor"}}},player:{timePatternPlayer:{type:"player",id:"timePatternPlayer",instanceId:{name:"instanceId",type:"string","default":"master_time_player"},behavior:{name:"behavior",type:"enum",values:["LINEAR","DEFAULT"],"default":"DEFAULT"},"":{type:"player"}},type:"player",beatPatternPlayer:{type:"player",id:"beatPatternPlayer",instanceId:{name:"instanceId",type:"string","default":"master_beat_player"},flowItems:{name:"flowItems",type:"array",valueType:"flowItem"},"":{type:"player"}}},synth:{sampler:{type:"synth",id:"sampler",instanceId:{name:"instanceId",type:"string"},ignoreNoteOff:{name:"ignoreNoteOff",type:"boolean","default":!1},bus:{name:"bus",type:"string","default":"master"},volume:{name:"volume",type:"float","default":0,min:-100,max:10},loop:{name:"loop",type:"boolean","default":!1},ampAttack:{name:"ampAttack",type:"int","default":0,min:0,max:500},ampDecay:{name:"ampDecay",type:"int","default":0,min:0,max:500},ampRelease:{name:"ampRelease",type:"int","default":0,min:0,max:1e3},ampSustain:{name:"ampSustain",type:"float","default":1,min:0,max:1},ampVelocityRatio:{name:"ampVelocityRatio",type:"float","default":1,min:0,max:1},filterOn:{name:"filterOn",type:"boolean","default":!1},filterAttack:{name:"filterAttack",type:"int","default":0,min:0,max:500},filterDecay:{name:"filterDecay",type:"int","default":0,min:0,max:500},filterRelease:{name:"filterRelease",type:"int","default":0,min:0,max:1e3},filterSustain:{name:"filterSustain",type:"float","default":1,min:0,max:1},filterVelocityRatio:{name:"filterVelocityRatio",type:"float","default":1,min:0,max:1},filterQ:{name:"filterQ",type:"float","default":1e-4,min:1e-4,max:30},filterFrequency:{name:"filterFrequency",type:"int","default":0,min:0,max:10},filterGain:{name:"filterGain",type:"float","default":0,min:0,max:1},audioNodes:{name:"audioNodes",type:"array",valueType:"audioNode"},sampleMapGroups:{name:"sampleMapGroups",type:"array",valueType:"sampleMapGroup"},"":{type:"synth"}},type:"synth"},audioRouter:{audioBus:{type:"audioRouter",id:"audioBus",instanceId:{name:"instanceId",type:"string"},outputBus:{name:"outputBus",type:"string","default":"master"},volume:{name:"volume",type:"float","default":0,min:-100,max:10},pan:{name:"pan",type:"int","default":0,min:-100,max:100},audioNodes:{name:"audioNodes",type:"array",valueType:"audioNode"},"":{type:"audioRouter"}},type:"audioRouter"}},type:{noteMap:{noteMap:{type:"noteMap",id:"noteMap",triggerIn:{name:"triggerIn",type:"string"},triggerOut:{name:"triggerOut",type:"string"},note:{name:"note",type:"string","default":"C4"},velocity:{name:"velocity",type:"int",min:0,max:127,"default":127},duration:{name:"duration",type:"int",min:0,max:9999999,"default":0},"":{type:"noteMap"}},type:"noteMap"},stateMap:{stateMap:{type:"stateMap",id:"stateMap","in":{name:"in",type:"list"},state:{name:"state",type:"string"},"":{type:"stateMap"}},type:"stateMap"},eventMap:{eventMap:{type:"eventMap",id:"eventMap","in":{name:"in",type:"list"},out:{name:"out",type:"string"},delay:{name:"delay",type:"int","default":0,max:1e4,min:0},"":{type:"eventMap"}},type:"eventMap"},file:{file:{type:{name:"type",type:"enum",values:["beatPattern","timePattern"],"default":""},id:"file",name:{name:"name",type:"string"},"":{type:"file"}},type:"file"},map:{map:{type:"map",id:"map",inValue:{name:"inValue",type:"string"},outValue:{name:"outValue",type:"string"},"":{type:"map"}},type:"map"},macroTarget:{target:{type:"macroTarget",id:"target",targetId:{name:"targetId",type:"string"},min:{name:"min",type:"float","default":0,min:0,max:1},max:{name:"max",type:"float","default":1,min:0,max:1},targetType:{name:"targetType",type:"enum","default":"BUS",values:["SOUND","SYNTH","BUS"]},targetParameter:{name:"targetParameter",type:"string"},"":{type:"macroTarget"}},type:"macroTarget"},sampleMapGroup:{sampleMapGroup:{type:"sampleMapGroup",id:"sampleMapGroup",name:{name:"name",type:"string"},sampleMaps:{name:"sampleMaps",type:"array",valueType:"sampleMap"},"":{type:"sampleMapGroup"}},type:"sampleMapGroup"},sampleMap:{sampleMap:{type:"sampleMap",id:"sampleMap",name:{name:"name",type:"string"},velocityLow:{name:"velocityLow",type:"int","default":0,min:0,max:127},velocityHigh:{name:"velocityHigh",type:"int","default":127,min:0,max:127},"":{type:"sampleMap"}},type:"sampleMap"},flowItem:{start:{type:"flowItem",id:"start",delay:{name:"delay",type:"int","default":0,min:0,max:null},tempo:{name:"tempo",type:"float","default":120,min:40,max:280},beatsPerBar:{name:"beatsPerBar",type:"int","default":16,min:1,max:16},meter:{name:"meter",type:"list","default":["simple"],value:["simple","compound"]},subdivision:{name:"subdivision",type:"string","default":"16",values:["1","2D","2","2T","4D","4","4T","8D","8","8T","16D","16","16T","32D","32","32T"]},"":{type:"flowItem"}},type:"flowItem",stop:{type:"flowItem",id:"stop",songPosition:{name:"songPosition",type:"string","default":"NEXT_BEAT"},returnEvent:{name:"returnEvent",type:"string"},"":{type:"flowItem"}},beatEvent:{type:"flowItem",id:"beatEvent",songPosition:{name:"songPosition",type:"string","default":"NEXT_BEAT"},returnEvent:{name:"returnEvent",type:"string"},output:{name:"output",type:"enum","default":"onEvent",values:["dispatch","onEvent"]},"":{type:"flowItem"}},add:{type:"flowItem",id:"add",patternId:{name:"patternId",type:"string","default":"multi"},channel:{name:"channel",type:"string","default":"main"},songPosition:{name:"songPosition",type:"string","default":"NEXT_BAR"},patternPosition:{name:"patternPosition",type:"enum","default":"SYNC",values:["SYNC","FIRST_BEAT"]},clearPending:{name:"clearPending",type:"boolean","default":!0},replaceActive:{name:"replaceActive",type:"boolean","default":!0},setAsCurrent:{name:"setAsCurrent",type:"boolean","default":!0},loop:{name:"loop",type:"boolean","default":!1},loopLength:{name:"loopLength",type:"int","default":129,min:1,max:65536},clearPosition:{name:"clearPosition",type:"string","default":"NEXT_BAR"},"":{type:"flowItem"}}},band:{band:{type:"band",id:"band",bandType:{name:"bandType",type:"enum","default":"PEAKING",values:["LOWPASS","HIGHPASS","BANDPASS","LOWSHELF","HIGHSHELF","PEAKING","NOTCH","ALLPASS"],automatable:!1},frequency:{name:"frequency",type:"float","default":800,min:20,max:22050,automatable:!0},Q:{name:"Q",type:"float","default":1,min:0,max:100,automatable:!0},gain:{name:"gain",type:"float","default":0,min:-40,max:40,automatable:!0},"":{type:"band"}},type:"band"},audioNode:{chorus:{type:"audioNode",id:"chorus",active:{name:"active",type:"boolean","default":!0},feedback:{name:"feedback",type:"float","default":0,min:0,max:1,automatable:!1},delay:{name:"delay",type:"float","default":.0045,min:0,max:1,automatable:!1},rate:{name:"rate",type:"float","default":1.5,min:.01,max:8,automatable:!1},bypass:{name:"bypass",type:"float","default":0,min:0,max:1,automatable:!1},"":{type:"audioNode"}},type:"audioNode",overdrive:{type:"audioNode",id:"overdrive",active:{name:"active",type:"boolean","default":!0},outputGain:{name:"outputGain",type:"float","default":0,min:0,max:1,automatable:!0},drive:{name:"drive",type:"float","default":0,min:0,max:1,automatable:!0},curveAmount:{name:"curveAmount",type:"float","default":1,min:0,max:1,automatable:!0},algorithmIndex:{name:"algorithmIndex",type:"int","default":0,min:0,max:5,automatable:!1},"":{type:"audioNode"}},compressor:{type:"audioNode",id:"compressor",active:{name:"active",type:"boolean","default":!0},threshold:{name:"threshold",type:"float","default":0,min:-100,max:0,automatable:!0},makeupGain:{name:"makeupGain",type:"float","default":1,min:0,max:100,automatable:!0},attack:{name:"attack",type:"float","default":1,min:0,max:1e3,automatable:!0},release:{name:"release",type:"float","default":1,min:0,max:3e3,automatable:!0},ratio:{name:"ratio",type:"float","default":4,min:1,max:20,automatable:!0},knee:{name:"knee",type:"float","default":5,min:0,max:40,automatable:!0},automakeup:{name:"automakeup",type:"boolean","default":!1},"":{type:"audioNode"}},cabinet:{type:"audioNode",id:"cabinet",active:{name:"active",type:"boolean","default":!0},makeupGain:{name:"makeupGain",type:"float","default":1,min:0,max:20,automatable:!0},impulsePath:{name:"impulsePath",type:"string"},"":{type:"audioNode"}},filter:{type:"audioNode",id:"filter",active:{name:"active",type:"boolean","default":!0},frequency:{name:"frequency",type:"float","default":20,min:20,max:22050,automatable:!0},Q:{name:"Q",type:"float","default":1,min:0,max:100,automatable:!0},gain:{name:"gain",type:"float","default":0,min:-40,max:40,automatable:!0},bypass:{name:"bypass",type:"boolean","default":!0,automatable:!0},filterType:{name:"filterType",type:"enum","default":"LOWPASS",values:["LOWPASS","HIGHPASS","BANDPASS","LOWSHELF","HIGHSHELF","PEAKING","NOTCH","ALLPASS"],automatable:!1},"":{type:"audioNode"}},convolver:{type:"audioNode",id:"convolver",active:{name:"active",type:"boolean","default":!0},highCut:{name:"highCut",type:"float","default":22050,min:20,max:22050,automatable:!0},lowCut:{name:"lowCut",type:"float","default":20,min:20,max:22050,automatable:!0},dryLevel:{name:"dryLevel",type:"float","default":1,min:0,max:1,automatable:!0},wetLevel:{name:"wetLevel",type:"float","default":1,min:0,max:1,automatable:!0},level:{name:"level",type:"float","default":1,min:0,max:1,automatable:!0},impulse:{name:"impulse",type:"string"},"":{type:"audioNode"}},delay:{type:"audioNode",id:"delay",active:{name:"active",type:"boolean","default":!0},delayTime:{name:"delayTime",type:"float","default":30,min:.001,max:1e4,automatable:!1},feedback:{name:"feedback",type:"float","default":.45,min:0,max:.9,automatable:!0},cutoff:{name:"cutoff",type:"float","default":20,min:20,max:22050,automatable:!0},dryLevel:{name:"dryLevel",type:"float","default":1,min:0,max:1,automatable:!0},wetLevel:{name:"wetLevel",type:"float","default":1,min:0,max:1,automatable:!0},tempoSync:{name:"tempoSync",type:"string",automatable:!1},subdivision:{name:"subdivision",type:"enum","default":"8D",values:["1","2D","2","2T","4D","4","4T","8D","8","8T","16D","16","16T","32D","32","32T"],automatable:!1},"":{type:"audioNode"}},envelopeFollower:{type:"audioNode",id:"envelopeFollower",active:{name:"active",type:"boolean","default":!0},attackTime:{name:"attackTime",type:"float","default":.003,min:0,max:.5,automatable:!1},releaseTime:{name:"releaseTime",type:"float","default":.5,min:0,max:1,automatable:!1},"":{type:"audioNode"}},equalizer:{type:"audioNode",id:"equalizer",active:{name:"active",type:"boolean","default":!0},bands:{name:"bands",type:"array",valueType:"band"},"":{type:"audioNode"}},lfo:{type:{name:"type",type:"enum","default":"SIN",values:["SIN","SQUARE","TRIANGLE","SAWTOOTH"],automatable:!1},id:"lfo",active:{name:"active",type:"boolean","default":!0},frequency:{name:"frequency",type:"float","default":1,min:0,max:8,automatable:!1},offset:{name:"offset",type:"float","default":.85,min:0,max:22050,automatable:!1},phase:{name:"phase",type:"float","default":0,min:0,max:6.28318530718,automatable:!1},oscillation:{name:"oscillation",type:"float","default":.3,min:-22050,max:22050,automatable:!1},"":{type:"audioNode"}},phaser:{type:"audioNode",id:"phaser",active:{name:"active",type:"boolean","default":!0},rate:{name:"rate",type:"float","default":1,min:0,max:8,automatable:!1},depth:{name:"depth",type:"float","default":.3,min:0,max:1,automatable:!1},feedback:{name:"feedback",type:"float","default":.2,min:0,max:1,automatable:!1},stereoPhase:{name:"stereoPhase",type:"int","default":30,min:0,max:180,automatable:!1},baseModulationFrequency:{name:"baseModulationFrequency",type:"float","default":700,min:500,max:1500,automatable:!1},"":{type:"audioNode"}},pingPongDelay:{type:"audioNode",id:"pingPongDelay",active:{name:"active",type:"boolean","default":!0},delayTime:{name:"delayTime",type:"float","default":30,min:1e-4,max:1e4,automatable:!1},feedback:{name:"feedback",type:"float","default":.45,min:0,max:.9,automatable:!0},cutoff:{name:"cutoff",type:"float","default":20,min:20,max:22050,automatable:!0},dryLevel:{name:"dryLevel",type:"float","default":1,min:0,max:1,automatable:!0},wetLevel:{name:"wetLevel",type:"float","default":1,min:0,max:1,automatable:!0},tempoSync:{name:"tempoSync",type:"string",automatable:!1},subdivision:{name:"subdivision",type:"enum","default":"8D",values:["1","2D","2","2T","4D","4","4T","8D","8","8T","16D","16","16T","32D","32","32T"],automatable:!1},"":{type:"audioNode"}},tremolo:{type:"audioNode",id:"tremolo",active:{name:"active",type:"boolean","default":!0},intensity:{name:"intensity",type:"float","default":.3,min:0,max:1,automatable:!1},stereoPhase:{name:"stereoPhase",type:"int","default":0,min:0,max:180,automatable:!1},rate:{name:"rate",type:"float","default":.1,min:.001,max:8,automatable:!1},"":{type:"audioNode"}},wahWah:{type:"audioNode",id:"wahWah",active:{name:"active",type:"boolean","default":!0},automode:{name:"automode",type:"boolean","default":!1},baseFrequency:{name:"baseFrequency",type:"float","default":.5,min:0,max:1,automatable:!1},excursionOctaves:{name:"excursionOctaves",type:"int","default":2,min:1,max:6,automatable:!1},sweep:{name:"sweep",type:"float","default":.2,min:0,max:1,automatable:!1},resonance:{name:"resonance",type:"float","default":10,min:1,max:100,automatable:!1},sensitivity:{name:"sensitivity",type:"float","default":.5,min:-1,max:1,automatable:!1},"":{type:"audioNode"}}}}},actions:[{type:"audioRouter",id:"audioBus",triggers:["init_routing"],actionProperties:{instanceId:"master_bus",outputBus:"master",volume:0,pan:0,audioNodes:[]},delay:0,instanceId:""},{type:"audioRouter",id:"audioBus",triggers:["init_routing"],actionProperties:{instanceId:"pause_bus",outputBus:"master_bus",volume:0,pan:0,audioNodes:[]},delay:0,instanceId:""},{type:"parameterProcessor",id:"transform",triggers:["sound_off"],actionProperties:{instanceId:"master_mute",targetType:"audioRouter",targets:["master_bus"],targetParameter:"volume",value:-80,duration:100,delay:0,curve:0},delay:0,instanceId:""},{type:"parameterProcessor",id:"transform",triggers:["sound_on"],actionProperties:{instanceId:"master_unmute",targetType:"audioRouter",targets:["master_bus"],targetParameter:"volume",value:0,duration:100,delay:0,curve:0},delay:0,instanceId:""},{type:"parameterProcessor",id:"transform",triggers:["pause"],actionProperties:{instanceId:"pause_mute",targetType:"audioRouter",targets:["pause_bus"],targetParameter:"volume",value:-80,duration:100,delay:0,curve:0},delay:0,instanceId:""},{type:"parameterProcessor",id:"transform",triggers:["unpause"],actionProperties:{instanceId:"pause_unmute",targetType:"audioRouter",targets:["pause_bus"],targetParameter:"volume",value:0,duration:100,delay:0,curve:0},delay:0,instanceId:""},{type:"player",id:"beatPatternPlayer",triggers:["init_routing"],actionProperties:{instanceId:"main",flowItems:[{id:"start",tempo:126,beatsPerBar:16}]},delay:0,instanceId:""},{type:"player",id:"beatPatternPlayer",triggers:["splash_screen"],actionProperties:{instanceId:"main",flowItems:[{id:"add",patternId:"empty_pattern",channel:"main",songPosition:"NEXT_BAR",patternPosition:"FIRST_BEAT",clearPending:!0,replaceActive:!0,setAsCurrent:!0,loop:!0,loopLength:128,clearPosition:"NEXT_BAR"},{id:"add",patternId:"bass_filter__1",channel:"main",songPosition:"NEXT_BAR",patternPosition:"FIRST_BEAT",clearPending:!1,replaceActive:!1,setAsCurrent:!1,loop:!0,loopLength:128,clearPosition:"NEXT_BAR"},{id:"add",patternId:"dm_kraftwerk__1",channel:"main",songPosition:"NEXT_BAR",patternPosition:"FIRST_BEAT",clearPending:!1,replaceActive:!1,setAsCurrent:!1,loop:!0,loopLength:128,clearPosition:"NEXT_BAR"},{id:"add",patternId:"stab__1",channel:"main",songPosition:"NEXT_BAR",patternPosition:"FIRST_BEAT",clearPending:!1,replaceActive:!1,setAsCurrent:!1,loop:!0,loopLength:128,clearPosition:"NEXT_BAR"},{id:"add",patternId:"strings__1",channel:"main",songPosition:"NEXT_BAR",patternPosition:"FIRST_BEAT",clearPending:!1,replaceActive:!1,setAsCurrent:!1,loop:!0,loopLength:128,clearPosition:"NEXT_BAR"},{id:"add",patternId:"synth_comp__1",channel:"main",songPosition:"NEXT_BAR",patternPosition:"FIRST_BEAT",clearPending:!1,replaceActive:!1,setAsCurrent:!1,loop:!0,loopLength:128,clearPosition:"NEXT_BAR"},{id:"add",patternId:"synth_perc__1",channel:"main",songPosition:"NEXT_BAR",patternPosition:"FIRST_BEAT",clearPending:!1,replaceActive:!1,setAsCurrent:!1,loop:!0,loopLength:128,clearPosition:"NEXT_BAR"},{id:"add",patternId:"synth_pop__1",channel:"main",songPosition:"NEXT_BAR",patternPosition:"FIRST_BEAT",clearPending:!1,replaceActive:!1,setAsCurrent:!1,loop:!0,loopLength:128,clearPosition:"NEXT_BAR"}]},delay:0,instanceId:""},{type:"player",id:"beatPatternPlayer",triggers:["gameover_screen"],actionProperties:{instanceId:"main",flowItems:[{id:"start",delay:0,tempo:126,beatsPerBar:16},{id:"add",patternId:"empty_pattern",channel:"main",songPosition:"NEXT_BAR",patternPosition:"FIRST_BEAT",clearPending:!0,replaceActive:!0,setAsCurrent:!0,loop:!0,loopLength:128,clearPosition:"NEXT_BAR"},{id:"add",patternId:"bass__2",channel:"main",songPosition:"NEXT_BAR",patternPosition:"FIRST_BEAT",clearPending:!1,replaceActive:!1,setAsCurrent:!1,loop:!0,loopLength:128,clearPosition:"NEXT_BAR"},{id:"add",patternId:"bass_comp__2",channel:"main",songPosition:"NEXT_BAR",patternPosition:"FIRST_BEAT",clearPending:!1,replaceActive:!1,setAsCurrent:!1,loop:!0,loopLength:128,clearPosition:"NEXT_BAR"},{id:"add",patternId:"bass_filter__2",channel:"main",songPosition:"NEXT_BAR",patternPosition:"FIRST_BEAT",clearPending:!1,replaceActive:!1,setAsCurrent:!1,loop:!0,loopLength:128,clearPosition:"NEXT_BAR"},{id:"add",patternId:"dm_kraftwerk__2",channel:"main",songPosition:"NEXT_BAR",patternPosition:"FIRST_BEAT",clearPending:!1,replaceActive:!1,setAsCurrent:!1,loop:!0,loopLength:128,clearPosition:"NEXT_BAR"},{id:"add",patternId:"lead_a__2",channel:"main",songPosition:"NEXT_BAR",patternPosition:"FIRST_BEAT",clearPending:!1,replaceActive:!1,setAsCurrent:!1,loop:!0,loopLength:128,clearPosition:"NEXT_BAR"},{id:"add",patternId:"lead_b__2",channel:"main",songPosition:"NEXT_BAR",patternPosition:"FIRST_BEAT",clearPending:!1,replaceActive:!1,setAsCurrent:!1,loop:!0,loopLength:128,clearPosition:"NEXT_BAR"},{id:"add",patternId:"stab__2",channel:"main",songPosition:"NEXT_BAR",patternPosition:"FIRST_BEAT",clearPending:!1,replaceActive:!1,setAsCurrent:!1,loop:!0,loopLength:128,clearPosition:"NEXT_BAR"},{id:"add",patternId:"strings__2",channel:"main",songPosition:"NEXT_BAR",patternPosition:"FIRST_BEAT",clearPending:!1,replaceActive:!1,setAsCurrent:!1,loop:!0,loopLength:128,clearPosition:"NEXT_BAR"},{id:"add",patternId:"synth_comp__2",channel:"main",songPosition:"NEXT_BAR",patternPosition:"FIRST_BEAT",clearPending:!1,replaceActive:!1,setAsCurrent:!1,loop:!0,loopLength:128,clearPosition:"NEXT_BAR"},{id:"add",patternId:"synth_perc__2",channel:"main",songPosition:"NEXT_BAR",patternPosition:"FIRST_BEAT",clearPending:!1,replaceActive:!1,setAsCurrent:!1,loop:!0,loopLength:128,clearPosition:"NEXT_BAR"},{id:"add",patternId:"synth_pop__2",channel:"main",songPosition:"NEXT_BAR",patternPosition:"FIRST_BEAT",clearPending:!1,replaceActive:!1,setAsCurrent:!1,loop:!0,loopLength:128,clearPosition:"NEXT_BAR"}]},delay:0,instanceId:""},{type:"player",id:"beatPatternPlayer",triggers:["info_screen"],actionProperties:{instanceId:"main",flowItems:[{id:"add",patternId:"empty_pattern",channel:"main",songPosition:"NEXT_BAR",patternPosition:"FIRST_BEAT",clearPending:!0,replaceActive:!0,setAsCurrent:!0,loop:!0,loopLength:128,clearPosition:"NEXT_BAR"},{id:"add",patternId:"bass_filter__12",channel:"main",songPosition:"NEXT_BAR",patternPosition:"FIRST_BEAT",clearPending:!1,replaceActive:!1,setAsCurrent:!1,loop:!0,loopLength:128,clearPosition:"NEXT_BAR"},{id:"add",patternId:"stab__12",channel:"main",songPosition:"NEXT_BAR",patternPosition:"FIRST_BEAT",clearPending:!1,replaceActive:!1,setAsCurrent:!1,loop:!0,loopLength:128,clearPosition:"NEXT_BAR"},{id:"add",patternId:"synth_pop__12",channel:"main",songPosition:"NEXT_BAR",patternPosition:"FIRST_BEAT",clearPending:!1,replaceActive:!1,setAsCurrent:!1,loop:!0,loopLength:128,clearPosition:"NEXT_BAR"}]},delay:0,instanceId:""},{type:"player",id:"beatPatternPlayer",triggers:["fog_over","multiball_over","death_ball_over","mirrored_controls_over","timebomb_over","ghost_ball_over"],actionProperties:{instanceId:"main",flowItems:[{id:"add",patternId:"empty_pattern",channel:"main",songPosition:"NEXT_BEAT",patternPosition:"SYNC",clearPending:!0,replaceActive:!0,setAsCurrent:!0,loop:!0,loopLength:128,clearPosition:"NEXT_BEAT"},{id:"add",patternId:"bass__4",channel:"main",songPosition:"NEXT_BEAT",patternPosition:"SYNC",clearPending:!1,replaceActive:!1,setAsCurrent:!1,loop:!0,loopLength:128,clearPosition:"NEXT_BEAT"},{id:"add",patternId:"bass_comp__4",channel:"main",songPosition:"NEXT_BEAT",patternPosition:"SYNC",clearPending:!1,replaceActive:!1,setAsCurrent:!1,loop:!0,loopLength:128,clearPosition:"NEXT_BEAT"},{id:"add",patternId:"bass_filter__4",channel:"main",songPosition:"NEXT_BEAT",patternPosition:"SYNC",clearPending:!1,replaceActive:!1,setAsCurrent:!1,loop:!0,loopLength:128,clearPosition:"NEXT_BEAT"},{id:"add",patternId:"dm_kraftwerk__4",channel:"main",songPosition:"NEXT_BEAT",patternPosition:"SYNC",clearPending:!1,replaceActive:!1,setAsCurrent:!1,loop:!0,loopLength:128,clearPosition:"NEXT_BEAT"},{id:"add",patternId:"synth_comp__4",channel:"main",songPosition:"NEXT_BEAT",patternPosition:"SYNC",clearPending:!1,replaceActive:!1,setAsCurrent:!1,loop:!0,loopLength:128,clearPosition:"NEXT_BEAT"},{id:"add",patternId:"synth_perc__4",channel:"main",songPosition:"NEXT_BEAT",patternPosition:"SYNC",clearPending:!1,replaceActive:!1,setAsCurrent:!1,loop:!0,loopLength:128,clearPosition:"NEXT_BEAT"},{id:"add",patternId:"synth_pop__4",channel:"main",songPosition:"NEXT_BEAT",patternPosition:"SYNC",clearPending:!1,replaceActive:!1,setAsCurrent:!1,loop:!0,loopLength:128,clearPosition:"NEXT_BEAT"}]},delay:0,instanceId:""},{type:"eventProcessor",id:"eventMapper",triggers:["countdown_init"],actionProperties:{instanceId:"handle_long",eventMaps:[{id:"eventMap","in":["countdown_init"],out:"countdown_long_start",delay:500},{id:"eventMap","in":["countdown_init"],out:"stop_immediate",delay:0}]},delay:0,instanceId:""},{type:"player",id:"beatPatternPlayer",triggers:["stop_immediate"],actionProperties:{instanceId:"main",flowItems:[{id:"stop",songPosition:"ASAP"}]},delay:0,instanceId:""},{type:"player",id:"beatPatternPlayer",triggers:["countdown_long_start"],actionProperties:{instanceId:"main",flowItems:[{id:"start",delay:0,tempo:126,beatsPerBar:16},{id:"beatEvent",songPosition:"NEXT_BEAT+1.6",returnEvent:"gameplay_init",output:"onEvent"},{id:"add",patternId:"empty_pattern",channel:"main",songPosition:"NEXT_BEAT",patternPosition:"FIRST_BEAT",clearPending:!0,replaceActive:!0,setAsCurrent:!0,loop:!0,loopLength:128,clearPosition:"NEXT_BEAT"},{id:"add",patternId:"bass_comp__5",channel:"main",songPosition:"NEXT_BEAT",patternPosition:"FIRST_BEAT",clearPending:!1,replaceActive:!1,setAsCurrent:!1,loop:!0,loopLength:128,clearPosition:"NEXT_BEAT"},{id:"add",patternId:"stab__5",channel:"main",songPosition:"NEXT_BEAT",patternPosition:"FIRST_BEAT",clearPending:!1,replaceActive:!1,setAsCurrent:!1,loop:!0,loopLength:128,clearPosition:"NEXT_BEAT"},{id:"add",patternId:"synth_perc__5",channel:"main",songPosition:"NEXT_BEAT",patternPosition:"FIRST_BEAT",clearPending:!1,replaceActive:!1,setAsCurrent:!1,loop:!0,loopLength:128,clearPosition:"NEXT_BEAT"},{id:"add",patternId:"synth_plucked__5",channel:"main",songPosition:"NEXT_BEAT",patternPosition:"FIRST_BEAT",clearPending:!1,replaceActive:!1,setAsCurrent:!1,loop:!0,loopLength:128,clearPosition:"NEXT_BEAT"},{id:"add",patternId:"synth_sharp__5",channel:"main",songPosition:"NEXT_BEAT",patternPosition:"FIRST_BEAT",clearPending:!1,replaceActive:!1,setAsCurrent:!1,loop:!0,loopLength:128,clearPosition:"NEXT_BEAT"}]},delay:0,instanceId:""},{type:"player",id:"beatPatternPlayer",triggers:["gameplay_init"],actionProperties:{instanceId:"main",flowItems:[{id:"add",patternId:"empty_pattern",channel:"main",songPosition:"NEXT_BEAT",patternPosition:"FIRST_BEAT",clearPending:!0,replaceActive:!0,setAsCurrent:!0,loop:!0,loopLength:128,clearPosition:"NEXT_BEAT"},{id:"add",patternId:"bass__4",channel:"main",songPosition:"NEXT_BEAT",patternPosition:"FIRST_BEAT",clearPending:!1,replaceActive:!1,setAsCurrent:!1,loop:!0,loopLength:128,clearPosition:"NEXT_BEAT"},{id:"add",patternId:"bass_comp__4",channel:"main",songPosition:"NEXT_BEAT",patternPosition:"FIRST_BEAT",clearPending:!1,replaceActive:!1,setAsCurrent:!1,loop:!0,loopLength:128,clearPosition:"NEXT_BEAT"},{id:"add",patternId:"bass_filter__4",channel:"main",songPosition:"NEXT_BEAT",patternPosition:"FIRST_BEAT",clearPending:!1,replaceActive:!1,setAsCurrent:!1,loop:!0,loopLength:128,clearPosition:"NEXT_BEAT"},{id:"add",patternId:"dm_kraftwerk__4",channel:"main",songPosition:"NEXT_BEAT",patternPosition:"FIRST_BEAT",clearPending:!1,replaceActive:!1,setAsCurrent:!1,loop:!0,loopLength:128,clearPosition:"NEXT_BEAT"},{id:"add",patternId:"synth_comp__4",channel:"main",songPosition:"NEXT_BEAT",patternPosition:"FIRST_BEAT",clearPending:!1,replaceActive:!1,setAsCurrent:!1,loop:!0,loopLength:128,clearPosition:"NEXT_BEAT"},{id:"add",patternId:"synth_perc__4",channel:"main",songPosition:"NEXT_BEAT",patternPosition:"FIRST_BEAT",clearPending:!1,replaceActive:!1,setAsCurrent:!1,loop:!0,loopLength:128,clearPosition:"NEXT_BEAT"},{id:"add",patternId:"synth_pop__4",channel:"main",songPosition:"NEXT_BEAT",patternPosition:"FIRST_BEAT",clearPending:!1,replaceActive:!1,setAsCurrent:!1,loop:!0,loopLength:128,clearPosition:"NEXT_BEAT"}]},delay:0,instanceId:""},{type:"eventProcessor",id:"eventMapper",triggers:["countdown_short"],actionProperties:{instanceId:"handle_short",eventMaps:[{id:"eventMap","in":["countdown_short"],out:"countdown_short_start",delay:3500},{id:"eventMap","in":["countdown_short"],out:"gameplay_init",delay:3500}]},delay:0,instanceId:""},{type:"player",id:"beatPatternPlayer",triggers:["user_won_round","user_lost_round"],actionProperties:{instanceId:"main",flowItems:[{id:"stop",songPosition:"ASAP"}]},delay:0,instanceId:""},{type:"player",id:"beatPatternPlayer",triggers:["countdown_short_start"],actionProperties:{instanceId:"main",flowItems:[{id:"start",tempo:126,beatsPerBar:16}]},delay:0,instanceId:""},{type:"player",id:"beatPatternPlayer",triggers:["fog_activate"],actionProperties:{instanceId:"main",flowItems:[{id:"add",patternId:"empty_pattern",channel:"main",songPosition:"NEXT_BEAT",patternPosition:"SYNC",clearPending:!0,replaceActive:!0,setAsCurrent:!0,loop:!0,loopLength:128,clearPosition:"NEXT_BEAT"},{id:"add",patternId:"bass__3",channel:"main",songPosition:"NEXT_BEAT",patternPosition:"SYNC",clearPending:!1,replaceActive:!1,setAsCurrent:!1,loop:!0,loopLength:128,clearPosition:"NEXT_BEAT"},{id:"add",patternId:"bass_filter__3",channel:"main",songPosition:"NEXT_BEAT",patternPosition:"SYNC",clearPending:!1,replaceActive:!1,setAsCurrent:!1,loop:!0,loopLength:128,clearPosition:"NEXT_BEAT"},{id:"add",patternId:"dm_kraftwerk__3",channel:"main",songPosition:"NEXT_BEAT",patternPosition:"SYNC",clearPending:!1,replaceActive:!1,setAsCurrent:!1,loop:!0,loopLength:128,clearPosition:"NEXT_BEAT"},{id:"add",patternId:"stab__3",channel:"main",songPosition:"NEXT_BEAT",patternPosition:"SYNC",clearPending:!1,replaceActive:!1,setAsCurrent:!1,loop:!0,loopLength:128,clearPosition:"NEXT_BEAT"},{id:"add",patternId:"synth_funk__3",channel:"main",songPosition:"NEXT_BEAT",patternPosition:"SYNC",clearPending:!1,replaceActive:!1,setAsCurrent:!1,loop:!0,loopLength:128,clearPosition:"NEXT_BEAT"},{id:"add",patternId:"synth_perc__3",channel:"main",songPosition:"NEXT_BEAT",patternPosition:"SYNC",clearPending:!1,replaceActive:!1,setAsCurrent:!1,loop:!0,loopLength:128,clearPosition:"NEXT_BEAT"},{id:"add",patternId:"synth_pop__3",channel:"main",songPosition:"NEXT_BEAT",patternPosition:"SYNC",clearPending:!1,replaceActive:!1,setAsCurrent:!1,loop:!0,loopLength:128,clearPosition:"NEXT_BEAT"},{id:"add",patternId:"synth_sharp__3",channel:"main",songPosition:"NEXT_BEAT",patternPosition:"SYNC",clearPending:!1,replaceActive:!1,setAsCurrent:!1,loop:!0,loopLength:128,clearPosition:"NEXT_BEAT"},{id:"add",patternId:"synth_warm__3",channel:"main",songPosition:"NEXT_BEAT",patternPosition:"SYNC",clearPending:!1,replaceActive:!1,setAsCurrent:!1,loop:!0,loopLength:128,clearPosition:"NEXT_BEAT"}]},delay:0,instanceId:""},{type:"player",id:"beatPatternPlayer",triggers:["mirrored_controls_activate"],actionProperties:{instanceId:"main",flowItems:[{id:"add",patternId:"empty_pattern",channel:"main",songPosition:"NEXT_BEAT",patternPosition:"SYNC",clearPending:!0,replaceActive:!0,setAsCurrent:!0,loop:!0,loopLength:128,clearPosition:"NEXT_BEAT"},{id:"add",patternId:"bass__7",channel:"main",songPosition:"NEXT_BEAT",patternPosition:"SYNC",clearPending:!1,replaceActive:!1,setAsCurrent:!1,loop:!0,loopLength:128,clearPosition:"NEXT_BEAT"},{id:"add",patternId:"bass_comp__7",channel:"main",songPosition:"NEXT_BEAT",patternPosition:"SYNC",clearPending:!1,replaceActive:!1,setAsCurrent:!1,loop:!0,loopLength:128,clearPosition:"NEXT_BEAT"},{id:"add",patternId:"bass_filter__7",channel:"main",songPosition:"NEXT_BEAT",patternPosition:"SYNC",clearPending:!1,replaceActive:!1,setAsCurrent:!1,loop:!0,loopLength:128,clearPosition:"NEXT_BEAT"},{id:"add",patternId:"dm_kraftwerk__7",channel:"main",songPosition:"NEXT_BEAT",patternPosition:"SYNC",clearPending:!1,replaceActive:!1,setAsCurrent:!1,loop:!0,loopLength:128,clearPosition:"NEXT_BEAT"},{id:"add",patternId:"lead_a__7",channel:"main",songPosition:"NEXT_BEAT",patternPosition:"SYNC",clearPending:!1,replaceActive:!1,setAsCurrent:!1,loop:!0,loopLength:128,clearPosition:"NEXT_BEAT"},{id:"add",patternId:"lead_b__7",channel:"main",songPosition:"NEXT_BEAT",patternPosition:"SYNC",clearPending:!1,replaceActive:!1,setAsCurrent:!1,loop:!0,loopLength:128,clearPosition:"NEXT_BEAT"},{id:"add",patternId:"stab__7",channel:"main",songPosition:"NEXT_BEAT",patternPosition:"SYNC",clearPending:!1,replaceActive:!1,setAsCurrent:!1,loop:!0,loopLength:128,clearPosition:"NEXT_BEAT"},{id:"add",patternId:"synth_funk__7",channel:"main",songPosition:"NEXT_BEAT",patternPosition:"SYNC",clearPending:!1,replaceActive:!1,setAsCurrent:!1,loop:!0,loopLength:128,clearPosition:"NEXT_BEAT"},{id:"add",patternId:"synth_plucked__7",channel:"main",songPosition:"NEXT_BEAT",patternPosition:"SYNC",clearPending:!1,replaceActive:!1,setAsCurrent:!1,loop:!0,loopLength:128,clearPosition:"NEXT_BEAT"},{id:"add",patternId:"synth_sharp__7",channel:"main",songPosition:"NEXT_BEAT",patternPosition:"SYNC",clearPending:!1,replaceActive:!1,setAsCurrent:!1,loop:!0,loopLength:128,clearPosition:"NEXT_BEAT"},{id:"add",patternId:"synth_warm__7",channel:"main",songPosition:"NEXT_BEAT",patternPosition:"SYNC",clearPending:!1,replaceActive:!1,setAsCurrent:!1,loop:!0,loopLength:128,clearPosition:"NEXT_BEAT"}]},delay:0,instanceId:""},{type:"player",id:"beatPatternPlayer",triggers:["multiball_activate"],actionProperties:{instanceId:"main",flowItems:[{id:"add",patternId:"empty_pattern",channel:"main",songPosition:"NEXT_BEAT",patternPosition:"SYNC",clearPending:!0,replaceActive:!0,setAsCurrent:!0,loop:!0,loopLength:128,clearPosition:"NEXT_BEAT"},{id:"add",patternId:"bass__8",channel:"main",songPosition:"NEXT_BEAT",patternPosition:"SYNC",clearPending:!1,replaceActive:!1,setAsCurrent:!1,loop:!0,loopLength:128,clearPosition:"NEXT_BEAT"},{id:"add",patternId:"bass_comp__8",channel:"main",songPosition:"NEXT_BEAT",patternPosition:"SYNC",clearPending:!1,replaceActive:!1,setAsCurrent:!1,loop:!0,loopLength:128,clearPosition:"NEXT_BEAT"},{id:"add",patternId:"bass_filter__8",channel:"main",songPosition:"NEXT_BEAT",patternPosition:"SYNC",clearPending:!1,replaceActive:!1,setAsCurrent:!1,loop:!0,loopLength:128,clearPosition:"NEXT_BEAT"},{id:"add",patternId:"dm_kraftwerk__8",channel:"main",songPosition:"NEXT_BEAT",patternPosition:"SYNC",clearPending:!1,replaceActive:!1,setAsCurrent:!1,loop:!0,loopLength:128,clearPosition:"NEXT_BEAT"},{id:"add",patternId:"stab__8",channel:"main",songPosition:"NEXT_BEAT",patternPosition:"SYNC",clearPending:!1,replaceActive:!1,setAsCurrent:!1,loop:!0,loopLength:128,clearPosition:"NEXT_BEAT"},{id:"add",patternId:"synth_comp__8",channel:"main",songPosition:"NEXT_BEAT",patternPosition:"SYNC",clearPending:!1,replaceActive:!1,setAsCurrent:!1,loop:!0,loopLength:128,clearPosition:"NEXT_BEAT"},{id:"add",patternId:"synth_funk__8",channel:"main",songPosition:"NEXT_BEAT",patternPosition:"SYNC",clearPending:!1,replaceActive:!1,setAsCurrent:!1,loop:!0,loopLength:128,clearPosition:"NEXT_BEAT"},{id:"add",patternId:"synth_comp__8",channel:"main",songPosition:"NEXT_BEAT",patternPosition:"SYNC",clearPending:!1,replaceActive:!1,setAsCurrent:!1,loop:!0,loopLength:128,clearPosition:"NEXT_BEAT"},{id:"add",patternId:"synth_plucked__8",channel:"main",songPosition:"NEXT_BEAT",patternPosition:"SYNC",clearPending:!1,replaceActive:!1,setAsCurrent:!1,loop:!0,loopLength:128,clearPosition:"NEXT_BEAT"},{id:"add",patternId:"synth_pop__8",channel:"main",songPosition:"NEXT_BEAT",patternPosition:"SYNC",clearPending:!1,replaceActive:!1,setAsCurrent:!1,loop:!0,loopLength:128,clearPosition:"NEXT_BEAT"},{id:"add",patternId:"synth_sharp__8",channel:"main",songPosition:"NEXT_BEAT",patternPosition:"SYNC",clearPending:!1,replaceActive:!1,setAsCurrent:!1,loop:!0,loopLength:128,clearPosition:"NEXT_BEAT"}]},delay:0,instanceId:""},{type:"player",id:"beatPatternPlayer",triggers:["ghost_ball_activate"],actionProperties:{instanceId:"main",flowItems:[{id:"add",patternId:"empty_pattern",channel:"main",songPosition:"NEXT_BEAT",patternPosition:"SYNC",clearPending:!0,replaceActive:!0,setAsCurrent:!0,loop:!0,loopLength:128,clearPosition:"NEXT_BEAT"},{id:"add",patternId:"bass__9",channel:"main",songPosition:"NEXT_BEAT",patternPosition:"SYNC",clearPending:!1,replaceActive:!1,setAsCurrent:!1,loop:!0,loopLength:128,clearPosition:"NEXT_BEAT"},{id:"add",patternId:"bass_comp__9",channel:"main",songPosition:"NEXT_BEAT",patternPosition:"SYNC",clearPending:!1,replaceActive:!1,setAsCurrent:!1,loop:!0,loopLength:128,clearPosition:"NEXT_BEAT"},{id:"add",patternId:"bass_filter__9",channel:"main",songPosition:"NEXT_BEAT",patternPosition:"SYNC",clearPending:!1,replaceActive:!1,setAsCurrent:!1,loop:!0,loopLength:128,clearPosition:"NEXT_BEAT"},{id:"add",patternId:"dm_kraftwerk__9",channel:"main",songPosition:"NEXT_BEAT",patternPosition:"SYNC",clearPending:!1,replaceActive:!1,setAsCurrent:!1,loop:!0,loopLength:128,clearPosition:"NEXT_BEAT"},{id:"add",patternId:"stab__9",channel:"main",songPosition:"NEXT_BEAT",patternPosition:"SYNC",clearPending:!1,replaceActive:!1,setAsCurrent:!1,loop:!0,loopLength:128,clearPosition:"NEXT_BEAT"},{id:"add",patternId:"synth_funk__9",channel:"main",songPosition:"NEXT_BEAT",patternPosition:"SYNC",clearPending:!1,replaceActive:!1,setAsCurrent:!1,loop:!0,loopLength:128,clearPosition:"NEXT_BEAT"},{id:"add",patternId:"synth_plucked__9",channel:"main",songPosition:"NEXT_BEAT",patternPosition:"SYNC",clearPending:!1,replaceActive:!1,setAsCurrent:!1,loop:!0,loopLength:128,clearPosition:"NEXT_BEAT"},{id:"add",patternId:"synth_pop__9",channel:"main",songPosition:"NEXT_BEAT",patternPosition:"SYNC",clearPending:!1,replaceActive:!1,setAsCurrent:!1,loop:!0,loopLength:128,clearPosition:"NEXT_BEAT"},{id:"add",patternId:"synth_warm__9",channel:"main",songPosition:"NEXT_BEAT",patternPosition:"SYNC",clearPending:!1,replaceActive:!1,setAsCurrent:!1,loop:!0,loopLength:128,clearPosition:"NEXT_BEAT"}]},delay:0,instanceId:""},{type:"player",id:"beatPatternPlayer",triggers:["timebomb_activate"],actionProperties:{instanceId:"main",flowItems:[{id:"add",patternId:"empty_pattern",channel:"main",songPosition:"NEXT_BEAT",patternPosition:"SYNC",clearPending:!0,replaceActive:!0,setAsCurrent:!0,loop:!0,loopLength:128,clearPosition:"NEXT_BEAT"},{id:"add",patternId:"bass__10",channel:"main",songPosition:"NEXT_BEAT",patternPosition:"SYNC",clearPending:!1,replaceActive:!1,setAsCurrent:!1,loop:!0,loopLength:128,clearPosition:"NEXT_BEAT"},{id:"add",patternId:"bass_filter__10",channel:"main",songPosition:"NEXT_BEAT",patternPosition:"SYNC",clearPending:!1,replaceActive:!1,setAsCurrent:!1,loop:!0,loopLength:128,clearPosition:"NEXT_BEAT"},{id:"add",patternId:"dm_kraftwerk__10",channel:"main",songPosition:"NEXT_BEAT",patternPosition:"SYNC",clearPending:!1,replaceActive:!1,setAsCurrent:!1,loop:!0,loopLength:128,clearPosition:"NEXT_BEAT"},{id:"add",patternId:"stab__10",channel:"main",songPosition:"NEXT_BEAT",patternPosition:"SYNC",clearPending:!1,replaceActive:!1,setAsCurrent:!1,loop:!0,loopLength:128,clearPosition:"NEXT_BEAT"},{id:"add",patternId:"synth_comp__10",channel:"main",songPosition:"NEXT_BEAT",patternPosition:"SYNC",clearPending:!1,replaceActive:!1,setAsCurrent:!1,loop:!0,loopLength:128,clearPosition:"NEXT_BEAT"},{id:"add",patternId:"synth_perc__10",channel:"main",songPosition:"NEXT_BEAT",patternPosition:"SYNC",clearPending:!1,replaceActive:!1,setAsCurrent:!1,loop:!0,loopLength:128,clearPosition:"NEXT_BEAT"},{id:"add",patternId:"synth_plucked__10",channel:"main",songPosition:"NEXT_BEAT",patternPosition:"SYNC",clearPending:!1,replaceActive:!1,setAsCurrent:!1,loop:!0,loopLength:128,clearPosition:"NEXT_BEAT"},{id:"add",patternId:"synth_pop__10",channel:"main",songPosition:"NEXT_BEAT",patternPosition:"SYNC",clearPending:!1,replaceActive:!1,setAsCurrent:!1,loop:!0,loopLength:128,clearPosition:"NEXT_BEAT"},{id:"add",patternId:"synth_sharp__10",channel:"main",songPosition:"NEXT_BEAT",patternPosition:"SYNC",clearPending:!1,replaceActive:!1,setAsCurrent:!1,loop:!0,loopLength:128,clearPosition:"NEXT_BEAT"},{id:"add",patternId:"synth_warm__10",channel:"main",songPosition:"NEXT_BEAT",patternPosition:"SYNC",clearPending:!1,replaceActive:!1,setAsCurrent:!1,loop:!0,loopLength:128,clearPosition:"NEXT_BEAT"}]},delay:0,instanceId:""},{type:"player",id:"beatPatternPlayer",triggers:["death_ball_activate"],actionProperties:{instanceId:"main",flowItems:[{id:"add",patternId:"empty_pattern",channel:"main",songPosition:"NEXT_BEAT",patternPosition:"SYNC",clearPending:!0,replaceActive:!0,setAsCurrent:!0,loop:!0,loopLength:128,clearPosition:"NEXT_BEAT"},{id:"add",patternId:"bass__11",channel:"main",songPosition:"NEXT_BEAT",patternPosition:"SYNC",clearPending:!1,replaceActive:!1,setAsCurrent:!1,loop:!0,loopLength:128,clearPosition:"NEXT_BEAT"},{id:"add",patternId:"bass_filter__11",channel:"main",songPosition:"NEXT_BEAT",patternPosition:"SYNC",clearPending:!1,replaceActive:!1,setAsCurrent:!1,loop:!0,loopLength:128,clearPosition:"NEXT_BEAT"},{id:"add",patternId:"dm_kraftwerk__11",channel:"main",songPosition:"NEXT_BEAT",patternPosition:"SYNC",clearPending:!1,replaceActive:!1,setAsCurrent:!1,loop:!0,loopLength:128,clearPosition:"NEXT_BEAT"},{id:"add",patternId:"lead_a__11",channel:"main",songPosition:"NEXT_BEAT",patternPosition:"SYNC",clearPending:!1,replaceActive:!1,setAsCurrent:!1,loop:!0,loopLength:128,clearPosition:"NEXT_BEAT"},{id:"add",patternId:"synth_pop__11",channel:"main",songPosition:"NEXT_BEAT",patternPosition:"SYNC",clearPending:!1,replaceActive:!1,setAsCurrent:!1,loop:!0,loopLength:128,clearPosition:"NEXT_BEAT"}]},delay:0,instanceId:""},{type:"customCode",id:"customCode",triggers:["init_routing","user_won_round","user_lost_round","user_won_match","user_lost_match"],actionProperties:{instanceId:"LevelTransposer"},delay:0,instanceId:""},{type:"midiProcessor",id:"midiProcessor",triggers:["item_up","item_down","paddle_fx","extra_life","winloose_tone","shield_hit","bass_filter","lead_a","lead_b","strings","synth_funk","synth_plucked","synth_sharp","synth_warm","bass","bass_comp","stab","synth_comp","synth_perc","synth_pop"],actionProperties:{instanceId:"midi_transposer",_dynamicValues:[{key:"transpose",string:"customCode:LevelTransposer:transposeValue"}],transpose:0,dynamic:0,quantize:"",scale:"",root:"",customScale:""},delay:0,instanceId:""},{type:"sound",id:"genericPlay",triggers:["user_won_round"],actionProperties:{delay:0,instanceId:"win_round_buzz",soundFile:"win_round_buzz",volume:0,loop:-1,reTrig:-1,returnEvent:"",returnEventTime:0,preListen:0,bus:"pause_bus",timingCorrection:"PLAY",multiSuffix:"",pan:0,priority:!1},delay:0,instanceId:""},{type:"sound",id:"genericPlay",triggers:["user_lost_round"],actionProperties:{delay:0,instanceId:"loose_round_buzz",soundFile:"loose_round_buzz",volume:0,loop:-1,reTrig:-1,returnEvent:"",returnEventTime:0,preListen:0,bus:"pause_bus",timingCorrection:"PLAY",multiSuffix:"",pan:0,priority:!1},delay:0,instanceId:""},{type:"sound",id:"genericPlay",triggers:["user_lost_round"],actionProperties:{delay:0,instanceId:"loose_fanfare",soundFile:"loose_fanfare",volume:0,loop:-1,reTrig:-1,returnEvent:"",returnEventTime:0,preListen:0,bus:"pause_bus",timingCorrection:"PLAY",multiSuffix:"",pan:0,priority:!1},delay:0,instanceId:""},{type:"sound",id:"genericPlay",triggers:["user_won_round"],actionProperties:{delay:0,instanceId:"win_fanfare",soundFile:"win_fanfare",volume:0,loop:-1,reTrig:-1,returnEvent:"",returnEventTime:0,preListen:0,bus:"pause_bus",timingCorrection:"PLAY",multiSuffix:"",pan:0,priority:!1},delay:0,instanceId:""},{type:"sound",id:"genericPlay",triggers:["opponent_screen_explode"],actionProperties:{delay:0,instanceId:"opponent_screen_break_between_levels",soundFile:"opponent_screen_break_between_levels",volume:0,loop:-1,reTrig:-1,returnEvent:"",returnEventTime:0,preListen:0,bus:"pause_bus",timingCorrection:"PLAY",multiSuffix:"",pan:0,priority:!1},delay:0,instanceId:""},{type:"midiProcessor",id:"makeNote",triggers:["mirrored_controls_activate","mirrored_controls_spawn","fireball_activate","fireball_spawn","bulletproof_activate","bulletproof_spawn","multiball_activate","multiball_spawn","timebomb_activate","timebomb_spawn","ghost_ball_activate","ghost_ball_spawn","death_ball_activate","death_ball_spawn","extra_life_activate","user_paddle_hit","opponent_paddle_hit","wall_hit","obstacle_hit","user_shield_hit","opponent_shield_hit","opponent_score_hit","fog_spawn","fog_activate"],actionProperties:{instanceId:"makeFx",noteMaps:[{id:"noteMap",triggerIn:"extra_life_activate",triggerOut:"extra_life",note:"E1",velocity:127},{id:"noteMap",triggerIn:"user_paddle_hit",triggerOut:"paddle_fx",note:"E1",velocity:127},{id:"noteMap",triggerIn:"opponent_paddle_hit",triggerOut:"paddle_fx",note:"E2",velocity:127},{id:"noteMap",triggerIn:"wall_hit",triggerOut:"paddle_fx",note:"B2",velocity:127},{id:"noteMap",triggerIn:"obstacle_hit",triggerOut:"paddle_fx",note:"E3",velocity:127},{id:"noteMap",triggerIn:"opponent_shield_hit",triggerOut:"shield_hit",note:"E3",velocity:127},{id:"noteMap",triggerIn:"user_shield_hit",triggerOut:"shield_hit",note:"E3",velocity:127},{id:"noteMap",triggerIn:"opponent_score_hit",triggerOut:"winloose_tone",note:"E0",velocity:127},{id:"noteMap",triggerIn:"fog_spawn",triggerOut:"item_up",note:"E3",velocity:127},{id:"noteMap",triggerIn:"fog_activate",triggerOut:"item_down",note:"E3",velocity:127},{id:"noteMap",triggerIn:"extra_life_spawn",triggerOut:"item_up",note:"E3",velocity:127},{id:"noteMap",triggerIn:"death_ball_spawn",triggerOut:"item_up",note:"E3",velocity:127},{id:"noteMap",triggerIn:"death_ball_activate",triggerOut:"item_down",note:"E3",velocity:127},{id:"noteMap",triggerIn:"ghost_ball_spawn",triggerOut:"item_up",note:"E3",velocity:127},{id:"noteMap",triggerIn:"ghost_ball_activate",triggerOut:"item_down",note:"E3",velocity:127},{id:"noteMap",triggerIn:"timebomb_spawn",triggerOut:"item_up",note:"E3",velocity:127},{id:"noteMap",triggerIn:"timebomb_activate",triggerOut:"item_down",note:"E3",velocity:127},{id:"noteMap",triggerIn:"multiball_spawn",triggerOut:"item_up",note:"E3",velocity:127},{id:"noteMap",triggerIn:"multiball_activate",triggerOut:"item_down",note:"E3",velocity:127},{id:"noteMap",triggerIn:"bulletproof_spawn",triggerOut:"item_up",note:"E3",velocity:127},{id:"noteMap",triggerIn:"bulletproof_activate",triggerOut:"item_down",note:"E3",velocity:127},{id:"noteMap",triggerIn:"fireball_spawn",triggerOut:"item_up",note:"E3",velocity:127},{id:"noteMap",triggerIn:"fireball_activate",triggerOut:"item_down",note:"E3",velocity:127},{id:"noteMap",triggerIn:"mirrored_controls_spawn",triggerOut:"item_up",note:"E3",velocity:127},{id:"noteMap",triggerIn:"mirrored_controls_activate",triggerOut:"item_down",note:"E3",velocity:127}]},delay:0,instanceId:""},{type:"synth",id:"sampler",triggers:["paddle_fx"],actionProperties:{instanceId:"multi",ignoreNoteOff:!1,bus:"pause_bus",volume:1,loop:!1,ampAttack:1,ampDecay:450,ampRelease:260,ampSustain:1,ampVelocityRatio:1,filterOn:!1,audioNodes:[],sampleMapGroups:[{id:"sampleMapGroup",name:"map1",sampleMaps:[{id:"sampleMap",name:"paddle_fx",velocityLow:0,velocityHigh:127}]}],filterAttack:0,filterDecay:0,filterRelease:0,filterSustain:1,filterVelocityRatio:1,filterQ:1e-4,filterFrequency:0,filterGain:0},delay:0,instanceId:""},{type:"synth",id:"sampler",triggers:["extra_life"],actionProperties:{instanceId:"multi",ignoreNoteOff:!1,bus:"pause_bus",volume:1,loop:!1,ampAttack:1,ampDecay:450,ampRelease:260,ampSustain:1,ampVelocityRatio:1,filterOn:!1,audioNodes:[],sampleMapGroups:[{id:"sampleMapGroup",name:"map1",sampleMaps:[{id:"sampleMap",name:"extralife",velocityLow:0,velocityHigh:127}]}],filterAttack:0,filterDecay:0,filterRelease:0,filterSustain:1,filterVelocityRatio:1,filterQ:1e-4,filterFrequency:0,filterGain:0},delay:0,instanceId:""},{type:"synth",id:"sampler",triggers:["winloose_tone"],actionProperties:{instanceId:"multi",ignoreNoteOff:!1,bus:"pause_bus",volume:1,loop:!1,ampAttack:1,ampDecay:450,ampRelease:260,ampSustain:1,ampVelocityRatio:1,filterOn:!1,audioNodes:[],sampleMapGroups:[{id:"sampleMapGroup",name:"map1",sampleMaps:[{id:"sampleMap",name:"winloose_tone",velocityLow:0,velocityHigh:127}]}],filterAttack:0,filterDecay:0,filterRelease:0,filterSustain:1,filterVelocityRatio:1,filterQ:1e-4,filterFrequency:0,filterGain:0},delay:0,instanceId:""},{type:"synth",id:"sampler",triggers:["shield_hit"],actionProperties:{instanceId:"multi",ignoreNoteOff:!1,bus:"pause_bus",volume:1,loop:!1,ampAttack:1,ampDecay:450,ampRelease:260,ampSustain:1,ampVelocityRatio:1,filterOn:!1,audioNodes:[],sampleMapGroups:[{id:"sampleMapGroup",name:"map1",sampleMaps:[{id:"sampleMap",name:"Shield_Hit",velocityLow:0,velocityHigh:127}]}],filterAttack:0,filterDecay:0,filterRelease:0,filterSustain:1,filterVelocityRatio:1,filterQ:1e-4,filterFrequency:0,filterGain:0},delay:0,instanceId:""},{type:"synth",id:"sampler",triggers:["item_up"],actionProperties:{instanceId:"multi",ignoreNoteOff:!1,bus:"pause_bus",volume:1,loop:!1,ampAttack:1,ampDecay:450,ampRelease:260,ampSustain:1,ampVelocityRatio:1,filterOn:!1,audioNodes:[],sampleMapGroups:[{id:"sampleMapGroup",name:"map1",sampleMaps:[{id:"sampleMap",name:"Item_Up",velocityLow:0,velocityHigh:127}]}],filterAttack:0,filterDecay:0,filterRelease:0,filterSustain:1,filterVelocityRatio:1,filterQ:1e-4,filterFrequency:0,filterGain:0},delay:0,instanceId:""},{type:"synth",id:"sampler",triggers:["item_down"],actionProperties:{instanceId:"multi",ignoreNoteOff:!1,bus:"pause_bus",volume:1,loop:!1,ampAttack:1,ampDecay:450,ampRelease:260,ampSustain:1,ampVelocityRatio:1,filterOn:!1,audioNodes:[],sampleMapGroups:[{id:"sampleMapGroup",name:"map1",sampleMaps:[{id:"sampleMap",name:"Item_Down",velocityLow:0,velocityHigh:127}]}],filterAttack:0,filterDecay:0,filterRelease:0,filterSustain:1,filterVelocityRatio:1,filterQ:1e-4,filterFrequency:0,filterGain:0},delay:0,instanceId:""},{type:"parameterProcessor",id:"transform",triggers:["bass_filter_mute","lead_a_mute","lead_b_mute","strings_mute","synth_funk_mute","synth_plucked_mute","synth_sharp_mute","synth_warm_mute","dm_kraftwerk_mute","bass_mute","bass_comp_mute","stab_mute","synth_comp_mute","synth_perc_mute","synth_pop_mute"],actionProperties:{instanceId:"muteInst",targetType:"synth",targets:["multi"],targetParameter:"volume",multiSuffix:"_mute",value:-80,duration:100,delay:0,curve:0},delay:0,instanceId:""},{type:"parameterProcessor",id:"transform",triggers:["bass_filter_unmute","lead_a_unmute","lead_b_unmute","strings_unmute","synth_funk_unmute","synth_plucked_unmute","synth_sharp_unmute","synth_warm_unmute","dm_kraftwerk_unmute","bass_unmute","bass_comp_unmute","stab_unmute","synth_comp_unmute","synth_perc_unmute","synth_pop_unmute"],actionProperties:{instanceId:"unmuteInst",targetType:"synth",targets:["multi"],targetParameter:"volume",multiSuffix:"_unmute",value:-5,duration:100,delay:0,curve:0},delay:0,instanceId:""},{type:"synth",id:"sampler",triggers:["bass_filter"],actionProperties:{instanceId:"multi",ignoreNoteOff:!1,bus:"pause_bus",volume:1,loop:!0,ampAttack:1,ampDecay:450,ampRelease:260,ampSustain:1,ampVelocityRatio:1,filterOn:!1,audioNodes:[],sampleMapGroups:[{id:"sampleMapGroup",name:"map1",sampleMaps:[{id:"sampleMap",name:"bass_filter_low",velocityLow:0,velocityHigh:50},{id:"sampleMap",name:"bass_filter_mid",velocityLow:51,velocityHigh:100},{id:"sampleMap",name:"bass_filter_hi",velocityLow:101,velocityHigh:127}]}],filterAttack:0,filterDecay:0,filterRelease:0,filterSustain:1,filterVelocityRatio:1,filterQ:1e-4,filterFrequency:0,filterGain:0},delay:0,instanceId:""},{type:"synth",id:"sampler",triggers:["bass_comp"],actionProperties:{instanceId:"multi",ignoreNoteOff:!1,bus:"pause_bus",volume:-2,loop:!0,ampAttack:10,ampDecay:450,ampRelease:500,ampSustain:1,ampVelocityRatio:1,filterOn:!1,audioNodes:[],sampleMapGroups:[{id:"sampleMapGroup",name:"map1",sampleMaps:[{id:"sampleMap",name:"multi",velocityLow:0,velocityHigh:127}]}],filterAttack:0,filterDecay:0,filterRelease:0,filterSustain:1,filterVelocityRatio:1,filterQ:1e-4,filterFrequency:0,filterGain:0},delay:0,instanceId:""},{type:"synth",id:"sampler",triggers:["bass"],actionProperties:{instanceId:"multi",ignoreNoteOff:!1,bus:"pause_bus",volume:-2,loop:!0,ampAttack:1,ampDecay:1,ampRelease:220,ampSustain:1,ampVelocityRatio:1,filterOn:!1,audioNodes:[],sampleMapGroups:[{id:"sampleMapGroup",name:"map1",sampleMaps:[{id:"sampleMap",name:"multi",velocityLow:0,velocityHigh:127}]}],filterAttack:0,filterDecay:0,filterRelease:0,filterSustain:1,filterVelocityRatio:1,filterQ:1e-4,filterFrequency:0,filterGain:0},delay:0,instanceId:""},{type:"synth",id:"sampler",triggers:["stab"],actionProperties:{instanceId:"multi",ignoreNoteOff:!1,bus:"pause_bus",volume:-4.5,loop:!0,ampAttack:1,ampDecay:1,ampRelease:100,ampSustain:1,ampVelocityRatio:0,filterOn:!1,audioNodes:[],sampleMapGroups:[{id:"sampleMapGroup",name:"map1",sampleMaps:[{id:"sampleMap",name:"multi",velocityLow:0,velocityHigh:127}]}],filterAttack:0,filterDecay:0,filterRelease:0,filterSustain:1,filterVelocityRatio:1,filterQ:1e-4,filterFrequency:0,filterGain:0},delay:0,instanceId:""},{type:"synth",id:"sampler",triggers:["strings"],actionProperties:{instanceId:"multi",ignoreNoteOff:!1,bus:"pause_bus",volume:-6,loop:!0,ampAttack:1,ampDecay:1,ampRelease:220,ampSustain:1,ampVelocityRatio:1,filterOn:!1,audioNodes:[],sampleMapGroups:[{id:"sampleMapGroup",name:"map1",sampleMaps:[{id:"sampleMap",name:"multi",velocityLow:0,velocityHigh:127}]}],filterAttack:0,filterDecay:0,filterRelease:0,filterSustain:1,filterVelocityRatio:1,filterQ:1e-4,filterFrequency:0,filterGain:0},delay:0,instanceId:""},{type:"synth",id:"sampler",triggers:["synth_comp"],actionProperties:{instanceId:"multi",ignoreNoteOff:!1,bus:"pause_bus",volume:-3.5,loop:!0,ampAttack:1,ampDecay:1,ampRelease:1,ampSustain:1,ampVelocityRatio:1,filterOn:!1,audioNodes:[],sampleMapGroups:[{id:"sampleMapGroup",name:"map1",sampleMaps:[{id:"sampleMap",name:"multi",velocityLow:0,velocityHigh:127}]}],filterAttack:0,filterDecay:0,filterRelease:0,filterSustain:1,filterVelocityRatio:1,filterQ:1e-4,filterFrequency:0,filterGain:0},delay:0,instanceId:""},{type:"synth",id:"sampler",triggers:["synth_funk"],actionProperties:{instanceId:"multi",ignoreNoteOff:!1,bus:"pause_bus",volume:-5.5,loop:!0,ampAttack:1,ampDecay:200,ampRelease:300,ampSustain:1,ampVelocityRatio:1,filterOn:!1,audioNodes:[],sampleMapGroups:[{id:"sampleMapGroup",name:"map1",sampleMaps:[{id:"sampleMap",name:"multi",velocityLow:0,velocityHigh:127}]}],filterAttack:0,filterDecay:0,filterRelease:0,filterSustain:1,filterVelocityRatio:1,filterQ:1e-4,filterFrequency:0,filterGain:0},delay:0,instanceId:""},{type:"synth",id:"sampler",triggers:["synth_perc"],actionProperties:{instanceId:"multi",ignoreNoteOff:!1,bus:"pause_bus",volume:-13,loop:!0,ampAttack:1,ampDecay:1,ampRelease:1,ampSustain:1,ampVelocityRatio:1,filterOn:!1,audioNodes:[],sampleMapGroups:[{id:"sampleMapGroup",name:"map1",sampleMaps:[{id:"sampleMap",name:"multi",velocityLow:0,velocityHigh:127}]}],filterAttack:0,filterDecay:0,filterRelease:0,filterSustain:1,filterVelocityRatio:1,filterQ:1e-4,filterFrequency:0,filterGain:0},delay:0,instanceId:""},{type:"synth",id:"sampler",triggers:["synth_plucked"],actionProperties:{instanceId:"multi",ignoreNoteOff:!1,bus:"pause_bus",volume:0,loop:!0,ampAttack:1,ampDecay:1,ampRelease:45,ampSustain:1,ampVelocityRatio:1,filterOn:!1,audioNodes:[],sampleMapGroups:[{id:"sampleMapGroup",name:"map1",sampleMaps:[{id:"sampleMap",name:"multi",velocityLow:0,velocityHigh:127}]}],filterAttack:0,filterDecay:0,filterRelease:0,filterSustain:1,filterVelocityRatio:1,filterQ:1e-4,filterFrequency:0,filterGain:0},delay:0,instanceId:""},{type:"synth",id:"sampler",triggers:["synth_pop"],actionProperties:{instanceId:"multi",ignoreNoteOff:!1,bus:"pause_bus",volume:-2,loop:!0,ampAttack:1,ampDecay:1,ampRelease:350,ampSustain:1,ampVelocityRatio:0,filterOn:!1,audioNodes:[],sampleMapGroups:[{id:"sampleMapGroup",name:"map1",sampleMaps:[{id:"sampleMap",name:"multi",velocityLow:0,velocityHigh:127}]}],filterAttack:0,filterDecay:0,filterRelease:0,filterSustain:1,filterVelocityRatio:1,filterQ:1e-4,filterFrequency:0,filterGain:0},delay:0,instanceId:""},{type:"synth",id:"sampler",triggers:["synth_sharp"],actionProperties:{instanceId:"multi",ignoreNoteOff:!1,bus:"pause_bus",volume:-7.5,loop:!0,ampAttack:1,ampDecay:1,ampRelease:100,ampSustain:1,ampVelocityRatio:0,filterOn:!1,audioNodes:[],sampleMapGroups:[{id:"sampleMapGroup",name:"map1",sampleMaps:[{id:"sampleMap",name:"multi",velocityLow:0,velocityHigh:127}]}],filterAttack:0,filterDecay:0,filterRelease:0,filterSustain:1,filterVelocityRatio:1,filterQ:1e-4,filterFrequency:0,filterGain:0},delay:0,instanceId:""},{type:"synth",id:"sampler",triggers:["synth_warm"],actionProperties:{instanceId:"multi",ignoreNoteOff:!1,bus:"pause_bus",volume:-13,loop:!0,ampAttack:1,ampDecay:1,ampRelease:500,ampSustain:1,ampVelocityRatio:0,filterOn:!1,audioNodes:[],sampleMapGroups:[{id:"sampleMapGroup",name:"map1",sampleMaps:[{id:"sampleMap",name:"multi",velocityLow:0,velocityHigh:127}]}],filterAttack:0,filterDecay:0,filterRelease:0,filterSustain:1,filterVelocityRatio:1,filterQ:1e-4,filterFrequency:0,filterGain:0},delay:0,instanceId:""},{type:"synth",id:"sampler",triggers:["lead_a"],actionProperties:{instanceId:"multi",ignoreNoteOff:!0,bus:"pause_bus",volume:-8,loop:!0,ampAttack:1,ampDecay:350,ampRelease:550,ampSustain:1,ampVelocityRatio:1,filterOn:!1,audioNodes:[],sampleMapGroups:[{id:"sampleMapGroup",name:"map1",sampleMaps:[{id:"sampleMap",name:"multi",velocityLow:0,velocityHigh:127}]}],filterAttack:0,filterDecay:0,filterRelease:0,filterSustain:1,filterVelocityRatio:1,filterQ:1e-4,filterFrequency:0,filterGain:0},delay:0,instanceId:""},{type:"synth",id:"sampler",triggers:["lead_b"],actionProperties:{instanceId:"multi",ignoreNoteOff:!0,bus:"pause_bus",volume:-9,loop:!0,ampAttack:1,ampDecay:100,ampRelease:640,ampSustain:1,ampVelocityRatio:1,filterOn:!1,audioNodes:[],sampleMapGroups:[{id:"sampleMapGroup",name:"map1",sampleMaps:[{id:"sampleMap",name:"multi",velocityLow:0,velocityHigh:127}]}],filterAttack:0,filterDecay:0,filterRelease:0,filterSustain:1,filterVelocityRatio:1,filterQ:1e-4,filterFrequency:0,filterGain:0},delay:0,instanceId:""},{type:"synth",id:"sampler",triggers:["dm_kraftwerk"],actionProperties:{instanceId:"multi",ignoreNoteOff:!1,bus:"pause_bus",volume:-3,loop:!0,ampAttack:1,ampDecay:1,ampRelease:1,ampSustain:1,ampVelocityRatio:1,filterOn:!1,audioNodes:[],sampleMapGroups:[{id:"sampleMapGroup",name:"map1",sampleMaps:[{id:"sampleMap",name:"multi",velocityLow:0,velocityHigh:127}]}],filterAttack:0,filterDecay:0,filterRelease:0,filterSustain:1,filterVelocityRatio:1,filterQ:1e-4,filterFrequency:0,filterGain:0},delay:0,instanceId:""},{type:"assetController",id:"loadMIDI",triggers:["preload_assets"],actionProperties:{instanceId:"midiLoader",returnEvent:"",files:[{id:"file",type:"beatPattern",name:"bass"},{id:"file",type:"beatPattern",name:"bass_comp"},{id:"file",type:"beatPattern",name:"bass_filter"},{id:"file",type:"beatPattern",name:"dm_kraftwerk"},{id:"file",type:"beatPattern",name:"lead_a"},{id:"file",type:"beatPattern",name:"lead_b"},{id:"file",type:"beatPattern",name:"stab"},{id:"file",type:"beatPattern",name:"strings"},{id:"file",type:"beatPattern",name:"synth_comp"},{id:"file",type:"beatPattern",name:"synth_funk"},{id:"file",type:"beatPattern",name:"synth_perc"},{id:"file",type:"beatPattern",name:"synth_plucked"},{id:"file",type:"beatPattern",name:"synth_pop"},{id:"file",type:"beatPattern",name:"synth_sharp"},{id:"file",type:"beatPattern",name:"synth_warm"},{id:"file",type:"beatPattern",name:"winloose_tone"}]},delay:0,instanceId:""},{type:"assetController",id:"loadSampleMap",triggers:["preload_assets"],actionProperties:{instanceId:"load_sampleMaps",returnEvent:"",files:[{id:"file",name:"samplemaps"}]},delay:0,instanceId:""},{type:"assetController",id:"loadSound",triggers:["dmaf_ready"],actionProperties:{instanceId:"load_fx",returnEvent:"",files:[{id:"file",name:"Item_Up_E3"},{id:"file",name:"Item_Down_E3"},{id:"file",name:"PaddleFX_E0"},{id:"file",name:"PaddleFX_G0"},{id:"file",name:"PaddleFX_B0"},{id:"file",name:"PaddleFX_E1"},{id:"file",name:"PaddleFX_G1"},{id:"file",name:"PaddleFX_B1"},{id:"file",name:"PaddleFX_E2"},{id:"file",name:"PaddleFX_G2"},{id:"file",name:"PaddleFX_B2"},{id:"file",name:"PaddleFX_E3"},{id:"file",name:"PaddleFX_G3"},{id:"file",name:"PaddleFX_B3"},{id:"file",name:"ExtraLife_E1"},{id:"file",name:"ExtraLife_B1"},{id:"file",name:"ExtraLife_E2"},{id:"file",name:"Loose_Perc"},{id:"file",name:"Loose_E0"},{id:"file",name:"Loose_B0"},{id:"file",name:"Loose_E1"},{id:"file",name:"Loose_B1"},{id:"file",name:"Loose_E2"},{id:"file",name:"Loose_B2"},{id:"file",name:"Loose_E3"},{id:"file",name:"Loose_B3"},{id:"file",name:"Loose_E4"},{id:"file",name:"Loose_B4"},{id:"file",name:"Loose_E5"},{id:"file",name:"Loose_B5"},{id:"file",name:"Shield_Hit_E3"},{id:"file",name:"Shield_Hit_B3"},{id:"file",name:"Shield_Hit_E4"},{id:"file",name:"Shield_Hit_B4"},{id:"file",name:"loose_fanfare"},{id:"file",name:"loose_round_buzz"},{id:"file",name:"opponent_screen_break_between_levels"},{id:"file",name:"win_fanfare"},{id:"file",name:"win_round_buzz"}]},delay:0,instanceId:""},{type:"assetController",id:"loadSound",triggers:["dmaf_ready"],actionProperties:{instanceId:"load_bass_comp",returnEvent:"",files:[{id:"file",name:"Bass_Comp_E-1"},{id:"file",name:"Bass_Comp_As-1"},{id:"file",name:"Bass_Comp_E0"},{id:"file",name:"Bass_Comp_As0"},{id:"file",name:"Bass_Comp_E1"},{id:"file",name:"Bass_Comp_As1"},{id:"file",name:"Bass_Comp_E2"},{id:"file",name:"Bass_Comp_As2"},{id:"file",name:"Bass_Comp_E3"},{id:"file",name:"Bass_Comp_As3"},{id:"file",name:"Bass_Comp_E4"},{id:"file",name:"Bass_Comp_As4"}]},delay:0,instanceId:""},{type:"assetController",id:"loadSound",triggers:["preload_assets"],actionProperties:{instanceId:"load_bass",returnEvent:"",files:[{id:"file",name:"Bass_E0"},{id:"file",name:"Bass_As0"},{id:"file",name:"Bass_E1"},{id:"file",name:"Bass_As1"},{id:"file",name:"Bass_E2"},{id:"file",name:"Bass_As2"},{id:"file",name:"Bass_E3"},{id:"file",name:"Bass_As3"},{id:"file",name:"Bass_E4"},{id:"file",name:"Bass_As4"},{id:"file",name:"Bass_E5"},{id:"file",name:"Bass_As5"}]},delay:0,instanceId:""},{type:"assetController",id:"loadSound",triggers:["preload_assets"],actionProperties:{instanceId:"load_stab",returnEvent:"",files:[{id:"file",name:"Stab_E0"},{id:"file",name:"Stab_As0"},{id:"file",name:"Stab_E1"},{id:"file",name:"Stab_As1"},{id:"file",name:"Stab_E2"},{id:"file",name:"Stab_As2"},{id:"file",name:"Stab_E3"},{id:"file",name:"Stab_As3"},{id:"file",name:"Stab_E4"},{id:"file",name:"Stab_As4"},{id:"file",name:"Stab_E5"},{id:"file",name:"Stab_As5"}]},delay:0,instanceId:""},{type:"assetController",id:"loadSound",triggers:["preload_assets"],actionProperties:{instanceId:"load_kraftwerk",returnEvent:"",files:[{id:"file",name:"KICK"},{id:"file",name:"SNARE"},{id:"file",name:"Hitt_2"},{id:"file",name:"hihat"},{id:"file",name:"Tapp_L"},{id:"file",name:"Tapp_R"},{id:"file",name:"Battery_1"},{id:"file",name:"Battery_2"},{id:"file",name:"Battery_3"},{id:"file",name:"Battery_4"},{id:"file",name:"Battery_5"},{id:"file",name:"Battery_6"},{id:"file",name:"Battery_7"},{id:"file",name:"Battery_8"},{id:"file",name:"Battery_9"}]},delay:0,instanceId:""},{type:"assetController",id:"loadSound",triggers:["preload_assets"],actionProperties:{instanceId:"load_synth_perc",returnEvent:"",files:[{id:"file",name:"Synth_Perc_E0"},{id:"file",name:"Synth_Perc_As0"},{id:"file",name:"Synth_Perc_E1"},{id:"file",name:"Synth_Perc_As1"},{id:"file",name:"Synth_Perc_E2"},{id:"file",name:"Synth_Perc_As2"},{id:"file",name:"Synth_Perc_E3"},{id:"file",name:"Synth_Perc_As3"},{id:"file",name:"Synth_Perc_E4"},{id:"file",name:"Synth_Perc_As4"},{id:"file",name:"Synth_Perc_E5"},{id:"file",name:"Synth_Perc_As5"}]},delay:0,instanceId:""},{type:"assetController",id:"loadSound",triggers:["preload_assets"],actionProperties:{instanceId:"load_synth_pop",returnEvent:"",files:[{id:"file",name:"Synth_Pop_E0"},{id:"file",name:"Synth_Pop_As0"},{id:"file",name:"Synth_Pop_E1"},{id:"file",name:"Synth_Pop_As1"},{id:"file",name:"Synth_Pop_E2"},{id:"file",name:"Synth_Pop_As2"},{id:"file",name:"Synth_Pop_E3"},{id:"file",name:"Synth_Pop_As3"},{id:"file",name:"Synth_Pop_E4"},{id:"file",name:"Synth_Pop_As4"},{id:"file",name:"Synth_Pop_E5"},{id:"file",name:"Synth_Pop_As5"}]},delay:0,instanceId:""},{type:"assetController",id:"loadSound",triggers:["preload_assets"],actionProperties:{instanceId:"load_synth_comp",returnEvent:"",files:[{id:"file",name:"Synth_Comp_E0"},{id:"file",name:"Synth_Comp_As0"},{id:"file",name:"Synth_Comp_E1"},{id:"file",name:"Synth_Comp_As1"},{id:"file",name:"Synth_Comp_E2"},{id:"file",name:"Synth_Comp_As2"},{id:"file",name:"Synth_Comp_E3"},{id:"file",name:"Synth_Comp_As3"},{id:"file",name:"Synth_Comp_E4"},{id:"file",name:"Synth_Comp_As4"},{id:"file",name:"Synth_Comp_E5"},{id:"file",name:"Synth_Comp_As5"}]},delay:0,instanceId:""},{type:"assetController",id:"loadSound",triggers:["preload_assets"],actionProperties:{instanceId:"load_strings",returnEvent:"",files:[{id:"file",name:"Strings_E0"},{id:"file",name:"Strings_As0"},{id:"file",name:"Strings_E1"},{id:"file",name:"Strings_As1"},{id:"file",name:"Strings_E2"},{id:"file",name:"Strings_As2"},{id:"file",name:"Strings_E3"},{id:"file",name:"Strings_As3"}]},delay:0,instanceId:""},{type:"assetController",id:"loadSound",triggers:["dmaf_ready"],actionProperties:{instanceId:"load_synth_plucked",returnEvent:"",files:[{id:"file",name:"Synth_Plucked_E0"},{id:"file",name:"Synth_Plucked_As0"},{id:"file",name:"Synth_Plucked_E1"},{id:"file",name:"Synth_Plucked_As1"},{id:"file",name:"Synth_Plucked_E2"},{id:"file",name:"Synth_Plucked_As2"},{id:"file",name:"Synth_Plucked_E3"},{id:"file",name:"Synth_Plucked_As3"},{id:"file",name:"Synth_Plucked_E4"},{id:"file",name:"Synth_Plucked_As4"},{id:"file",name:"Synth_Plucked_E5"},{id:"file",name:"Synth_Plucked_As5"}]},delay:0,instanceId:""},{type:"assetController",id:"loadSound",triggers:["dmaf_ready"],actionProperties:{instanceId:"load_synth_sharp",returnEvent:"",files:[{id:"file",name:"Synth_Sharp_E1"},{id:"file",name:"Synth_Sharp_As1"},{id:"file",name:"Synth_Sharp_E2"},{id:"file",name:"Synth_Sharp_As2"},{id:"file",name:"Synth_Sharp_E3"},{id:"file",name:"Synth_Sharp_As3"},{id:"file",name:"Synth_Sharp_E4"},{id:"file",name:"Synth_Sharp_As4"},{id:"file",name:"Synth_Sharp_E5"},{id:"file",name:"Synth_Sharp_As5"}]},delay:0,instanceId:""},{type:"assetController",id:"loadSound",triggers:["dmaf_ready"],actionProperties:{instanceId:"load_synth_funk",returnEvent:"",files:[{id:"file",name:"Synth_Funk_E0"},{id:"file",name:"Synth_Funk_As0"},{id:"file",name:"Synth_Funk_E1"},{id:"file",name:"Synth_Funk_As1"},{id:"file",name:"Synth_Funk_E2"},{id:"file",name:"Synth_Funk_As2"},{id:"file",name:"Synth_Funk_E3"},{id:"file",name:"Synth_Funk_As3"},{id:"file",name:"Synth_Funk_E4"},{id:"file",name:"Synth_Funk_As4"},{id:"file",name:"Synth_Funk_E5"},{id:"file",name:"Synth_Funk_As5"}]},delay:0,instanceId:""},{type:"assetController",id:"loadSound",triggers:["dmaf_ready"],actionProperties:{instanceId:"load_synth_warm",returnEvent:"",files:[{id:"file",name:"Synth_Warm_E0"},{id:"file",name:"Synth_Warm_As0"},{id:"file",name:"Synth_Warm_E1"},{id:"file",name:"Synth_Warm_As1"},{id:"file",name:"Synth_Warm_E2"},{id:"file",name:"Synth_Warm_As2"},{id:"file",name:"Synth_Warm_E3"},{id:"file",name:"Synth_Warm_As3"},{id:"file",name:"Synth_Warm_E4"},{id:"file",name:"Synth_Warm_As4"}]},delay:0,instanceId:""},{type:"assetController",id:"loadSound",triggers:["dmaf_ready"],actionProperties:{instanceId:"load_lead_a",returnEvent:"",files:[{id:"file",name:"Lead_A_E1"},{id:"file",name:"Lead_A_As1"},{id:"file",name:"Lead_A_E2"},{id:"file",name:"Lead_A_As2"},{id:"file",name:"Lead_A_E3"},{id:"file",name:"Lead_A_As3"},{id:"file",name:"Lead_A_E4"},{id:"file",name:"Lead_A_As4"},{id:"file",name:"Lead_A_E5"},{id:"file",name:"Lead_A_As5"},{id:"file",name:"Lead_A_E6"},{id:"file",name:"Lead_A_As6"}]},delay:0,instanceId:""},{type:"assetController",id:"loadSound",triggers:["dmaf_ready"],actionProperties:{instanceId:"load_lead_b",returnEvent:"",files:[{id:"file",name:"Lead_B_E1"},{id:"file",name:"Lead_B_As1"},{id:"file",name:"Lead_B_E2"},{id:"file",name:"Lead_B_As2"},{id:"file",name:"Lead_B_E3"},{id:"file",name:"Lead_B_As3"},{id:"file",name:"Lead_B_E4"},{id:"file",name:"Lead_B_As4"},{id:"file",name:"Lead_B_E5"},{id:"file",name:"Lead_B_As5"},{id:"file",name:"Lead_B_E6"},{id:"file",name:"Lead_B_As6"}]},delay:0,instanceId:""},{type:"assetController",id:"loadSound",triggers:["preload_assets"],actionProperties:{instanceId:"load_bass_filter",returnEvent:"",files:[{id:"file",name:"Bass_Filter_Low_E2"},{id:"file",name:"Bass_Filter_Low_As2"},{id:"file",name:"Bass_Filter_Low_E3"},{id:"file",name:"Bass_Filter_Low_As3"},{id:"file",name:"Bass_Filter_Low_E4"},{id:"file",name:"Bass_Filter_Low_As4"},{id:"file",name:"Bass_Filter_Low_E5"},{id:"file",name:"Bass_Filter_Low_As5"},{id:"file",name:"Bass_Filter_Low_E6"},{id:"file",name:"Bass_Filter_Low_As6"},{id:"file",name:"Bass_Filter_Mid_E2"},{id:"file",name:"Bass_Filter_Mid_As2"},{id:"file",name:"Bass_Filter_Mid_E3"},{id:"file",name:"Bass_Filter_Mid_As3"},{id:"file",name:"Bass_Filter_Mid_E4"},{id:"file",name:"Bass_Filter_Mid_As4"},{id:"file",name:"Bass_Filter_Mid_E5"},{id:"file",name:"Bass_Filter_Mid_As5"},{id:"file",name:"Bass_Filter_Mid_E6"},{id:"file",name:"Bass_Filter_Mid_As6"},{id:"file",name:"Bass_Filter_Hi_E2"},{id:"file",name:"Bass_Filter_Hi_As2"},{id:"file",name:"Bass_Filter_Hi_E3"},{id:"file",name:"Bass_Filter_Hi_As3"},{id:"file",name:"Bass_Filter_Hi_E4"},{id:"file",name:"Bass_Filter_Hi_As4"},{id:"file",name:"Bass_Filter_Hi_E5"},{id:"file",name:"Bass_Filter_Hi_As5"},{id:"file",name:"Bass_Filter_Hi_E6"},{id:"file",name:"Bass_Filter_Hi_As6"}]},delay:0,instanceId:""}],assetsPath:"./dmaf_assets/"}
}),dmaf.once("load_modules",function(e){function t(){}function n(){}function a(){}function o(){}function s(e){return e.name}var r="assetController",l={loadSampleMap:"xml/",loadMIDI:"midi/",loadSound:"audio/",loadCustomCode:"js/"},c=Object.create(e.InstancePrototype,{init:{value:function(){this.loadCount=0}},onload:{value:function(){this.returnEvent&&e.dispatch(this.returnEvent),e[this.type][this.id].removeInstance(this.instanceId)}},onstep:{value:function(){var t=100-Math.floor(100*(--d.loadsInProgress/d.loadTotals[this.task]));t!==d.loadPercents[this.task]&&(e.dispatch("progress_event",t,this.fileNames[this.loadCount]+this.format),d.loadPercents[this.task]=t),++this.loadCount===this.fileNames.length&&this.onload()}},onAction:{value:function(t){if(!this.inProgress){var i=e.Settings.assetsPath+l[this.id];d.listenForLoads(t),this.task=t,this.fileNames=this.files.map(s),d.loadsInProgress+=this.fileNames.length,this.inProgress=!0;for(var n=0,a=this.fileNames.length;a>n;n++)this.loadFile(i+this.fileNames[n]+this.format,this.fileNames[n],n)}}}}),d={beatPattern:{},sampleMap:{},buffer:{},timePattern:{},loadsInProgress:0,loadTotals:{},loadPercents:{},listenForLoads:function(t){if(void 0===this.loadTotals[t]){var n=e.ActionManager.triggers[t];if(n.length)for(n=n.slice(0).filter(function(e){return e.type=r,r}),this.loadTotals[t]=0,this.loadPercents[t]=0,i=0,ii=n.length;ii>i;i++)this.loadTotals[t]+=n[i].actionProperties.files.length}}};e.Assets=d,e.getAsset=function(e,t){return d[e]&&d[e][t]?d[e][t]:(dmaf.log&&console.log("DMAF.getAsset: Couldn't find asset",e,t),null)},e.setAsset=function(e,t,i){d[e]=d[e]||{},d[e][t]=i},t.prototype=Object.create(c,{format:{value:".js"},loadFile:{value:function(t){var i=this,n=document.createElement("script");n.type="text/javascript",n.src=t,n.addEventListener("load",function(){e.dispatch("load_custom",e),i.onstep(),void 0!==n.remove&&n.remove()}),document.body.appendChild(n)}}}),e.registerInstance(r,"loadCustomCode",t),n.prototype=Object.create(c,{format:{value:".xml"},loadFile:{value:function(t){function i(t){e.parse("samplemap",t)}var n={chain:[this.onstep],context:this,responseXML:!0,fail:function(){dmaf.log&&console.log("Problem parsing samplemap file"),this.onstep()}};e.Utils.ajax(t,i,n)}}}),e.registerInstance(r,"loadSampleMap",n),a.prototype=Object.create(c,{format:{value:".mid"},loadFile:{value:function(t,i,n){function a(t){e.parse("midi",t,this.files[n].type,i),this.onstep()}var o={override:"text/plain; charset=x-user-defined",expectType:"string",context:this,fail:function(){dmaf.log&&console.log("Problem parsing midi file",t),this.onstep()}.bind(this)};e.Utils.ajax(t,a,o)}}}),e.registerInstance(r,"loadMIDI",a),o.prototype=Object.create(c,{loadFile:{value:function(t,i){function n(t){l>0&&dmaf.log&&console.log("Retry success",i),e.context.decodeAudioData(t,s,r)}function a(){3>++l?(dmaf.log&&console.log("Could not load audio file",i,"trying again."),e.Utils.ajax(t,n,o,"buffer")):(dmaf.log&&console.log("Could not load audio file",i),this.onstep())}var o={responseType:"arraybuffer",fail:a.bind(this)},s=function(e){d.buffer[i]=e,this.onstep()}.bind(this),r=function(e){dmaf.log&&console.log("Could not decode file",i,e),this.onstep()}.bind(this),l=0;e.Utils.ajax(t,n,o,"buffer")}},format:{value:e.fileFormat}}),e.registerInstance(r,"loadSound",o)}),dmaf.once("load_modules",function(e){function t(){this.input=e.context.createGainNode(),this.output=e.context.createGainNode()}var i="audioRouter",n=e.InstancePrototype;t.prototype=Object.create(n,{init:{value:function(t){var n=this.input;if(this.effects=e.Utils.createEffectsRecursive(this.input,t.audioNodes),this.effects.length>0&&(n=this.effects[this.effects.length-1]),n.connect(this.output),"master"===this.outputBus)this.output.connect(e.context.destination);else{var a=e.getInstance(i,this.outputBus);this.output.connect(a?a.input:e.context.destination)}}},volume:{get:function(){return this.output.gain},set:function(t){this.output.gain.value=e.Utils.dbToWAVolume(t)}},getAutomatableProperties:{value:function(e){return"fx"==e.substring(0,2)?this.effects[parseInt(e.substring(2),10)]:void 0}},setAutomatableProperty:{value:function(t,i,n,a){var o=n>0?"linearRampToValueAtTime":"setValueAtAtTime";switch(t){case"volume":i=parseFloat(i),t="gain";break;case"pan":break;default:return}this.output[t].cancelScheduledValues(e.context.currentTime),this.output[t].setValueAtTime(this.output[t].value,e.context.currentTime),this.output[t][o](i,(a+n)/1e3)}},onAction:{value:function(){}}}),e.registerInstance(i,"audioBus",t)}),dmaf.once("load_modules",function(e){function t(){}function i(){}var n=e.InstancePrototype;t.prototype=Object.create(n),e.registerInstance("customCode","customCode",t),e.customCode.customCode.createInstance=function(t){if(e.customCode[t.instanceId]){var i=e.customCode[t.instanceId].createInstance(t);return i}dmaf.log&&console.log(t.instanceId,"was not registered with DMAF")},i.prototype=Object.create(n,{onAction:{value:function(){var t=e.pendingObjects[this.instanceId];t&&(this.obj=t)}}}),e.registerInstance("customCode","userObject",i)}),dmaf.once("load_modules",function(e){function t(){}function i(){}var n="eventProcessor",a=e.InstancePrototype;t.prototype=Object.create(a,{onAction:{value:function(t,i,n){for(var a,o=0,s=this.eventMaps.length;s>o;o++)if(-1!==this.eventMaps[o]["in"].indexOf(t)){if(t===this.eventMaps[o].out){dmaf.log&&console.log("DMAF.EventMapper: ",t," is the same in event as output. Ignoring...");continue}a=this.eventMaps[o].delay||0,e.Clock.checkFunctionTime(i+a+e.preListen,e.ActionManager.onEvent,[],e.ActionManager,this.eventMaps[o].out,i+a+e.preListen,n)}else"multi"===this.eventMaps[o]["in"][0]&&(a=this.eventMaps[o].delay||0,e.Clock.checkFunctionTime(i+a+e.preListen,e.ActionManager.onEvent,[],e.ActionManager,this.eventMaps[o].out,i+a+e.preListen,n))}}}),e.registerInstance(n,"eventMapper",t),i.prototype=Object.create(a,{init:{value:function(){for(var e=0,t=this.eventMaps.length;t>e;e++)this.eventMaps[e]["in"]=parseInt(this.eventMaps[e]["in"],10),isNaN(this.eventMaps[e]["in"])&&dmaf.log&&console.log("In value for MidiNoteMapper is NaN!")}},onAction:{value:function(t,i,n){if(n&&n.midiNote)for(var a=0,o=this.eventMaps.length;o>a;a++)this.eventMaps[a]["in"]===n.midiNote&&e.ActionManager.onEvent(this.eventMaps[a].out,i,n)}}}),e.registerInstance(n,"midiNoteMapper",i)}),dmaf.once("load_modules",function(e){function t(){}function i(){}var n="mediaElement",a=e.InstancePrototype;t.prototype=Object.create(a,{currentTime:{get:function(){return this.element?this.element.currentTime:void 0},set:function(){dmaf.log&&console.log("MediaElement currentTime is read-only")}},onAction:{value:function(){if(this.element)return null;var t=this.instanceId,i=e.pendingObjects[t];i?i instanceof HTMLElement&&("VIDEO"===i.tagName||"AUDIO"===i.tagName?(this.element=i,this.playing=!1,this.lastPlayTime=i.currentTime,e.Clock.addFrameListener(this.type+":"+this.instanceId,this.poll,this)):dmaf.log&&console.log("DMAF does not support registering HTML elements other than <video> and <audio>")):dmaf.log&&console.log("DMAF Could not locate mediaElement with id",this.instanceId)}},poll:{value:function(){this.lastPlayTime===this.element.currentTime?this.playing&&(e.ActionManager.onEvent(this.instanceId+".STOP",1e3*e.context.currentTime),this.playing=!1):this.lastPlayTime-this.element.currentTime>.25?e.ActionManager.onEvent(this.instanceId+".START",1e3*(e.context.currentTime-this.currentTime)):this.element.currentTime-this.lastPlayTime>.25?e.ActionManager.onEvent(this.instanceId+".START",1e3*(e.context.currentTime-this.currentTime)):this.playing||(e.ActionManager.onEvent(this.instanceId+".START",1e3*(e.context.currentTime-this.currentTime)),this.playing=!0),this.lastPlayTime=this.element.currentTime}}}),e.registerInstance(n,"mediaElement",t),e.mediaElement.mediaElement.removeInstance=function(t){var i=e.getInstance("mediaElement:"+t);return i&&e.Clock.removeFrameListener(n+":"+t),delete this.activeInstances[t]},i.prototype=Object.create(a,{onAction:{value:function(e,t){var i,n=/CREATE|REMOVE/.exec(e);n.length&&(n=n[0].toLowerCase(),i=e.split(".")[0],this[n](t,i))}},create:{value:function(t,i){var a=e.mediaElement.mediaElement.createInstance({instanceId:i,type:n,id:"mediaElement"});e.Clock.checkFunctionTime(t,a.onAction,[],a)}},remove:{value:function(t,i){return e.mediaElement.mediaElement.removeInstance(i)}}}),e.registerInstance("control","mediaController",i,!0)}),dmaf.once("load_modules",function(e){function t(){}function i(){}var n="midiProcessor",a={OFF:[0,0,0,0,0,0,0,0,0,0,0,0],major:[0,-1,0,-1,0,0,-1,0,-1,0,-1,0],harmonicMinor:[0,1,0,0,-1,0,1,0,0,-1,1,0],naturalMinor:[0,-1,0,0,-1,0,-1,0,0,-1,0,-1],majorPentatonic:[0,1,0,1,0,-1,1,0,1,0,-1,1],minorPentatonic:[0,-1,1,0,-1,0,1,0,-1,1,0,-1],dorian:[0,1,0,0,-1,0,1,0,1,0,0,-1],phrygian:[0,0,-1,0,-1,0,1,0,0,-1,0,-1],lydian:[0,1,0,1,0,1,0,0,1,0,1,0],mixolydian:[0,1,0,1,0,0,-1,0,-1,0,-1],locrian:[0,0,-1,0,-1,0,0,-1,0,-1,0,-1],doubleHarmonic:[0,0,-1,1,0,0,1,0,0,-1,1,0],halfDim:[0,1,0,0,-1,0,0,-1,0,-1,0,-1],pentatonic:[0,-1,-2,0,-1,0,-1,0,-1,-2,0,-1]},o={C:0,"C#":1,D:2,"D#":3,E:4,F:5,"F#":6,G:7,"G#":8,A:9,"A#":10,B:11};t.prototype=Object.create(e.InstancePrototype,{updateValues:{value:["transpose","scale","root"]},scale:{get:function(){return this._scale},set:function(e){this._scale=a[e]}},root:{get:function(){return this._root},set:function(e){this._root=o[e]}},onAction:{value:function(e,t,i){return i&&i.midiNote?(this.transpose&&(this.transpose=parseInt(this.transpose,10),i.midiNote+=this.transpose),this.scale&&this.quantizeToScale(i),void 0):(dmaf.log&&console.log("no eventProperties"),void 0)}},quantizeToScale:{value:function(e){var t;return e.midiNote&&(t=e.midiNote%12,t-=this._root,0>t&&(t=12+t),e.midiNote+=this.scale[t]),e}}}),e.registerInstance(n,"midiProcessor",t),i.prototype=Object.create(e.InstancePrototype,{init:{value:function(){for(var t=0,i=this.noteMaps.length;i>t;t++)this.noteMaps[t].midiNote=e.Utils.toMIDINote(this.noteMaps[t].note)}},onAction:{value:function(t,i){for(var n,a=0,o=this.noteMaps.length;o>a;a++)t===this.noteMaps[a].triggerIn&&(n={type:"noteOn",midiNote:this.noteMaps[a].midiNote,velocity:this.noteMaps[a].velocity,duraiton:this.noteMaps[a].duration},e.ActionManager.onEvent(this.noteMaps[a].triggerOut,i,n))}}}),e.registerInstance(n,"makeNote",i)}),dmaf.once("load_modules",function(e){function t(){this.timeoutContainer=[]}function i(){}var n="parameterProcessor",a=e.InstancePrototype;t.prototype=Object.create(a,{onAction:{value:function(t,i){this.targets.length&&("multi"===this.targets[0]&&(this.targets=[t.replace(this.multiSuffix,"")]),e.Clock.checkFunctionTime(this.actionTime,this.execute,this.timeoutContainer,this,i))}},execute:{value:function(t){for(var i;this.targets.length;)i=e.getInstance(this.targetType,this.targets.shift()),i&&(dmaf.log&&console.log("Transforming",this.targetParameter,"of",i.instanceId),i.setProperty(this.targetParameter,this.value,this.duration,t))}}}),e.registerInstance(n,"transform",t,!0),i.prototype=Object.create(a,{onAction:{value:function(t,i){for(var n,a,o,s=0,r=this.targets.length;r>s;s++)n=this.targets[s],o=e.getInstance(n.targetType,n.targetId),o&&(a=n.min+(n.max-n.min)*this.value,o.setProperty(n.targetParameter,a,this.duration,i))}}}),e.registerInstance(n,"macro",i)}),dmaf.once("load_modules",function(e){function t(){this.state=this.STOPPED,this.pendingPatterns=[],this.activePatterns=[],this.pendingEvents=[],this.tempo=120,this.songPosition=new e.Processor.BeatPosition(0,16,16),this.currentPattern=new e.Processor.BeatPatternInstance(this,{beatPattern:new e.Processor.BeatPattern("master",1),channel:"master",addAtSongPosition:new e.Processor.BeatPosition(1,1,16),patternStartPosition:1,clearPending:!0,replaceActive:!0,setAsCurrent:!0,loop:!0,loopLength:16,clearPosition:new e.Processor.BeatPosition(1,1,16)})}function i(){var t,n,a=(new Date).getTime(),o=1e3*e.context.currentTime;return s&&(i.lastDifference=t,s=!1),t=a-o,n=t-i.lastDifference,Math.abs(n)>5?(dmaf.log&&console.log("DMAF: Adjusting next beat Time. Difference was "+n+"ms"),i.lastDifference=t,n):0}function n(){this.activePatterns=[]}var a="player",o=e.InstancePrototype,s=!0;t.prototype=Object.create(o,{STOPPED:{value:0},RUNNING:{value:1},tempo:{get:function(){return this._tempo},set:function(t){this._tempo=t,this.beatLength=250*(60/t),e.dispatch("tempo_"+this.instanceId,this._tempo)}},onAction:{value:function(t,i,n,a){if(a.flowItems)for(var o,s,r=a.flowItems,l=0,c=r.length;c>l;l++){if(o=Object.create(r[l]),"trigger"===o.patternId&&(o.patternId=t),o._dynamicValues)for(var d=0,u=o._dynamicValues.length;u>d;d++)s=o._dynamicValues[d],o[s.key]=e.getInstanceProperty(s.string);switch(o.id){case"start":if(this.state===this.RUNNING)break;if(o.delay){var p=o.delay?i+o.delay:i;e.Clock.checkFunctionTime(p,this.start,[],this,o,p)}else this.start(o,i);break;case"add":e.Clock.checkFunctionTime(i,this.addPattern,[],this,o);break;case"stop":if(this.state===this.STOPPED)break;e.Clock.checkFunctionTime(i,this.stop,[],this,o);break;case"beatEvent":e.Clock.checkFunctionTime(i,this.beatEvent,[],this,o)}}}},addPattern:{value:function(t){if(this.state===this.RUNNING){t.beatPattern=e.getAsset("beatPattern",t.patternId),t.addAtSongPosition=this.getSongPosition(t.songPosition),t.startPatternAtBeat=this.getStartAtBeat(t.patternPosition),t.clearPosition=this.getSongPosition(t.clearPosition);var i=new e.Processor.BeatPatternInstance(this,t);if(t.clearPending)if("main"===t.channel)this.pendingPatterns.length=0;else for(var n=this.pendingPatterns.length;n--;)this.pendingPatterns[n].channel===t.channel&&this.pendingPatterns.splice(n,1);i.ERROR||this.pendingPatterns.push(i)}else dmaf.log&&console.log("BeatPatternPlayer: Cannot add pattern while player is not running.",t.patternId)}},checkBeat:{value:function(){for(var t=1e3*e.context.currentTime;t-this.nextBeatTime-e.preListen>this.beatLength;)this.skipBeat(this.nextBeatTime);for(;t>=this.nextBeatTime-e.preListen;)this.updateBeat(this.nextBeatTime)}},skipBeat:{value:function(e){this.songPosition.gotoNextBeat(),this.nextBeatTime=e+this.beatLength;for(var t=0,i=this.activePatterns.length;i>t;t++)this.activePatterns[t].gotoNextBeat();this.updateActivePatterns()}},updateBeat:{value:function(e){this.nextBeatTime=e+this.beatLength-i(),this.songPosition.gotoNextBeat();for(var t=0,n=this.activePatterns.length;n>t;t++)this.activePatterns[t].gotoNextBeat();for(this.songPosition.beat,this.updateActivePatterns(),t=0,n=this.activePatterns.length;n>t;t++)this.activePatterns[t].executeEvents(e,this.beatLength)}},updateActivePatterns:{value:function(){for(var e,t,i,n,a,o=0;this.pendingPatterns.length>o;o++)if(i=this.pendingPatterns[o].addAtSongPosition,i.bar===this.songPosition.bar&&i.beat===this.songPosition.beat){if(e=this.pendingPatterns[o],this.pendingPatterns.splice(o--,1),e.replaceActive)for(n=0,a=this.activePatterns.length;a>n;n++)("main"===e.channel||e.channel===this.activePatterns[n].channel)&&(this.activePatterns[n].removeAtSongPosition=e.clearPosition);e.setAsCurrent&&(this.currentPattern=e),this.activePatterns.push(e)}for(o=0;this.activePatterns.length>o;o++)t=this.activePatterns[o].removeAtSongPosition,t.bar===this.songPosition.bar&&t.beat===this.songPosition.beat?this.activePatterns.splice(o--,1):t.bar<this.songPosition.bar&&this.activePatterns.splice(o--,1)}},start:{value:function(t,i){this.tempo=t.tempo||120,this.nextBeatTime=i,this.beatsPerBar=t.beatsPerBar,this.state=this.RUNNING,e.Clock.addFrameListener("checkBeat",this.checkBeat,this)}},stop:{value:function(t){var i=this.getSongPosition(t.songPosition).getInBeats(),n=this.songPosition.getInBeats(),a=(i-n)*this.beatLength;a+=1e3*e.context.currentTime,a=Math.max(1e3*e.context.currentTime,a),e.Clock.checkFunctionTime(a,this.proceedStop,[],this,t)}},proceedStop:{value:function(){this.state=this.STOPPED,this.pendingPatterns.length=0,this.activePatterns.length=0,e.Clock.removeFrameListener("checkBeat"),this.songPosition=new e.Processor.BeatPosition(0,this.beatsPerBar,this.beatsPerBar),this.currentPattern=new e.Processor.BeatPatternInstance(this,{beatPattern:new e.Processor.BeatPattern("MASTER",1),channel:"MASTER",addAtSongPosition:new e.Processor.BeatPosition(1,1,16),patternStartPosition:1,clearPending:!0,replaceActive:!0,setAsCurrent:!0,loop:!0,loopLength:16,clearPosition:new e.Processor.BeatPosition(1,1,16)})}},beatEvent:{value:function(t){var i=this.getSongPosition(t.songPosition).getInBeats(),n=this.songPosition.getInBeats(),a=(i-n)*this.beatLength;switch(a+=1e3*e.context.currentTime,t.output){case"onEvent":e.Clock.checkFunctionTime(a,e.ActionManager.onEvent,this.pendingEvents,e.ActionManager,t.returnEvent);break;case"dispatch":e.Clock.checkFunctionTime(a,e.dispatch,this.pendingEvents,e,t.returnEvent)}}},getSongPosition:{value:function(t){var i,n=t,a=0,o=0,s=new e.Processor.BeatPosition(this.songPosition.bar,this.songPosition.beat,this.beatsPerBar);switch(/\+/.test(n)&&(i=n.split("+"),n=i[0],i=i[1].split("."),o=parseInt(i[0],10)||0,a=parseInt(i[1],10)||0),n){case"NEXT_BEAT":s.addOffset({bar:0,beat:1});break;case"NEXT_BAR":s.beat=1,s.bar++;break;case"ASAP":return s;default:dmaf.log&&console.log("BeatPatternPlayer getSongPosition: Unrecognized songPosition ",n)}return s.bar+=o,s.beat+=a,s}},getStartAtBeat:{value:function(e){var t,i=e,n=0,a=0,o=this.currentPattern&&this.currentPattern.currentBeat||1;if(!i)return 1;switch(/\+/.test(i)&&(t=i.split("+"),i=t[0],t=t[1].split("."),a=parseInt(t[0],10)||0,n=parseInt(t[1],10)||0),i){case"FIRST_BEAT":o=1;break;case"SYNC":o++;break;default:dmaf.log&&console.log("BeatPatternPlayer: Unrecognized patternPosition "+i)}return o+=a*(this.currentPattern&&this.currentPattern.beatsPerBar||16),o+=n}}}),e.registerInstance(a,"beatPatternPlayer",t),n.prototype=Object.create(o,{init:{value:function(){e.Clock.addFrameListener(this.instanceId,this.checkPatterns,this)}},onAction:{value:function(e,t){var i=e.split("."),n=i[1].toLowerCase(),a=i[0];this[n]&&this[n](a,t)}},start:{value:function(t,i){var n=e.getAsset("timePattern",t);n?(-1===this.activePatterns.indexOf(n)&&this.activePatterns.push(n),n.startTime=i):dmaf.log&&console.log("No time pattern with id ",t,"exists.")}},stop:{value:function(t){var i,n=e.getAsset("timePattern",t);n?("DEFAULT"===this.behavior&&(n.startTime=-1),i=this.activePatterns.indexOf(n),-1!==i&&this.activePatterns.splice(i,1)):dmaf.log&&console.log("No time pattern with id ",t,"exists.")}},checkPatterns:{value:function(){for(var e=0,t=this.activePatterns.length;t>e;e++)this.activePatterns[e].executeEvents(this.behavior)}}}),e.registerInstance(a,"timePatternPlayer",n)}),dmaf.once("load_modules",function(e){function t(){this.output=e.context.createGainNode()}function i(t){this.iterator=new e.Iterator(t.soundFiles,t.generator),this.output=e.context.createGainNode()}function n(){}function a(t,i){e.context.currentTime>i&&(i=e.context.currentTime+this.delay);var n=t.replace(this.multiSuffix,""),a=e.getInstance("sound",n);a&&a.stop(i)}function o(t,i){var n;1e3*e.context.currentTime>i&&(i=1e3*e.context.currentTime+this.delay);for(var a=0,o=this.targets.length;o>a;a++)n=e.getInstance("sound",this.targets[a]),n&&n.stop(i)}var s="sound",r=0,l=e.Clock,c=Object.create(e.InstancePrototype,{init:{value:function(t){if(this.pendingPlays=[],this.pendingStops=[],this.pendingEvents=[],this.pendingSoftLoop=[],this.sounds=[],this.playing=!1,this.previousActionTime=0,t.bus&&"master"!==t.bus){var i=e.getInstance("audioRouter",t.bus);this.targetBus=i?i.input:e.context.destination}else this.targetBus=e.context.destination;this.output.connect(this.targetBus)}},checkFinished:{value:function(){this.sounds=this.sounds.filter(function(e){return 3!==e.playbackState})}},clearAll:{value:function(){for(var e=this.sounds,t=e.length;t--;)this.sounds[t].noteOff(0);this.sounds.length=0,this.playing=!1}},createSound:{value:function(){var t=e.context.createBufferSource(),i=e.getAsset("buffer",this.getSoundFile());return i?(t.id=r++,t.buffer=i,t.connect(this.output),-2===this.loop&&(t.loop=!0),t):(dmaf.log&&console.log("GenericPlay: Buffer is missing. Check soundFile property."),{buffer:{duration:-1},noteOn:function(){},noteGrainOn:function(){}})}},dispose:{value:function(e){for(var t=this.sounds.length;t--;)this.sounds[t].id===e&&this.sounds.splice(t,1);this.playing=!!this.sounds.length}},play:{value:function(e){this.checkFinished(),l.dropPendingArray(this.pendingStops),this.playing?(this.reTrig>-1&&(l.dropPendingArray(this.pendingPlays),l.dropPendingArray(this.pendingEvents)),0===this.reTrig||"RESYNC"===this.timingCorrection?(dmaf.log&&console.log("scheduling",this.instanceId,"for",e),l.checkFunctionTime(e,this.proceedPlay,this.pendingPlays,this,e)):this.reTrig>0&&e-this.previousActionTime>this.reTrig&&(this.previousActionTime=e,dmaf.log&&console.log("scheduling",this.instanceId,"for",e),l.checkFunctionTime(e,this.proceedPlay,this.pendingPlays,this,e))):(this.previousActionTime=e,dmaf.log&&console.log("scheduling",this.instanceId,"for",e),l.checkFunctionTime(e,this.proceedPlay,this.pendingPlays,this,e))}},proceedPlay:{value:function(t){dmaf.log&&console.log("playing",this.instanceId,"at",~~(1e3*e.context.currentTime));var i=this.createSound(),n=Math.abs(t-1e3*e.context.currentTime),a=1e3*i.buffer.duration,o=a-n,s=t+(this.loop||a);switch(this.timingCorrection){case"PLAY":i.noteOn(t/1e3);break;case"SYNC":if(0>=o)return;i.noteGrainOn(Math.max(0,t/1e3),n/1e3,o/1e3);break;case"RESYNC":if(0>=o)return;this.clearAll(),i.noteGrainOn(Math.max(0,t/1e3),n/1e3,o/1e3)}l.dropPendingArray(this.pendingEvents),this.returnEvent&&l.checkFunctionTime(t+a+this.returnEventTime,e.ActionManager.onEvent,this.pendingEvents,e.ActionManager,this.returnEvent,t+a+this.returnEventTime),this.loop>-1&&(l.checkFunctionTime(s,this.proceedPlay,this.pendingSoftLoop,this,s),l.checkFunctionTime(s,this.dispose,[],this,i.id),i.noteOff(t/1e3+i.buffer.duration)),-2===this.loop||l.checkFunctionTime(t+a,this.dispose,[],this,i.id),this.playing=!0,this.sounds.push(i)}},stop:{value:function(t){dmaf.log&&console.log("scheduling stop",this.instanceId,"at",~~(1e3*e.context.currentTime)),l.dropPendingArray(this.pendingPlays),l.dropPendingArray(this.pendingStops),l.checkFunctionTime(t,this.proceedStop,this.pendingStops,this)}},proceedStop:{value:function(){dmaf.log&&console.log("Stopping",this.instanceId,"at",~~(1e3*e.context.currentTime)),this.sounds.length,l.dropPendingArray(this.pendingEvents),l.dropPendingArray(this.pendingSoftLoop),this.clearAll(),e.sound[this.id].removeInstance(this.instanceId)}},verify:{value:e.Utils.verify},volume:{get:function(){return this.output.gain},set:function(t){this._volume=t,this.waVolume=e.Utils.dbToWAVolume(this._volume),this.output.gain.value=this.waVolume}},onAction:{value:function(e,t){"multi"===this.soundFile&&(this.soundFile=e),this.play(t)}}});t.prototype=Object.create(c,{getSoundFile:{value:function(){return this.soundFile}}}),e.registerInstance(s,"genericPlay",t),i.prototype=Object.create(c,{getSoundFile:{value:function(){return this.iterator.getNext()}}}),e.registerInstance(s,"stepPlay",i),n.prototype=Object.create(e.InstancePrototype,{init:{value:function(){this.onAction="multi"===this.targets[0]?a:o}}}),e.registerInstance(s,"soundStop",n,!0)}),dmaf.once("load_modules",function(e){function t(){this.value=void 0,this.previous=void 0}var i="stateProcessor",n="in",a=/PREVIOUS/;t.prototype=Object.create(e.InstancePrototype,{onAction:{value:function(t){var i,o,s,r,l;for(o=0,s=this.stateMaps.length;s>o;o++)for(r=0,l=this.stateMaps[o][n].length;l>r;r++)this.stateMaps[o][n][r]===t&&(i=this.stateMaps[o].state,this.stateMaps[o]._dynamicValues&&(i=e.getInstanceProperty(this.stateMaps[o]._dynamicValues[0].string)),o=s,r=l);if(!i)return dmaf.log&&console.log("StateProcesor: No state found for",t),!1;switch(a.test(i)&&(i=this.previous),this.update){case"always":this.previous=this.value,this.value=i;break;case"onChange":i!==this.value&&(this.previous=this.value,this.value=i)}}}}),e.registerInstance(i,"state",t)}),dmaf.once("load_modules",function(e){function t(t){this.input=e.context.createGainNode(),this.output=e.context.createGainNode(),this.Note=o.call(this,t)}function i(t,i,n){if(t)this.input.connect(this.output),this.output.connect(t);else{var a=this.input;if(this.effects=e.Utils.createEffectsRecursive(a,i),this.effects.length>0&&(a=this.effects[this.effects.length-1]),a.connect(this.output),n&&"master"!==n){var o=e.getInstance("audioRouter",n);o?this.output.connect(o.input):this.output.connect(e.context.destination)}else this.output.connect(e.context.master)}}function n(){for(var t,i,n=e.context.currentTime,a=this.samples.active,o=this.samples.sustained,s=Object.keys(a),r=s.length;r--;)for(i=s[r],t=a[i].length;t--;)n>a[i][t].disposeTime&&a[i].splice(t,1);for(r=o.length;r--;)n>o[r].disposeTime&&o.splice(r,1)}function a(t,i,n){var a=this._loop&&this._sustain,o=this._loop?1/0:1e3*t.bufferLength-t.ampRelease,s=this.ignoreNoteOff?o:n?n:o,r=i+(a?1/0:s);isFinite(r)&&t._noteOff(r),this.sustained||!n?(this.samples.sustained.push(t),this.samples.sustained.length>this.numberOfVoices&&this.samples.sustained[0]._noteOff(1e3*e.context.currentTime)):this.samples.active[t.midiNote].push(t)}function o(){function t(t){this.bufferSource=e.context.createBufferSource(),this.amp=e.context.createGainNode(),this.filter=this.filterOn&&e.context.createBiquadFilter(),this.bufferSource.connect(this.filter||this.amp),this.filter&&this.filter.connect(this.amp),this.amp.connect(this.output),this.parent=t.parent,this.midiNote=t.midiNote,this.bufferSource.gain.value=void 0!==t.sampleGain?c(parseInt(t.sampleGain,10)):1,this.bufferSource.playbackRate.value=r(this.midiNote)/r(l(t.baseNote)),this.bufferSource.buffer=e.getAsset("buffer",t.buffer),this.bufferLength=this.bufferSource.buffer.length/e.context.sampleRate,this.velocity=Math.pow(t.velocity/127,1.2),this.bufferSource.loop=this.parent.loop,this.filterOn&&(this.filter.Q.value=this.filterQ,this.filter.gain=this.filterGain)}return t.prototype=Object.create(this),t.prototype.output=this.input,t.prototype._noteOn=u.noteOn,t.prototype._noteOff=u.noteOff,t}var s="synth",r=e.Utils.MIDIToFrequency,l=e.Utils.toMIDINote,c=e.Utils.dbToWAVolume,d=e.InstancePrototype;t.prototype=Object.create(d,{init:{value:function(t){i.apply(this,[t.output,t.audioNodes,t.bus]),this._sustain=!1,this.samples={meta:Object.create(null),maps:Object.create(null),used:Object.create(null),active:Object.create(null),sustained:[]};for(var a,o=0,s=t.sampleMapGroups[0].sampleMaps.length;s>o;o++)a=t.sampleMapGroups[0].sampleMaps[o].name.toLowerCase(),a="multi"===a?this.instanceId.toLowerCase():a.toLowerCase(),this.samples.meta[a]=t.sampleMapGroups[0].sampleMaps[o];for(var r in this.samples.meta)this.samples.maps[r]=e.getAsset("sampleMap",r),this.samples.used[r]=Object.create(null);e.Clock.addFrameListener(this.instanceId,n,this)}},numberOfVoices:{value:16},volume:{get:function(){return this.output.gain.value},set:function(t){this.output.gain.value=e.Utils.dbToWAVolume(t)}},sustain:{get:function(){return this._sustain},set:function(t){if(t)this._sustain=!0;else{this._sustain=!1;for(var i=0,n=this.samples.sustained.length;n>i;i++)this.samples.sustained[i]._noteOff(1e3*e.context.currentTime)}}},filterSustain:{get:function(){return this._filterSustain},set:function(e){this._filterSustain=Math.pow(e,4)}},controller:{value:function(){64===message.cc&&(this.sustain=this.verify("sustain",message.value))}},onAction:{value:function(e,t,i){i&&(this[i.type]?this[i.type](t,i):dmaf.log&&console.log("Sampler does not recognize message ",i))}},getRange:{value:function(e,t){var i,n,a,o,s=this.samples.meta,r=this.samples.maps,c=this.samples.used,d=0,u=[];for(n in s)if(t>=s[n].velocityLow&&s[n].velocityHigh>=t){i=r[n];for(a in i)o=i[a],e>=l(o.low)&&l(o.hi)>=e&&u.push(o)}return 1!==u.length&&(void 0!==c[n][e]&&(d=(c[n][e]+1)%u.length),c[n][e]=d),u[d]}},noteOn:{value:function(t,i){var n,o=this.samples.active,s=i.midiNote,r=i.velocity,l=i.duration||i.endTime,c=this.getRange(s,r);c&&c.sound&&e.getAsset("buffer",c.sound)&&(n=new this.Note({parent:this,sampleGain:c.vol,baseNote:c.root,buffer:c.sound,midiNote:s,velocity:r}),o[s]?o[s].length&&!this.ignoreNoteOff&&this.noteOff(t,i):o[s]=[],this.loop&&this.ignoreNoteOff&&(dmaf.log&&console.log("Sampler Configuration Error: You cannot use looped samples with ignoreNoteOff."),i.duration?this.ignoreNoteOff=!1:this.loop=!1),n._noteOn(t),a.apply(this,[n,t,l]))}},noteOff:{value:function(t,i){var n,a,o=this.samples.active,s=this.samples.sustained,r=i.midiNote;if(r&&!this.ignoreNoteOff){if(o[r])for(n=0,a=o[r].length;a>n;n++)o[r][n]._noteOff(t||1e3*e.context.currentTime);if(!this.sustain)for(n=0,a=s.length;a>n;n++)s[n].midiNote===r&&s[n]._noteOff(t||1e3*e.context.currentTime)}}},stopAll:{value:function(){var t,i=this.samples.active,n=this.samples.sustained;for(var a in i){for(t=i[a].length;t--;)i[a][t]._noteOff(1e3*e.context.currentTime);for(t=n.length;t--;)n[t]._noteOff(1e3*e.context.currentTime)}}}});var u={noteOn:function(e){var t=e+this.ampAttack,i=t+this.ampDecay,n=1-this.ampVelocityRatio+this.velocity*this.ampVelocityRatio,a=Math.pow(this.ampSustain*n,2);if(this.noteOnTime=e,this.ampPeakValue=n,this.ampSustainValue=a,this.amp.gain.setValueAtTime(0,e/1e3),this.amp.gain.linearRampToValueAtTime(n,t/1e3),this.amp.gain.linearRampToValueAtTime(a,i/1e3),this.filterOn){var o=e+this.filterAttack,s=o+this.filterDecay,l=1-this.filterVelocityRatio+this.velocity*this.filterVelocityRatio,c=this.filterADSRAmount*l,d=this.filterFrequency+c,u=this.filterFrequency+this.filterSustain*c;d=r(12*d+this.midiNote),u=r(12*u+this.midiNote),d=20>d?20:d>2e4?2e4:d,u=20>u?20:u>2e4?2e4:u,this.filterFrequency=r(12*this.filterFrequency+this.midiNote),this.filter.frequency.setValueAtTime(this.filterFrequency,e/1e3),this.filter.frequency.linearRampToValueAtTime(d,o/1e3),this.filter.frequency.linearRampToValueAtTime(u,s/1e3)}this.bufferSource.noteOn(this.noteOnTime/1e3)},noteOff:function(e){var t,i;t=e+this.ampRelease,i=e+this.filterRelease,this.amp.gain.cancelScheduledValues(e/1e3),this.amp.gain.setValueAtTime(this.ampSustainValue,e/1e3),this.amp.gain.linearRampToValueAtTime(0,t/1e3),this.filter&&(this.filter.frequency.cancelScheduledValues(e/1e3),this.filter.frequency.setValueAtTime(this.filter.frequency.value,e/1e3),this.filter.frequency.linearRampToValueAtTime(this.filterFrequency,i/1e3)),this.bufferSource.noteOff(t/1e3),this.disposeTime=t/1e3,this.noteOffSent=!0}};e.registerInstance(s,"sampler",t)}),dmaf.once("load_core",function(e){function t(i){100===i&&(console.log("dmaf is finished all preloads."),dmaf.removeEventListener("progress_event",t),e.ActionManager.onEvent("init_routing"),e.ActionManager.onEvent("dmaf_ready"),dmaf.active=!0,dmaf.log&&console.log("dispatching dmaf_ready"),e.dispatch("dmaf_ready"),console.log("dmaf is now active!"))}function i(t){if(!e[t.type]||!e[t.type][t.id])return dmaf.log&&console.log("DMAF Could not find module of type",t.type,"with id",t.id,"check the config.xml to make sure you've included this module."),void 0;for(var i,a=new n(t),o=0,s=a.triggers.length;s>o;o++)i=a.triggers[o],e.ActionManager.triggers[i]=e.ActionManager.triggers[i]||[],e.ActionManager.triggers[i].push(a)}function n(e){this.actionProperties=e.actionProperties,this.triggers=e.triggers,this.delay=e.delay||0,this.type=e.type,this.id=e.id,this.multi="multi"===this.actionProperties.instanceId}var a,o=!1;e.ActionManager={triggers:{},populate:function(){dmaf.active=!1;for(var n=0,o=e.Settings.actions.length;o>n;n++)i(e.Settings.actions[n]);console.log("dmaf successfully loaded",o,"actions."),a=e.ActionManager.triggers.preload_assets,a&&a.length?(console.log("dmaf is now preloading",a.length,"assets"),dmaf.addEventListener("progress_event",t),this.onEvent("preload_assets")):t(100)},stop:function(){o=!0},onEvent:function(t,i,n){var a,s=this.triggers[t],r=i||1e3*e.context.currentTime;if(o=!1,s&&s.length)for(var l=0,c=s.length;c>l&&(a=s[l].delay?s[l].delay:0,s[l].actionProperties.delay&&(a+=s[l].actionProperties.delay),s[l].execute(t,r+a,n),!o);l++);}},n.prototype={execute:function(t,i,n){var a,o,s;
if(o=this.multi?t:this.actionProperties.instanceId,a=e.getInstance(this.type,o||"no_instance_id"))a._dynamicValues&&a.setDynamicValues();else{if(s=e.Utils.clone(this.actionProperties),s.instanceId=o,s.type=this.type,s.id=this.id,!(e[this.type]&&e[this.type][this.id]&&e[this.type][this.id].createInstance))return console.log("malformed action!"),console.log(this),void 0;a=e[this.type][this.id].createInstance(s)}a?a.onAction(t,i,n,this.actionProperties):console.log(this)}}}),dmaf.once("load_core",function(e){function t(){if(!r.length)return l=!1,void 0;for(n=1e3*c.currentTime,a=0;r.length>a;a++)r[a].callback.call(r[a].context);e.lastTime=e.currentTime,e.currentTime=e.context.currentTime,e.lastTime===e.currentTime&&console.error("Dirty context time!"),setTimeout(t,30)}function i(e){for(var t=r.length;t--;)if(r[t].id===e)return!0;return!1}var n,a,o=e.Clock=Object.create(null),s=Array.prototype.slice,r=[],l=!1,c=e.context;e.preListen=70,e.lastTime=0,e.currentTime=-1,o.checkFunctionTime=function(t,i,n,a){var o,r,l,c=s.call(arguments,4);a=a||e,t>=1e3*e.context.currentTime+e.preListen?(o=function o(){i.apply(a,c),n.splice(n.indexOf(r),1)},l=t-Math.floor(1e3*e.context.currentTime)-e.preListen,r=setTimeout(o,l),n.push(r)):i.apply(a,c)},o.dropPendingArray=function(e){for(;e.length;)clearTimeout(e.pop())},o.addFrameListener=function(n,a,o){return i(n)?(dmaf.log&&console.log("That frame listener is already running!",n),void 0):(r.push({callback:a,context:o||e,id:n}),l||(l=!0,t()),void 0)},o.removeFrameListener=function(e){for(var t=r.length;t--;)if(r[t].id===e)return r.splice(t,1),!0;return!1}}),dmaf.once("load_core",function(e){function t(e,t){this.activeInstances=Object.create(null),this.constructor=e,this.isManaged=!t}function i(t){return function(i){var a,o;return n.test(i)?(a=i.split(n),a.length>2&&(o=a.slice(2),a.length=2,a.push(o))):a=arguments,a[0]?e[a[0]]?t.apply(e,a):(dmaf.log&&console.log("Invalid type!",a[0]),null):(dmaf.log&&console.log("Missing arguments!"),null)}}var n=/[:]/;e.registerInstance=function(i,n,a,o){e[i]=e[i]||Object.create(null),e[i].ids=e[i].ids||[],e[i].ids.push(n),a.prototype.defaults=e.Settings.descriptors.action[i][n]||{},e[i][n]=new t(a,o)},e.getInstance=function(t,i){var n,a,o,s=0;for(n=e[t].ids;a=n[s++];)if(o=this[t][a].getInstance(i))return o;return null},e.getInstance=i(e.getInstance),e.getInstanceProperty=function(t,i,n){var a=e.getInstance(t,i);if(!a)return dmaf.log&&console.log("missing instance",t,i),null;property=a;for(var o=0,s=n.length;s>o&&"undefined"!=typeof property&&("object"==typeof property||"function"==typeof property);o++)property=property[n[o]];return o!==s?(dmaf.log&&console.log("Could not find property."),null):property},e.getInstanceProperty=i(e.getInstanceProperty),e.addInstance=function(t){return this.InstancePrototype.isPrototypeOf(t)?(e[t.type][t.id]?e[t.type][t.id].addInstance(t):console.log("Error!",t),void 0):(dmaf.log&&console.log("DMAF.addInstance may only be used with DMAF instances"),void 0)},e.removeInstance=function(e,t){var i=this.getInstance(e,t);return i?this[i.type][i.id].removeInstance(t):(dmaf.log&&console.log("DMAF.remove: Could not find instance",e,t),!1)},e.removeInstance=i(e.removeInstance),e.InstancePrototype={audioParam:function(){var t=e.context.createGainNode().gain;return Object.getPrototypeOf(t.constructor.prototype)}(),setInitProperties:function(e){for(var t,i=Object.keys(e),n=0;t=i[n++];)this[t]=e[t];return this.setDynamicValues(),this},init:function(){return this},onAction:function(){return this},returnChildInstance:function(t){var i,a,o,s,r;if(n.test(t)&&(i=t.split(n),i.length&&i.length>1))for(r=this,o=0,s=i.length;s>o;o++){if(a=i[o],r=r[a],"object"!=typeof r)return{self:this,ref:t};if(e.InstancePrototype.isPrototypeOf(r))return i=i.slice(o+1).join(":"),r.returnChildInstance(i)}return{instance:this,ref:t}},setProperty:function(t,i,a,o){var s,r=this.returnChildInstance(t);return r.instance!==this?r.instance.setProperty(r.ref,i,a,o):n.test(t)?(dmaf.log&&console.log("DMAF Does not support colon syntax for properties within arrays."),void 0):void 0===this[t]?(dmaf.log&&console.log(t,"is not a valid property for instance type",this.id),void 0):(i=this.verify(t,i),"volume"===t&&(i=e.Utils.dbToWAVolume(i)),this.audioParam.isPrototypeOf(this[t])?(1e3*e.context.currentTime>o&&(o=1e3*e.context.currentTime),o=o&&o>1e3*e.context.currentTime?o/1e3:e.context.currentTime,a=a=a?a/1e3:0,s=a?"linearRampToValueAtTime":"setValueAtTime",this[t].cancelScheduledValues(o),this[t].setValueAtTime(this[t].value,o),this[t][s](i,a+o)):this[t]=i,void 0)},setDynamicValues:function(){var t,i,n,a=this._dynamicValues;if(a){for(var o=0,s=a.length;s>o;o++)i=a[o].string||"string_not_defined",t=a[o].key,n=e.getInstanceProperty(i),this[t]=this.verify(t,n);return this}},verify:function(e,t,i){var n,a;switch(n=i?i:this.defaults[e],a=!!n,a=void 0===t,n.type){case"int":a=parseFloat(t)!==parseInt(t,10),t=parseInt(t,10),a=isNaN(t),a=!isFinite(t),a="number"!=typeof t,n.min>t&&(t=n.min),t>n.max&&(t=n.max);break;case"float":isNaN(parseFloat(t))&&(a=!0),isFinite(t)||(a=!0),"number"!=typeof t&&(a=!0),t=parseFloat(t),n.min>t&&(t=n.min),t>n.max&&(t=n.max);break;case"string":a="string"!=typeof t;break;case"list":a=!(t instanceof Array);break;case"enum":a=-1===n.value.indexOf(t);break;case"array":dmaf.log&&console.log("Array type found in verify",e,t,i);break;case"boolean":a="boolean"!=typeof t}return a?(dmaf.log&&console.log("DMAF Verification error",e,t,this),n["default"]):t}},e.setValueAtTime=function(t,i,n,a){e.Clock.checkFunctionTime(a,function(){t[i]=n},[],e)},t.prototype={getInstance:function(e){return this.activeInstances[e]},removeInstance:function(e){return delete this.activeInstances[e]},addInstance:function(e){this.activeInstances[e.instanceId]=e},createInstance:function(t){var i=new this.constructor(t);return i.setInitProperties(t).init(t),this.isManaged&&e.addInstance(i),i}}}),dmaf.once("load_core",function(e){function t(t){if(!t)return dmaf.log&&console.log("Problem parsing XML",arguments),void 0;var i,n,a,o,s,r,l,c,d=t.querySelectorAll("samplemap");for(i=0,n=d.length;n>i;i++){for(s=d[i],l=s.getAttribute("name"),r=s.querySelectorAll("range"),c={},a=0,o=r.length;o>a;a++)c["range_"+a]={sound:r[a].getAttribute("sound"),root:r[a].getAttribute("root"),low:r[a].getAttribute("low"),hi:r[a].getAttribute("hi"),vol:parseFloat(r[a].getAttribute("vol"))};e.setAsset("sampleMap",l,c)}}function i(e,t,i){var n=new o(e);switch(t){case"beatPattern":r(n,i);break;case"timePattern":s(n,i);break;default:r(n,i)}}function n(e,t,i){this.absoluteTime=t+e.readVariableLengthInt();var n=e.read8BitInt();240==(240&n)?this.getMetaEvent(e,n):this.getChannelEvent(e,n,i)}function a(e){this.pointer=0,this.midiString=e}function o(e){a.call(this,e.split("").map(c).join("")),this.tracks=[],this.chunk={},this.lastEventType=0,this.getNextChunk("MThd").readHeader().getTracks()}function s(t,i){var n,a,o,s,r,c,d,u,p,m,h;for(c=0,d=t.trackCount;d>c;c++){for(s=t.tracks[c],n=s[0].text||i+c+"",trigger=s[1].text||i+c+"",o=[],u=0,p=s.length;p>u;u++)if("setTempo"===s[u].subtype){h=6e7/s[u].microsecondsPerBeat;break}for(u=0,p=s.length;p>u;u++)if("noteOn"===s[u].subtype){for(r=s[u],r.type=r.subtype,r.trigger=trigger,m=u;p>m&&!l(s[m],r);m++);r.absoluteTime=6e4*r.absoluteTime/(t.ticksPerBeat*h)+1,r.duration=6e4*r.duration/(t.ticksPerBeat*h),o.push(r)}a=new e.Processor.TimePattern(n,o),e.setAsset("timePattern",n,a)}}function r(t,i){var n,a,o,s,r,c,d,u,p,m,h,f;for(c=1,d=t.trackCount;d>c;c++){for(s=t.tracks[c],n=s[0].text||i+c+"",a=s[1].text||i+c+"",o=new e.Processor.BeatPattern(n,1),u=2,p=s.length;p>u;u++)if("noteOn"===s[u].subtype){for(r=s[u],r.type=r.subtype,m=Math.floor(r.absoluteTime/t.beatLengthInTicks),h=Math.floor(r.absoluteTime-m*t.beatLengthInTicks),f=u;p>f&&!l(s[f],r);f++);o.addEvent(a,m+1,h+1,r)}e.setAsset("beatPattern",n,o)}}function l(e,t){var i=("noteOn"===e.subtype||"noteOff"===e.subtype)&&e.subtype;return i&&e.midiNote===t.midiNote?"noteOn"===i&&!e.velocity||"noteOff"===i?(t.duration=e.absoluteTime-t.absoluteTime,t.duration):void 0:!1}function c(e){return String.fromCharCode(255&e.charCodeAt(0))}e.parse=function(t){var i=Array.prototype.slice.call(arguments,1);return d[t]?d[t].apply(e,i):(dmaf.log&&console.log("DMAF.parse: invalid type",t),null)};var d={midi:i,samplemap:t};n.prototype={getMetaEvent:function(e,t){var i,n;if(255==t){switch(this.type="meta",n=e.read8BitInt(),i=e.readVariableLengthInt(),n){case 0:if(this.subtype="sequenceNumber",2!=i)return;return this.number=e.read16BitInt(),void 0;case 1:return this.subtype="text",this.text=e.readTo(i),void 0;case 2:return this.subtype="copyrightNotice",this.text=e.readTo(i),void 0;case 3:return this.subtype="trackName",this.text=e.readTo(i),void 0;case 4:return this.subtype="instrumentName",this.text=e.readTo(i),void 0;case 5:return this.subtype="lyrics",this.text=e.readTo(i),void 0;case 6:return this.subtype="marker",this.text=e.readTo(i),void 0;case 7:return this.subtype="cuePoint",this.text=e.readTo(i),void 0;case 32:if(this.subtype="midiChannelPrefix",1!==i)return;return this.channel=e.read8BitInt(),void 0;case 47:return this.subtype="endOfTrack",void 0;case 81:if(this.subtype="setTempo",3!=i)return;return this.microsecondsPerBeat=(e.read8BitInt()<<16)+(e.read8BitInt()<<8)+e.read8BitInt(),void 0;case 84:if(this.subtype="smpteOffset",5!=i)return;var a=e.read8BitInt();return this.frameRate={0:24,32:25,64:29,96:30}[96&a],this.hour=31&a,this.min=e.read8BitInt(),this.sec=e.read8BitInt(),this.frame=e.read8BitInt(),this.subframe=e.read8BitInt(),void 0;case 88:if(this.subtype="timeSignature",4!==i)return;return this.numerator=e.read8BitInt(),this.denominator=Math.pow(2,e.read8BitInt()),this.metronome=e.read8BitInt(),this.thirtyseconds=e.read8BitInt(),void 0;case 89:if(this.subtype="keySignature",2!==i)return;return this.key=e.read8BitInt(),this.scale=e.read8BitInt(),void 0;case 127:return this.subtype="sequencerSpecific",this.data=e.readTo(i),void 0;default:return this.subtype="unknown",this.data=e.readTo(i),void 0}return this.data=e.readTo(i),void 0}return 240==t?(this.type="sysEx",i=e.readVariableLengthInt(),this.data=e.readTo(i),void 0):247==t?(this.type="dividedSysEx",i=e.readVariableLengthInt(),this.data=e.readTo(i),void 0):(this.type="unknown",i=e.readVariableLengthInt(),this.data=e.readTo(i),console.error("unknown MIDI event type byte of length"+i),void 0)},getChannelEvent:function(e,t,i){var n,a;switch(0===(128&t)?(a=t,t=i.lastEventType):(a=e.read8BitInt(),i.lastEventType=t),n=t>>4,this.channel=15&t,this.type="channel",n){case 8:this.subtype="noteOff",this.midiNote=a,this.velocity=e.read8BitInt();break;case 9:this.midiNote=a,this.velocity=e.read8BitInt(),this.subtype=0===this.velocity?"noteOff":"noteOn";break;case 10:this.subtype="noteAftertouch",this.midiNote=a,this.amount=e.read8BitInt();break;case 11:this.subtype="controller",this.controllerType=a,this.value=e.read8BitInt();break;case 12:this.subtype="programChange",this.programNumber=a;break;case 13:this.subtype="channelAftertouch",this.amount=a;break;case 14:this.subtype="pitchBend",this.value=a+(e.read8BitInt()<<7);break;default:this.subtype="unknown",console.error("Unrecognised MIDI event type: "+n)}}},a.prototype={read32BitInt:function(){var e=(this.midiString.charCodeAt(this.pointer)<<24)+(this.midiString.charCodeAt(this.pointer+1)<<16)+(this.midiString.charCodeAt(this.pointer+2)<<8)+this.midiString.charCodeAt(this.pointer+3);return this.pointer+=4,e},read16BitInt:function(){var e=(this.midiString.charCodeAt(this.pointer)<<8)+this.midiString.charCodeAt(this.pointer+1);return this.pointer+=2,e},read8BitInt:function(){var e=this.midiString.charCodeAt(this.pointer);return this.pointer+=1,e},readTo:function(e){var t=this.midiString.substr(this.pointer,e);return this.pointer+=e,t},endOfFile:function(){return this.pointer>=this.midiString.length},readVariableLengthInt:function(){for(var e=0;;){var t=this.read8BitInt();if(!(128&t))return e+t;e+=127&t,e<<=7}}},o.prototype=Object.create(a.prototype,{readHeader:{value:function(){var e=new a(this.chunk.data);return this.formatType=e.read16BitInt(),this.trackCount=e.read16BitInt(),this.ticksPerBeat=e.read16BitInt(),32768&this.ticksPerBeat&&(this.ticksPerBeat=480,dmaf.log&&console.log("Time division in SMPTE, defaulting to 480 ticks per beat")),this.beatLengthInTicks=this.ticksPerBeat/4,this}},getTracks:{value:function(){for(var e,t,i,o=0,s=this.trackCount;s>o;o++)for(this.tracks[o]=[],t=0,this.getNextChunk("MTrk"),e=new a(this.chunk.data);!e.endOfFile();)i=new n(e,t,this),this.tracks[o].push(i),t=i.absoluteTime;return this}},getNextChunk:{value:function(e){return this.chunk.id=this.readTo(4),this.chunk.id!==e?(console.log("MidiParser expected",e,"but found",this.chunk.id),this):(this.chunk.length=this.read32BitInt(),this.chunk.data=this.readTo(this.chunk.length),this)}}})}),dmaf.once("load_modules",function(e){function t(e){return(Math.exp(e)-Math.exp(-e))/(Math.exp(e)+Math.exp(-e))}function i(e){return 0===e?1:Math.abs(e)/e}function n(e,t){var i,n,a=0,o=0,s=0,r=0;return i=e.toExponential().match(/^.\.?(.*)e(.+)$/),a=parseInt(i[2],10)-(i[1]+"").length,i=t.toExponential().match(/^.\.?(.*)e(.+)$/),o=parseInt(i[2],10)-(i[1]+"").length,o>a&&(a=o),n=e%t,-100>a||a>20?(s=Math.round(Math.log(n)/Math.log(10)),r=Math.pow(10,s),(n/r).toFixed(s-a)*r):parseFloat(n.toFixed(-a))}var a=(e.AudioNodes=Object.create(null),{lowpass:0,highpass:1,bandpass:2,lowshelf:3,highshelf:4,peaking:5,notch:6,allpass:7}),o={32:.125,"16T":.16666666666666666,"32D":.1875,16:.25,"8T":.3333333333333333,"16D":.375,8:.5,"4T":.6666666666666666,"8D":.75,4:1,"2T":1.3333333333333333,"4D":1.5,2:2,"2D":3,1:4},s=function(e,t){e.value=t},r=Object.create(e.InstancePrototype,{activate:{writable:!0,value:function(e){this.input.disconnect(),this._activated=e,e?(this.input.connect(this.activateNode),this.activateCallback&&this.activateCallback(e)):this.input.connect(this.output)}},bypass:{get:function(){return this._activated},set:function(e){this.activate(e)}},active:{get:function(){return this._activated},set:function(e){this.activate(e)}},connect:{value:function(e){this.output.connect(e)}},connectInOrder:{value:function(e){for(var t=e.length-1;t--;){if(!e[t].connect)return console.error("AudioNode.connectInOrder: TypeError: Not an AudioNode.",e[t]);e[t].connect(e[t+1])}}},setAutomatableProperty:{value:function(t,i,n,a){var o,s=this.defaults[t],r=this[t];a=a?~~(a/1e3):e.context.currentTime,n=n=n?~~(n/1e3):0,r?(i=this.verify(t,i),s.automatable?(n?(o="linearRampToValueAtTime",r.cancelScheduledValues(a),r.setValueAtTime(r.value,a)):o="setValueAtTime",r[o](i,n+a)):r=i):console.error("Invalid Property for "+this.name)}},verify:{value:e.Utils.verify}});e.AudioNodes.Filter=function(t){this.input=e.context.createGainNode(),this.filter=this.activateNode=e.context.createBiquadFilter(),this.output=e.context.createGainNode(),this.filter.connect(this.output),this.defaults=e.Settings.descriptors.type.audioNode.filter,this.frequency=t.frequency,this.Q=t.resonance,this.filterType=t.filterType,this.gain=t.gain},e.AudioNodes.Filter.prototype=Object.create(r,{name:{value:"Filter"},filterType:{enumerable:!0,get:function(){return this._filterType},set:function(e){this._filterType=this.verify("filterType",e),this.filter.type=a[this._filterType.toLowerCase()]}},Q:{enumerable:!0,get:function(){return this.filter.Q},set:function(e){this.filter.Q.value=this.verify("Q",e)}},gain:{enumerable:!0,get:function(){return this.filter.gain},set:function(e){this.filter.gain.value=this.verify("gain",e)}},frequency:{enumerable:!0,get:function(){return this.filter.frequency},set:function(e){this.filter.frequency.value=this.verify("frequency",e)}}}),e.AudioNodes.Cabinet=function(t){this.input=e.context.createGainNode(),this.activateNode=e.context.createGainNode(),this.convolver=this.newConvolver(t.impulsePath),this.makeupNode=e.context.createGainNode(),this.output=e.context.createGainNode(),this.activateNode.connect(this.convolver.input),this.convolver.output.connect(this.makeupNode),this.makeupNode.connect(this.output),this.defaults=e.Settings.descriptors.type.audioNode.cabinet,this.makeupGain=t.makeupGain,this.convolver.activate(!0)},e.AudioNodes.Cabinet.prototype=Object.create(r,{name:{value:"Cabinet"},makeupGain:{enumerable:!0,get:function(){return this.makeupNode.gain},set:function(e){this.makeupNode.gain.value=this.verify("makeupGain",e)}},newConvolver:{value:function(t){return new e.AudioNodes.Convolver({impulse:t,dryLevel:0,wetLevel:1})}}}),e.AudioNodes.Chorus=function(t){this.input=e.context.createGainNode(),this.attenuator=this.activateNode=e.context.createGainNode(),this.splitter=e.context.createChannelSplitter(2),this.delayL=e.context.createDelayNode(),this.delayR=e.context.createDelayNode(),this.feedbackGainNodeLR=e.context.createGainNode(),this.feedbackGainNodeRL=e.context.createGainNode(),this.merger=e.context.createChannelMerger(2),this.output=e.context.createGainNode(),this.lfoL=new e.AudioNodes.LFO({target:this.delayL.delayTime,callback:s}),this.lfoR=new e.AudioNodes.LFO({target:this.delayR.delayTime,callback:s}),this.input.connect(this.attenuator),this.attenuator.connect(this.output),this.attenuator.connect(this.splitter),this.splitter.connect(this.delayL,0),this.splitter.connect(this.delayR,1),this.delayL.connect(this.feedbackGainNodeLR),this.delayR.connect(this.feedbackGainNodeRL),this.feedbackGainNodeLR.connect(this.delayR),this.feedbackGainNodeRL.connect(this.delayL),this.delayL.connect(this.merger,0,0),this.delayR.connect(this.merger,0,1),this.merger.connect(this.output),this.defaults=e.Settings.descriptors.type.audioNode.chorus,this.feedback=t.feedback,this.rate=t.rate,this.delay=t.delay,this.depth=t.depth,this.lfoR.phase=Math.PI/2,this.attenuator.gain.value=.6934,this.lfoL.activate(!0),this.lfoR.activate(!0)},e.AudioNodes.Chorus.prototype=Object.create(r,{name:{value:"Chorus"},delay:{enumerable:!0,get:function(){return this._delay},set:function(e){this._delay=2e-4*Math.pow(10,2*this.verify("delay",e)),this.lfoL.offset=this._delay,this.lfoR.offset=this._delay,this._depth=this._depth}},depth:{enumerable:!0,get:function(){return this._depth},set:function(e){this._depth=this.verify("depth",e),this.lfoL.oscillation=this._depth*this._delay,this.lfoR.oscillation=this._depth*this._delay}},feedback:{enumerable:!0,get:function(){return this._feedback},set:function(e){this._feedback=this.verify("feedback",e),this.feedbackGainNodeLR.gain.value=this._feedback,this.feedbackGainNodeRL.gain.value=this._feedback}},rate:{enumerable:!0,get:function(){return this._rate},set:function(e){this._rate=this.verify("rate",e),this.lfoL._frequency=this._rate,this.lfoR._frequency=this._rate}}}),e.AudioNodes.Compressor=function(t){this.input=e.context.createGainNode(),this.compNode=this.activateNode=e.context.createDynamicsCompressor(),this.makeupNode=e.context.createGainNode(),this.output=e.context.createGainNode(),this.compNode.connect(this.makeupNode),this.makeupNode.connect(this.output),this.defaults=e.Settings.descriptors.type.audioNode.compressor,this.automakeup=t.automakeup,this.makeupGain=t.makeupGain,this.threshold=t.threshold,this.release=t.release,this.attack=t.attack,this.ratio=t.ratio,this.knee=t.knee},e.AudioNodes.Compressor.prototype=Object.create(r,{name:{value:"Compressor"},computeMakeup:{value:function(){var e=4,t=this.compNode;return-(t.threshold.value-t.threshold.value/t.ratio.value)/e}},automakeup:{enumerable:!0,get:function(){return this._automakeup},set:function(e){this._automakeup=this.verify("automakeup",e),this._automakeup&&(this.makeupGain=this.computeMakeup())}},threshold:{enumerable:!0,get:function(){return this.compNode.threshold},set:function(e){this.compNode.threshold.value=this.verify("threshold",e),this._automakeup&&(this.makeupGain=this.computeMakeup())}},ratio:{enumerable:!0,get:function(){return this.compNode.ratio},set:function(e){this.compNode.ratio.value=this.verify("ratio",e),this._automakeup&&(this.makeupGain=this.computeMakeup())}},knee:{enumerable:!0,get:function(){return this.compNode.knee},set:function(e){this.compNode.knee.value=this.verify("knee",e),this._automakeup&&(this.makeupGain=this.computeMakeup())}},attack:{enumerable:!0,get:function(){return this.compNode.attack},set:function(e){this.compNode.attack.value=this.verify("attack",e)/1e3}},release:{enumerable:!0,get:function(){return this.compNode.release},set:function(e){this.compNode.release=this.verify("release",e)/1e3}},makeupGain:{enumerable:!0,get:function(){return this.makeupNode.gain},set:function(t){var i=this.verify("makeupGain",t);this.makeupNode.gain.value=e.Utils.dbToWAVolume(i)}}}),e.AudioNodes.Convolver=function(t){this.input=e.context.createGainNode(),this.activateNode=e.context.createGainNode(),this.convolver=e.context.createConvolver(),this.dry=e.context.createGainNode(),this.filterLow=e.context.createBiquadFilter(),this.filterHigh=e.context.createBiquadFilter(),this.wet=e.context.createGainNode(),this.output=e.context.createGainNode(),this.activateNode.connect(this.filterLow),this.activateNode.connect(this.dry),this.filterLow.connect(this.filterHigh),this.filterHigh.connect(this.convolver),this.convolver.connect(this.wet),this.wet.connect(this.output),this.dry.connect(this.output),this.defaults=e.Settings.descriptors.type.audioNode.convolver,this.dryLevel=t.dryLevel,this.wetLevel=t.wetLevel,this.highCut=t.highCut,this.buffer=t.impulse,this.lowCut=t.lowCut,this.level=t.level,this.filterHigh.type=0,this.filterLow.type=1},e.AudioNodes.Convolver.prototype=Object.create(r,{name:{value:"Convolver"},lowCut:{get:function(){return this.filterLow.frequency},set:function(e){this.filterLow.frequency.value=this.verify("lowCut",e)}},highCut:{get:function(){return this.filterHigh.frequency},set:function(e){this.filterHigh.frequency.value=this.verify("highCut",e)}},level:{get:function(){return this.output.gain},set:function(e){this.output.gain.value=this.verify("level",e)}},dryLevel:{get:function(){return this.dry.gain},set:function(e){this.dry.gain.value=this.verify("dryLevel",e)}},wetLevel:{get:function(){return this.wet.gain},set:function(e){this.wet.gain.value=this.verify("wetLevel",e),this.wet.gain=this.verify("wetLevel",e)}},buffer:{enumerable:!1,get:function(){return this.convolver.buffer},set:function(t){var i=this.convolver,n=new XMLHttpRequest;return t?(n.open("GET",t,!0),n.responseType="arraybuffer",n.onreadystatechange=function(){4===n.readyState&&(300>n.status&&n.status>199||302===n.status)&&e.context.decodeAudioData(n.response,function(e){i.buffer=e},function(e){e&&console.error("DMAF.AudioNodes.Convolver.setBuffer: Error decoding data"+e)})},n.send(null),void 0):(console.error("DMAF.AudioNodes.Convolver.setBuffer: Missing impulse path!"),void 0)}}}),e.AudioNodes.Delay=function(t){this.input=e.context.createGainNode(),this.activateNode=e.context.createGainNode(),this.dry=e.context.createGainNode(),this.wet=e.context.createGainNode(),this.filter=e.context.createBiquadFilter(),this.delay=e.context.createDelayNode(),this.feedbackNode=e.context.createGainNode(),this.output=e.context.createGainNode(),this.activateNode.connect(this.delay),this.activateNode.connect(this.dry),this.delay.connect(this.filter),this.filter.connect(this.feedbackNode),this.feedbackNode.connect(this.delay),this.feedbackNode.connect(this.wet),this.wet.connect(this.output),this.dry.connect(this.output),this.defaults=e.Settings.descriptors.type.audioNode.delay,this.tempoSync=t.tempoSync,this.tempoSync&&(this.subdivision=t.subdivision),this.delayTime=t.delayTime,this.feedback=t.feedback,this.wetLevel=t.wetLevel,this.dryLevel=t.dryLevel,this.cutoff=t.cutoff,this.filter.type=1},e.AudioNodes.Delay.prototype=Object.create(r,{name:{value:"Delay"},tempoListener:{value:function(e){this.tempo=e,this.delayTime=this.tempo}},tempoSync:{get:function(){return this._tempoSync},set:function(t){if(t&&"string"==typeof t){var i=e.getInstance("player:"+t);this.tempo=i?i.tempo:90,this._tempoSync=t,dmaf.addEventListener("tempo_"+this._tempoSync,this.tempoListener.bind(this))}else this._tempoSync=!1}},subdivision:{get:function(){return this._subdivision},set:function(e){this._subdivision=this.verify("subdivision",e)}},tempo:{get:function(){return this._tempo},set:function(e){this._tempo=e}},delayTime:{enumerable:!0,get:function(){return this.delay.delayTime},set:function(e){this.delay.delayTime.value=this._tempoSync?this.verify("delayTime",60*o[this.subdivision]/this.tempo):this.verify("delayTime",e)/1e3}},wetLevel:{enumerable:!0,get:function(){return this.wet.gain},set:function(e){this.wet.gain.value=this.verify("wetLevel",e)}},dryLevel:{enumerable:!0,get:function(){return this.dry.gain},set:function(e){this.dry.gain.value=this.verify("dryLevel",e)}},feedback:{enumerable:!0,get:function(){return this.feedbackNode.gain},set:function(e){this.feedbackNode.gain.value=this.verify("feedback",e)}},cutoff:{enumerable:!0,get:function(){return this.filter.frequency},set:function(e){this.filter.frequency.value=this.verify("cutoff",e)}}}),e.AudioNodes.EnvelopeFollower=function(t){this.input=e.context.createGainNode(),this.jsNode=this.output=e.context.createJavaScriptNode(this.buffersize,1,1),this.input.connect(this.output),this.defaults=e.Settings.descriptors.type.audioNode.envelopeFollower,this.attackTime=t.attackTime,this.releaseTime=t.releaseTime,this._envelope=0,this.target=t.target,this.callback=t.callback},e.AudioNodes.EnvelopeFollower.prototype=Object.create(r,{name:{value:"EnvelopeFollower"},buffersize:{value:256},envelope:{value:0},sampleRate:{value:44100},attackTime:{enumerable:!0,get:function(){return this._attackTime},set:function(e){this._attackTime=this.verify("attackTime",e),this._attackC=Math.exp(-1/this._attackTime*this.sampleRate/this.buffersize)}},releaseTime:{enumerable:!0,get:function(){return this._releaseTime},set:function(e){this._releaseTime=this.verify("releaseTime",e),this._releaseC=Math.exp(-1/this._releaseTime*this.sampleRate/this.buffersize)}},callback:{get:function(){return this._callback},set:function(e){"function"==typeof e?this._callback=e:console.error(this.name+": Callback must be a function! TypeError: ",e)}},target:{get:function(){return this._target},set:function(e){"object"==typeof e?this._target=e:console.error(this.name+": Callback must be an AudioParam interface! TypeError: ",e)}},activate:{value:function(t){this.activated=t,t?(this.jsNode.connect(e.context.destination),this.jsNode.onaudioprocess=this.returnCompute(this)):(this.jsNode.disconnect(),this.jsNode.onaudioprocess=null)}},returnCompute:{value:function(e){return function(t){e.compute(t)}}},compute:{value:function(e){var t,i,n,a,o=e.inputBuffer.getChannelData(0).length,s=e.inputBuffer.numberOfChannels;if(i=n=0,s>1)for(a=0;o>a;++a)for(;s>i;++i)t=e.inputBuffer.getChannelData(i)[a],n+=t*t/s;else for(a=0;o>a;++a)t=e.inputBuffer.getChannelData(0)[a],n+=t*t;n=Math.sqrt(n),n>this._envelope?(this._envelope*=this._attackC,this._envelope+=(1-this._attackC)*n):(this._envelope*=this._releaseC,this._envelope+=(1-this._releaseC)*n),this._callback(this._target,this._envelope)}}}),e.AudioNodes.Equalizer=function(){function t(t){this._defaults=e.Settings.descriptors.type.audioNode.equalizer,this.nbands=t.bands.length;for(var i=0,n=this._nbands;n>i;i++);this.input=e.context.createGainNode(),this.output=e.context.createGainNode(),this.activateNode=e.context.createGainNode()}return t}(),e.AudioNodes.Equalizer.prototype=Object.create(r,{name:{value:"Equalizer"},propertySearch:{value:/:bypass|:type|:frequency|:gain|:q/i}}),e.AudioNodes.LFO=function(){function t(t){this.output=e.context.createJavaScriptNode(256,1,1),this.activateNode=e.context.destination,this.defaults=e.Settings.descriptors.type.audioNode.lfo,this.type=t.type,this.frequency=t.frequency,this.offset=t.offset,this.oscillation=t.oscillation,this.phase=t.phase,this.target=t.target,this.output.onaudioprocess=this.callback(t.callback)}return t.prototype=Object.create(r,{name:{value:"LFO"},bufferSize:{value:256},sampleRate:{value:44100},type:{enumerable:!0,get:function(){return this._type},set:function(e){this._type=this.verify("type",e)}},frequency:{get:function(){return this._frequency},set:function(e){this._frequency=this.verify("frequency",e),this._phaseInc=2*Math.PI*this._frequency*this.bufferSize/this.sampleRate}},offset:{get:function(){return this._offset},set:function(e){this._offset=this.verify("offset",e)}},oscillation:{get:function(){return this._oscillation},set:function(e){this._oscillation=this.verify("oscillation",e)}},phase:{get:function(){return this._phase},set:function(e){this._phase=this.verify("phase",e)}},target:{get:function(){return this._target},set:function(e){this._target=e}},activate:{value:function(t){this._activated=t,t?this.output.connect(e.context.destination):this.output.disconnect(e.context.destination)}},callback:{value:function(e){var t=this;return function(){t._phase+=t._phaseInc,t._phase>2*Math.PI&&(t._phase=0),e(t._target,t._offset+t._oscillation*Math.sin(t._phase))}}}}),t}(),e.AudioNodes.Overdrive=function(t){this.input=e.context.createGainNode(),this.activateNode=e.context.createGainNode(),this.inputDrive=e.context.createGainNode(),this.waveshaper=e.context.createWaveShaper(),this.outputDrive=e.context.createGainNode(),this.output=e.context.createGainNode(),this.activateNode.connect(this.inputDrive),this.inputDrive.connect(this.waveshaper),this.waveshaper.connect(this.outputDrive),this.outputDrive.connect(this.output),this.defaults=e.Settings.descriptors.type.audioNode.overdrive,this.ws_table=new Float32Array(this.k_nSamples),this.drive=t.drive,this.outputGain=t.outputGain,this.curveAmount=t.curveAmount,this.algorithm=t.algorithmIndex},e.AudioNodes.Overdrive.prototype=Object.create(r,{name:{value:"Overdrive"},k_nSamples:{value:8192},drive:{get:function(){return this.inputDrive.gain},set:function(e){this._drive=this.verify("drive",e)}},curveAmount:{get:function(){return this._curveAmount},set:function(e){this._curveAmount=this.verify("curveAmount",e),void 0===this._algorithmIndex&&(this._algorithmIndex=0),this.waveshaperAlgorithms[this._algorithmIndex](this._curveAmount,this.k_nSamples,this.ws_table),this.waveshaper.curve=this.ws_table}},outputGain:{get:function(){return this.outputDrive.gain},set:function(t){var i=this.verify("outputGain",t);this._outputGain=e.Utils.dbToWAVolume(i)}},algorithm:{get:function(){return this._algorithmIndex},set:function(e){this._algorithmIndex=this.verify("algorithmIndex",e),this.curveAmount=this._curveAmount}},waveshaperAlgorithms:{value:[function(e,t,i){var n,a,o=2*e/(1-e);for(n=0;t>n;n++)a=2*n/t-1,i[n]=(1+o)*a/(1+o*Math.abs(a))},function(e,i,n){var a,o,s;for(a=0;i>a;a++)o=2*a/i-1,s=(.5*Math.pow(o+1.4,2)-1)*s>=0?5.8:1.2,n[a]=t(s)},function(e,i,n){var a,o,s,r=1-e;for(a=0;i>a;a++)o=2*a/i-1,s=0>o?-Math.pow(Math.abs(o),r+.04):Math.pow(o,r),n[a]=t(2*s)},function(e,t,n){var a,o,s,r,l=1-e>.99?.99:1-e;for(a=0;t>a;a++)o=2*a/t-1,r=Math.abs(o),l>r?s=r:r>l?s=l+(r-l)/(1+Math.pow((r-l)/(1-l),2)):r>1&&(s=r),n[a]=i(o)*s*(1/((l+1)/2))},function(e,t,i){var n,a;for(n=0;t>n;n++)a=2*n/t-1,i[n]=-.08905>a?-3/4*(1-Math.pow(1-(Math.abs(a)-.032857),12)+1/3*(Math.abs(a)-.032847))+.01:a>=-.08905&&.320018>a?-6.153*a*a+3.9375*a:.630035},function(e,t,i){var n,a,o=2+Math.round(14*e),s=Math.round(Math.pow(2,o-1));for(n=0;t>n;n++)a=2*n/t-1,i[n]=Math.round(a*s)/s}]}}),e.AudioNodes.Panner=function(t){this.input=e.context.createGainNode(),this.splitter=e.context.createChannelSplitter(2),this.lGain=e.context.createGainNode(),this.rGain=e.context.createGainNode(),this.merger=e.context.createChannelMerger(2),this.output=e.context.createGainNode(),this.input.connect(this.splitter),this.splitter.connect(this.lGain,0),this.splitter.connect(this.rGain,1),this.lGain.connect(this.merger,0,0),this.rGain.connect(this.merger,0,1),this.merger.connect(this.output),this.pan=t.value},e.AudioNodes.Panner.prototype=Object.create(r,{pan:{get:function(){return this._value},set:function(e){var t=(e+100)/200;this._value=e,this.lGain.gain.value=Math.cos(t*Math.PI/2),this.rGain.gain.value=Math.sin(t*Math.PI/2)
}}}),e.AudioNodes.PingPongDelay=function(t){this.input=e.context.createGainNode(),this.activateNode=e.context.createGainNode(),this.dry=e.context.createGainNode(),this.splitter=e.context.createChannelSplitter(2),this.toMono=e.context.createGainNode(),this.wet=e.context.createGainNode(),this.feedbackNode=e.context.createGainNode(),this.delayL=new e.AudioNodes.Delay(t),this.delayR=new e.AudioNodes.Delay(t),this.merger=e.context.createChannelMerger(),this.output=e.context.createGainNode(),this.activateNode.connect(this.dry),this.activateNode.connect(this.splitter),this.splitter.connect(this.toMono,0,0),this.splitter.connect(this.toMono,1,0),this.toMono.connect(this.wet),this.wet.connect(this.delayL.delay),this.feedbackNode.connect(this.delayL.delay),this.delayL.delay.connect(this.delayR.delay),this.delayR.delay.connect(this.feedbackNode),this.delayL.delay.connect(this.merger,0,0),this.delayR.delay.connect(this.merger,0,1),this.dry.connect(this.output),this.merger.connect(this.output),this.delayL.feedback=0,this.delayR.feedback=0,this.delayL.wetLevel=1,this.delayR.wetLevel=1,this.delayL.dryLevel=0,this.delayR.dryLevel=0,this.defaults=e.Settings.descriptors.type.audioNode.pingPongDelay,this.cutoff=t.cutoff,this.tempoSync=t.tempoSync,this.tempoSync&&(this.subdivision=t.subdivision),this.delayTime=t.delayTime,this.feedback=t.feedback,this.wetLevel=t.wetLevel,this.dryLevel=t.dryLevel},e.AudioNodes.PingPongDelay.prototype=Object.create(r,{name:{value:"PingPongDelay"},tempoSync:{get:function(){return this._tempoSync},set:function(t){var i=t?e.getInstance("player",t):null;this.tempo=i?i.tempo:120,this._tempoSync=this.verify("tempoSync",t),this.delayL.tempoSync=this._tempoSync,this.delayR.tempoSync=this._tempoSync}},tempo:{get:function(){return this._tempo},set:function(e){this._tempo=e,this.delayL.tempo=e,this.delayR.tempo=e}},subdivision:{get:function(){return this._subdivision},set:function(e){this._subdivision=this.verify("subdivision",e),this.delayL.subdivision=this._subdivision,this.delayR.subdivision=this._subdivision}},delayTime:{enumerable:!0,get:function(){return this._delayTime},set:function(e){this._tempoSync?(this._delayTime=this.verify("delayTime",60*o[this.subdivision]/this.tempo),this.delayL.delayTime=this._delayTime,this.delayR.delayTime=this._delayTime):(this._delayTime=this.verify("delayTime",e)/1e3,this.delayL.delayTime=e,this.delayR.delayTime=e)}},wetLevel:{enumerable:!0,get:function(){return this.wet.gain},set:function(e){this.wet.gain.value=this.verify("wetLevel",e)}},dryLevel:{enumerable:!0,get:function(){return this.dry.gain},set:function(e){this.dry.gain.value=this.verify("dryLevel",e)}},feedback:{enumerable:!0,get:function(){return this.feedbackNode.gain},set:function(e){this.feedbackNode.gain.value=this.verify("feedback",e)}},cutoff:{enumerable:!0,get:function(){return this.delayL.filter.frequency},set:function(e){this.delayL.filter.frequency.value=this.verify("cutoff",e),this.delayR.filter.frequency.value=this.verify("cutoff",e)}}}),e.AudioNodes.Phaser=function(t){this.input=e.context.createGainNode(),this.splitter=this.activateNode=e.context.createChannelSplitter(2),this.filtersL=[],this.filtersR=[],this.feedbackGainNodeL=e.context.createGainNode(),this.feedbackGainNodeR=e.context.createGainNode(),this.merger=e.context.createChannelMerger(2),this.filteredSignal=e.context.createGainNode(),this.output=e.context.createGainNode(),this.lfoL=new e.AudioNodes.LFO({target:this.filtersL,callback:this.callback}),this.lfoR=new e.AudioNodes.LFO({target:this.filtersR,callback:this.callback});for(var i=this.stage;i--;)this.filtersL[i]=e.context.createBiquadFilter(),this.filtersR[i]=e.context.createBiquadFilter(),this.filtersL[i].type=7,this.filtersR[i].type=7;this.input.connect(this.splitter),this.input.connect(this.output),this.splitter.connect(this.filtersL[0],0,0),this.splitter.connect(this.filtersR[0],1,0),this.connectInOrder(this.filtersL),this.connectInOrder(this.filtersR),this.filtersL[this.stage-1].connect(this.feedbackGainNodeL),this.filtersL[this.stage-1].connect(this.merger,0,0),this.filtersR[this.stage-1].connect(this.feedbackGainNodeR),this.filtersR[this.stage-1].connect(this.merger,0,1),this.feedbackGainNodeL.connect(this.filtersL[0]),this.feedbackGainNodeR.connect(this.filtersR[0]),this.merger.connect(this.output),this.defaults=e.Settings.descriptors.type.audioNode.phaser,this.rate=t.rate,this.baseModulationFrequency=t.baseModulationFrequency,this.depth=t.depth,this.feedback=t.feedback,this.stereoPhase=t.stereoPhase,this.lfoL.activate(!0),this.lfoR.activate(!0)},e.AudioNodes.Phaser.prototype=Object.create(r,{name:{value:"Phaser"},stage:{value:4},callback:{value:function(e,t){for(var i=0;4>i;i++)e[i].frequency.value=t}},depth:{enumerable:!0,get:function(){return this._depth},set:function(e){this._depth=this.verify("depth",e),this.lfoL.oscillation=this._baseModulationFrequency*this._depth,this.lfoR.oscillation=this._baseModulationFrequency*this._depth}},rate:{enumerable:!0,get:function(){return this._rate},set:function(e){this._rate=this.verify("rate",e),this.lfoL.frequency=this._rate,this.lfoR.frequency=this._rate}},baseModulationFrequency:{enumerable:!0,get:function(){return this._baseModulationFrequency},set:function(e){this._baseModulationFrequency=this.verify("baseModulationFrequency",e),this.lfoL.offset=this._baseModulationFrequency,this.lfoR.offset=this._baseModulationFrequency,this._depth=this.verify("depth",this._depth)}},feedback:{get:function(){return this._feedback},set:function(e){this._feedback=this.verify("feedback",e),this.feedbackGainNodeL.gain.value=this._feedback,this.feedbackGainNodeR.gain.value=this._feedback}},stereoPhase:{get:function(){return this._stereoPhase},set:function(e){this._stereoPhase=this.verify("stereoPhase",e);var t=this.lfoL._phase+this._stereoPhase*Math.PI/180;t=n(t,2*Math.PI),this.lfoR._phase=t}}}),e.AudioNodes.Tremolo=function(t){this.input=e.context.createGainNode(),this.splitter=this.activateNode=e.context.createChannelSplitter(2),this.amplitudeL=e.context.createGainNode(),this.amplitudeR=e.context.createGainNode(),this.merger=e.context.createChannelMerger(2),this.output=e.context.createGainNode(),this.lfoL=new e.AudioNodes.LFO({target:this.amplitudeL.gain,callback:s}),this.lfoR=new e.AudioNodes.LFO({target:this.amplitudeR.gain,callback:s}),this.input.connect(this.splitter),this.splitter.connect(this.amplitudeL,0),this.splitter.connect(this.amplitudeR,1),this.amplitudeL.connect(this.merger,0,0),this.amplitudeR.connect(this.merger,0,1),this.merger.connect(this.output),this.defaults=e.Settings.descriptors.type.audioNode.tremolo,this.rate=t.rate,this.intensity=t.intensity,this.stereoPhase=t.stereoPhase,this.lfoL.offset=1-this.intensity/2,this.lfoR.offset=1-this.intensity/2,this.lfoL.phase=this.stereoPhase*Math.PI/180,this.lfoL.activate(!0),this.lfoR.activate(!0)},e.AudioNodes.Tremolo.prototype=Object.create(r,{name:{value:"Tremolo"},intensity:{enumerable:!0,get:function(){return this._intensity},set:function(e){this._intensity=this.verify("intensity",e),this.lfoL.offset=this._intensity/2,this.lfoR.offset=this._intensity/2,this.lfoL.oscillation=this._intensity,this.lfoR.oscillation=this._intensity}},rate:{enumerable:!0,get:function(){return this._rate},set:function(e){this._rate=this.verify("rate",e),this.lfoL.frequency=this._rate,this.lfoR.frequency=this._rate}},steroPhase:{enumerable:!0,get:function(){return this._rate},set:function(e){this._stereoPhase=this.verify("stereoPhase",e);var t=this.lfoL._phase+this._stereoPhase*Math.PI/180;t=n(t,2*Math.PI),this.lfoR.phase=t}}}),e.AudioNodes.WahWah=function(t){this.input=e.context.createGainNode(),this.activateNode=e.context.createGainNode(),this.envelopeFollower=new e.AudioNodes.EnvelopeFollower({target:this,callback:function(e,t){e.sweep=t}}),this.filterBp=e.context.createBiquadFilter(),this.filterPeaking=e.context.createBiquadFilter(),this.output=e.context.createGainNode(),this.activateNode.connect(this.filterBp),this.filterBp.connect(this.filterPeaking),this.filterPeaking.connect(this.output),this.defaults=e.Settings.descriptors.type.audioNode.wahWah,this.init(),this.automode=t.enableAutoMode,this.resonance=t.resonance,this.sensitivity=t.sensitivity,this.baseFrequency=t.baseModulationFrequency,this.excursionOctaves=t.excursionOctaves,this.sweep=t.sweep,this.envelopeFollower.activate(!0)},e.AudioNodes.WahWah.prototype=Object.create(r,{name:{value:"WahWah"},activateCallback:{value:function(e){this.automode=e}},automode:{get:function(){return this._automode},set:function(e){this._automode=e,e?(this.activateNode.connect(this.envelopeFollower.input),this.envelopeFollower.activate(!0)):(this.envelopeFollower.activate(!1),this.activateNode.disconnect(),this.activateNode.connect(this.filterBp))}},sweep:{enumerable:!0,get:function(){return this._sweep.value},set:function(e){this._sweep=Math.pow(e>1?1:0>e?0:e,this._sensitivity),this.filterBp.frequency.value=this._baseFrequency+this._excursionFrequency*this._sweep,this.filterPeaking.frequency.value=this._baseFrequency+this._excursionFrequency*this._sweep}},baseFrequency:{enumerable:!0,get:function(){return this._baseFrequency},set:function(e){this._baseFrequency=50*Math.pow(10,2*this.verify("baseFrequency",e)),this._excursionFrequency=Math.min(this.sampleRate/2,this.baseFrequency*Math.pow(2,this._excursionOctaves)),this.filterBp.frequency.value=this._baseFrequency+this._excursionFrequency*this._sweep,this.filterPeaking.frequency.value=this._baseFrequency+this._excursionFrequency*this._sweep}},excursionOctaves:{enumerable:!0,get:function(){return this._excursionOctaves},set:function(e){this._excursionOctaves=this.verify("excursionOctaves",e),this._excursionFrequency=Math.min(this.sampleRate/2,this.baseFrequency*Math.pow(2,this._excursionOctaves)),this.filterBp.frequency.value=this._baseFrequency+this._excursionFrequency*this._sweep,this.filterPeaking.frequency.value=this._baseFrequency+this._excursionFrequency*this._sweep}},sensitivity:{enumerable:!0,get:function(){return this._sensitivity},set:function(e){this._sensitivity=this.verify("sensitivity",e),this._sensitivity=Math.pow(10,this._sensitivity)}},resonance:{enumerable:!0,get:function(){return this._resonance},set:function(e){this._resonance=this.verify("resonance",e),this.filterPeaking.Q=this._resonance}},init:{value:function(){var t,i,n=Object.keys(this.defaults);for(this.output.gain.value=5,this.filterPeaking.type=5,this.filterBp.type=2,this.filterPeaking.frequency.value=100,this.filterPeaking.gain.value=20,this.filterPeaking.Q.value=5,this.filterBp.frequency.value=100,this.filterBp.Q.value=1,this.sampleRate=e.context.sampleRate,t=0,i=n.length;i>t;t++)this[n[t]]=this.defaults[n[t]].value}}})}),dmaf.once("load_modules",function(e){function t(e,t,i,n){this.eventName=e,this.beat=t,this.tick=i||1,this.data=n}function i(t){return new e.Processor.BeatPosition(t.bar,t.beat,this.player.beatsPerBar)}e.Processor={},e.Processor.TimePattern=function(e,t){this.patternId=e,this.events=t,this.startTime=-1,this.lastExecutedEventTime=-1},e.Processor.TimePattern.prototype={executeEvents:function(t){var i=1e3*e.context.currentTime-this.startTime,n=-1;switch(t){case"LINEAR":this.executeLinear(i,n);break;case"DEFAULT":this.executeDefault(i,n);break;default:dmaf.log&&console.log("Invalid behavior type for TimePattern",this.behavior)}},executeLinear:function(t){var i,n;for(i=0,n=this.events.length;n>i;i++)this.events[i].absoluteTime>this.lastExecutedEventTime&&t>this.events[i].absoluteTime-e.preListen&&(e.ActionManager.onEvent(this.events[i].trigger,this.startTime+this.events[i].absoluteTime,this.events[i]),this.lastExecutedEventTime=this.events[i].absoluteTime)},executeDefault:function(t,i){var n,a;if(-1===this.lastExecutedEventTime){for(n=0,a=this.events.length;a>n;n++)t>this.events[n].absoluteTime-e.preListen&&(e.ActionManager.onEvent(this.events[n].trigger,this.startTime+this.events[n].absoluteTime,this.events[n]),i=this.events[n].absoluteTime);this.lastExecutedEventTime=i}else this.executeLinear(t,i)}},e.Processor.BeatPatternInstance=function(t,n){if(!n.beatPattern)return console.error("Found no BeatPattern for channel",n.channel,". Please check MIDI file."),this.ERROR=!0,void 0;if(this.addAtSongPosition=n.addAtSongPosition,this.currentBeat=n.startPatternAtBeat,this.replaceActive=n.replaceActive,this.clearPosition=n.clearPosition,this.setAsCurrent=n.setAsCurrent,this.beatPattern=n.beatPattern,this.patternId=n.patternId,this.channel=n.channel,this.loop=n.loop,this.player=t,this.loop)n.loopLength?(this.loopLength=n.loopLength,this.removeAtSongPosition=new e.Processor.BeatPosition(1/0,1,this.player.beatsPerBar)):dmaf.log&&console.error("You must specify a loopLength for pattern "+this.patternId+" if loop is set to true."),this.currentBeat===this.loopLength&&(this.currentBeat=1);else{this.removeAtSongPosition=i.call(this,this.addAtSongPosition);var a=this.beatPattern.endPosition-this.currentBeat;this.removeAtSongPosition.addOffset({bar:0,beats:a})}},e.Processor.BeatPatternInstance.prototype={gotoNextBeat:function(){this.currentBeat++,this.loop&&this.currentBeat>this.loopLength&&(this.currentBeat=1)},executeEvents:function(e,t){var i=this.beatPattern.events[this.currentBeat];if(i)for(var n=0,a=i.length;a>n;n++)i[n].execute(e,t)}},e.Processor.BeatPattern=function(e,t){this.events={},this.patternId=e,this.startPosition=t||1,this.endPosition=0},e.Processor.BeatPattern.prototype={addEvent:function(e,i,n,a){this.events[i]=this.events[i]||[],this.events[i].push(new t(e,i,n,a)),i+1>this.endPosition&&(this.endPosition=i+1)}},e.Processor.BeatPosition=function(e,t,i){this.bar=void 0===e?1:e,this.beat=void 0===t?1:t,this.beatsPerBar=void 0===i?16:i},e.Processor.BeatPosition.prototype={getInBeats:function(){return(this.bar-1)*this.beatsPerBar+this.beat},gotoNextBeat:function(){this.beat===this.beatsPerBar?(this.bar++,this.beat=1):this.beat++},addOffset:function(e){for(this.beat+=e.beat;this.beat>this.beatsPerBar;)this.bar++,this.beat-=this.beatsPerBar;this.bar+=e.bar}},t.prototype.execute=function(t,i){var n=Object.create(this.data);t=~~(t+(this.tick-1)*(i/120)),n.duration=t+n.duration*(i/120)/1e3-t,n.duration*=1e3,e.ActionManager.onEvent(this.eventName,t,n)},e.setAsset("beatPattern","empty_pattern",new e.Processor.BeatPattern("empty_pattern",1))}),dmaf.once("load_modules",function(e){var t={ROUND_ROBIN:function(){return this.index++,this.index%=this.array.length,this.array[this.index]},RANDOM_FIRST:function(){return-1===this.index?this.array[Math.floor(Math.random()*this.array.length)]:this.array[++this.index]},RANDOM:function(){return this.array[Math.floor(Math.random()*this.array.length)]},SHUFFLE:function(){var e;this.A.length||(this.A=this.array.slice(0),this.B=[]);do e=Math.floor(Math.random()*this.A.length);while(this.A[e]===this.previous);return this.B.push(this.A.splice(e,1)[0]),this.previous=this.B[this.B.length-1],this.previous}};e.Iterator=function(e,i){this.index=-1,this.array=e,this.getNext=t[i],this.A=e.slice(0),this.B=[]}}),!dmaf&&"undefined"!=typeof require)var dmaf=require("../facade.js"),isNode=!0;dmaf.once("load_core",function(e){function t(e,t){var i,n,a,o=0;if(e instanceof Array)for(o=0,a=e.length;a>o&&(!e[o]||!t(o,e[o]));o++);else if("object"==typeof e)for(i=Object.keys(e),o=0,a=i.length;a>o&&(n=i[o],"length"===n||!e[n]||!t(n,e[n]));o++);else console.error("Not array or object",typeof e,e)}function i(e){var i=[];return e||console.error("Missing descriptor"),t(e,function(e,t){"array"===t.type&&i.push(t)}),i}function n(e,i){return t(i,function(t){(void 0===e[t]||"undefined"===e[t])&&(e[t]=i[t][_])}),e}function a(e){var i;return t(y.action,function(n,a){return t(a,function(t,n){return t===e?i=n:void 0}),i}),i||console.error("Could not find action with Id of",e)}function o(e){return Object.keys(y.type[e]).filter(function(e){return"type"!==e})}function s(e){return e.replace(/\s+/g,"")}function r(e){for(var t,i=e.attributes,n={},a=0,o=i.length;o>a;a++)t=i[a].nodeName,g[t]&&(n[t]=l(g[t],i[a].value,e));return n}function l(e,t,i){if(void 0===t||"undefined"===t)return void 0;switch(e){case"string":return t;case"boolean":return"true"===t;case"int":return parseInt(t,10);case"float":return parseFloat(t);case"list":return t.split(",");case"enum":return t;case"fromType":return l(i[P]("type"),t,i);default:console.error(e)}}function c(e,a,o){var s=e[v]("properties"),r=i(a),l={};return t(s,function(e,t){t.localName&&d(l,t,a)}),t(r,function(t,i){if(e[v]){var n=e[v](i.name)[0]||[];l[i.name]=n?u(n,i.valueType):[]}else l[i.name]=[]}),n(l,a,o)}function d(e,i,n){for(var a=i.attributes,o=0,s=a.length;s>o;o++)if(void 0===n[a[o].localName]&&"triggers"!==a[o].localName&&"delay"!==a[o].localName)return console.error("Invalid attribute",a[o].localName,"check spelling in descriptors");t(n,function(t,n){i.hasAttribute(t)&&(value=i[P](t),/\:/.test(value)&&!/target/.test(t)?(e._dynamicValues=e._dynamicValues||[],e._dynamicValues.push({key:t,string:value}),e[t]=n[_]):(value=l(n.type,value,n),e[t]=m(n,value)))})}function u(e,n){if(e[v]){var a=o(n),s=[],r=[],l=y.type[n];return t(a,function(i,n){var a=e[v](n);t(a,function(e,t){t&&t.localName&&s.push(t)})}),t(s,function(n,a){if(a.localName&&l[a.localName]){var o={id:a.localName},s=i(l[o.id]);d(o,a,l[o.id]),t(s,function(t,i){var n=e[v](i.name)[0];o[i.name]=n&&n[v]?u(n,i.valueType):[]}),r.push(o)}}),r}return[]}function p(e,t){return e>t.max&&(console.log(e,"is out of range. constraining",t.name,"to:",t.max),e=t.max),t.min>e&&(console.log(e,"is out of range. constraining",t.name,"to:",t.min),e=t.min),e}function m(e,t){var i;if(e&&void 0!==e.type||console.warn("DMAF Verification Error: Malformed descriptor!"),void 0===t)return e[_];switch(e.type){case"int":if(!A.test(t)){i=!0;break}t=p(t,e);break;case"float":if(isNaN(t)){i=!0;break}t=p(t,e);break;case"string":"undefined"===t&&(t=void 0),"string"!=typeof t&&(i=!0);break;case"list":i=!(t instanceof Array);break;case"enum":e.values&&e.values instanceof Array?-1===e.values.indexOf(t)&&(console.log(t,"is not valid enum for",e.name),i=!0):(console.log("Malformed descriptors object",e.name),i=!0);break;case"boolean":i="boolean"!=typeof t;break;default:console.warn("Malformed defaults object. Please check the descriptors.xml")}return i?(console.warn(t,"is not valid for",e.name),console.warn("Defaulting",e.name,"to",e[_]),e[_]):t}function h(e){var i,n,a,o,s,l=e[v]("descriptor"),c={validActions:[],validTypes:[]};return t(l,function(e,l){l[P]&&(s=l[P]("id"),o=l[P]("type"),a=l[P]("class"),c[a]=c[a]||{},c[a][o]=c[a][o]||{},c[a][o][s]=n=c[a][o][s]||{},c[a][o][s].type=o,c[a][o][s].id=s,c[a][o].type=o,"action"===a&&c.validActions.push(s),"type"===a&&c.validTypes.push(s),i=l[v]("property"),t(i,function(e,t){t[P]&&(n[t[P]("name")]=r(t))}))}),y=c}function f(e){var i=e[v]("actions")[0].childNodes,n=[],o=[];return t(i,function(e,t){t&&t.localName&&t[v]&&(-1!==y.validActions.indexOf(t.localName)?n.push(t):console.error("Unrecognized action!",t.localName,"check spelling."))}),t(n,function(e,t){if(t.localName&&t[v]){var i=t.localName,n=a(i),r=c(t,n,t.localName),l=n.type,d=t[P]("triggers"),u=t[P]("delay"),p=t[P]("instanceId");if(Settings={},!d)return console.error("Action",l,i,r.instanceId,"has no triggers!"),!0;d=d.split(",").map(s),o.push({type:l,id:t.localName,triggers:d,actionProperties:r,delay:parseInt(u,10)||0,instanceId:p})}}),o}var y,g={automatable:"boolean","default":"fromType",valueType:"string",value:"fromType",min:"fromType",max:"fromType",name:"string",type:"string",values:"list",unit:"string",src:"string"},_="default",v="getElementsByTagName",P="getAttribute",A=/^\s*-?[0-9]{1,10}\s*$/,b={};b.parseActions=f,b.parseDescriptors=h,b.verify=m,b.each=t,e.Parser=b}),dmaf.once("load_core",function(e){function t(e,t){return dmaf.log&&console.log("DMAF TypeError for "+t.name+": "+e+" is not of type "+t.type),t["default"]}function i(e,t){return dmaf.log&&console.log("DMAF RangeError for "+t.name+": "+e+" is below minimum threshold."),t.min}function n(e,t){return dmaf.log&&console.log("DMAF RangeError for "+t.name+": "+e+" is above maximum threshold."),t.max}function a(e,t){return dmaf.log&&console.log("DMAF enumError for "+t.name+": "+e+" is not an allowed value"),t["default"]}var o={cflat:-1,c:0,csharp:1,dflat:1,d:2,dsharp:3,eflat:3,e:4,esharp:5,fflat:4,f:5,fsharp:6,gflat:6,g:7,gsharp:8,aflat:8,a:9,asharp:10,bflat:10,b:11,bsharp:12};e.Utils={ajax:function(t,i,n){function a(){if(4===this.readyState){var i,a=n&&n.context||e,c=this.status>=200&&300>this.status||304===this.status;if(!c||!this.response)return s.onerror=function(){},o();if(n&&n.expectType&&typeof this.response!==n.expectType)return o();if(i=n.responseXML?this.responseXML:this.response,n.responseXML&&!this.responseXML)return dmaf.log&&console.log("Problem with XMLHttpRequest: XML is missing or malformed.",t),o();for(var d=0,u=l.length;u>d;d++)r.unshift(i),i=l[d].apply(a,r)}}var o,s=new XMLHttpRequest,r=[],l=[i];n?(n.override&&s.overrideMimeType(n.override),n.responseType&&(s.responseType=n.responseType),n.chain&&(l=l.concat(n.chain)),n.args&&(r=r.concat(n.args))):n={},o=n.fail?n.fail:function(){dmaf.log&&console.log("DMAF.ajax: Problem with request",t)},s.onerror=o,s.onreadystatechange=a,s.open("GET",t,!0),s.send()},clone:function(e){return"object"!=typeof e?{}:JSON.parse(JSON.stringify(e))},calculateAverage:function(e){for(var t=0,i=0,n=e.length;n>i;i++)t+=e[i];return t/e.length},dbToJSVolume:function(e){var t=Math.max(0,Math.round(100*Math.pow(2,e/6))/100);return Math.min(1,t)},dbToWAVolume:function(e){return Math.max(0,Math.floor(100*Math.pow(2,e/6))/100)},capitalize:function(e){return e.charAt(0).toUpperCase()+e.slice(1)},createEffectsRecursive:function(t,i){for(var n,a,o=[],s=0;i.length>s;s++)n=i[s],a=new(e.AudioNodes[this.capitalize(n.id)])(n),n.active?a.activate(!0):a.activate(!1),o.push(a),t.connect(a.input),t=a;return o},fromString:function(e,t){if(t===undef)return void 0;switch(e){case"string":return t;case"boolean":return"true"===t;case"int":return parseInt(t,10);case"float":return parseFloat(t);case"list":return t.split(separator);default:console.error("FromString Error: ",e,t)}},MIDIToFrequency:function(e){return 8.1757989156*Math.pow(2,e/12)},removeWhiteSpace:function(e){return e.replace(/\s+/g,"")},toMIDINote:function(e){var t,i,n,a;return"#"===e[1]||"s"===e[1].toLowerCase()?(i=e[0].toLowerCase()+"sharp",a=2):"b"===e[1]?(i=e[0].toLowerCase()+"flat",a=2):(i=e[0].toLowerCase(),a=1),i=o[i],n="-"===e[a]?12*(0-parseInt(e[a+1],10)+2):12*(parseInt(e[a],10)+2),t=n+i},getFileFormat:function(){function t(e){return!(!n.canPlayType||!n.canPlayType(a[e]||"").replace(/no/,""))}for(var i=["ogg","aac","mp3","wav"],n=document.createElement("audio"),a={wav:'audio/wav; codecs="1"',mp3:"audio/mpeg;",aac:'audio/mp4; codecs="mp4a.40.2"',ogg:'audio/ogg; codecs="vorbis"'},o=0,s=i.length;s>o;o++)if(t(i[o]))return e.fileFormat="."+i[o],void 0;console.error("Couldn't play any of the wanted file formats!"),e.fileFormat=null},verify:function(e,o){var s;if("string"==typeof e&&(e=this.defaults[e]),void 0===o)return e["default"];switch(void 0===e.type&&console.error("DMAF Verification Error: Malformed defaults object."),e.type){case"int":parseFloat(o)!==parseInt(o,10)&&(s=t),isNaN(o)&&(s=t),e.min>o&&(s=i),o>e.max&&(s=n);break;case"float":isNaN(o)&&(s=t),e.min>o&&(s=i),o>e.max&&(s=n);break;case"string":"string"!=typeof o&&(s=t);break;case"list":o instanceof Array||(s=t);break;case"enum":if(e.values){if(-1!==e.values.indexOf(o))break;s=a}else console.error("DMAF Verification Error! Missing values list for enum type value."),s=!0;break;case"boolean":"boolean"!=typeof o&&(s=t);break;default:console.error("DMAF Verification Error! Malformed defaults object. Please check the descriptors.xml")}return s?(s(o,e),e["default"]):o}}}),dmaf.once("load_modules",function(e){function t(){this.transposeValue=0,this.lastActionTime=-5e3}t.prototype=Object.create(e.InstancePrototype,{onAction:{value:function(e,t){var i=5e3>t-this.lastActionTime;switch(e){case"user_won_round":if(i)return;this.transposeValue++;break;case"user_lost_round":if(i)return;this.transposeValue++;break;case"user_won_match":this.transposeValue=0;break;case"user_lost_match":this.transposeValue=0}this.lastActionTime=t}}}),e.registerInstance("customCode","LevelTransposer",t)});